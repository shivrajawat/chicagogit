var UA=navigator.userAgent.toLowerCase();var isIE=(UA.indexOf("msie")>=0)?true:false;var isNS=(UA.indexOf("mozilla")>=0)?true:false;var isIE9=(UA.indexOf("msie 9.0")>=0)?true:false;var oUtil=new InnovaEditorUtil();function InnovaEditorUtil(){this.langDir="en-US";try{if(LanguageDirectory){this.langDir=LanguageDirectory}}catch(d){}var a=document.getElementsByTagName("script");for(var c=0;c<a.length;c++){var b=a[c].src.toLowerCase();if(b.indexOf("scripts/editor.js")!=-1){this.scriptPath=a[c].src.replace(/editor.js/ig,"")}}this.scriptPathLang=this.scriptPath+"language/"+this.langDir+"/";if(this.langDir=="en-US"){document.write("<script src='"+this.scriptPathLang+"editor_lang.js'><\/script>")}this.oName;this.oEditor;this.obj;this.oSel;this.sType;this.bInside=bInside;this.useSelection=true;this.arrEditor=[];this.onSelectionChanged=function(){return true};this.activeElement;this.activeModalWin;this.Table;this.protocol=window.location.protocol;this.spcCharCode=[[169,"&copy;"],[163,"&pound;"],[174,"&reg;"],[233,"&eacute;"],[201,"&Eacute;"],[8364,"&euro;"],[8220,'"']];this.spcChar=[];this.loadSpecialCharCode=function(e){if(e!=null){this.spcCharCode=e;this.spcChar=[]}for(var g=0;g<this.spcCharCode.length;g++){this.spcChar[g]=[new RegExp(String.fromCharCode(this.spcCharCode[g][0]),"g"),this.spcCharCode[g][1]]}};for(var c=0;c<this.spcCharCode.length;c++){this.spcChar[c]=[new RegExp(String.fromCharCode(this.spcCharCode[c][0]),"g"),this.spcCharCode[c][1]]}this.replaceSpecialChar=function(g){for(var e=0;e<this.spcChar.length;e++){g=g.replace(this.spcChar[e][0],this.spcChar[e][1])}return g};this.initializeEditor=function(h,e){var n=[],m,g;if(typeof(h)=="object"&&h.tagName&&h.tagName=="TEXTAREA"){n[0]=h}else{if(h.substr(0,1)=="#"){m=document.getElementById(h.substr(1));if(!m){return}n[0]=m}else{var p=document.getElementsByTagName("TEXTAREA");for(var l=0;l<p.length;l++){if(p[l].className==h){n[n.length]=p[l]}}}}for(var l=0;l<n.length;l++){m=n[l];if(m.id||m.id==""){m.id="editorarea"+l}g=document.createElement("DIV");g.id="innovaeditor"+l;m.parentNode.insertBefore(g,m);window["oEdit"+l]=new InnovaEditor("oEdit"+l);var o;if(window.getComputedStyle){o=window.getComputedStyle(m,null)}else{if(m.currentStyle){o=m.currentStyle}else{o={width:window["oEdit"+l].width,height:window["oEdit"+l].height}}}window["oEdit"+l].width=o.width;window["oEdit"+l].height=o.height;if(e){for(var k in e){window["oEdit"+l][k]=e[k]}}window["oEdit"+l].REPLACE(m.id,"innovaeditor"+l)}}}function bInside(a){while(a!=null){if(a.contentEditable=="true"){return true}a=a.parentElement}return false}function checkFocus(){var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();var sType=oEditor.document.selection.type;if(oSel.parentElement!=null){if(!bInside(oSel.parentElement())){return false}}else{if(!bInside(oSel.item(0))){return false}}return true}function iwe_focus(){var oEditor=eval("idContent"+this.oName);oEditor.focus()}function set_focus(type){var oEditor=eval("idContent"+this.oName);oEditor.focus();try{if(this.rangeBookmark!=null){var oSel=oEditor.document.selection;var oRange=oSel.createRange();var bmRange=this.rangeBookmark;if(bmRange.parentElement()){oRange.moveToElementText(bmRange.parentElement());oRange.setEndPoint("StarttoStart",bmRange);oRange.setEndPoint("EndToEnd",bmRange);oRange.select()}if(type){oRange.moveToElementText(oEditor.document.body);oRange.select();if(type=="start"){oRange.collapse()}else{if(type=="end"){oRange.collapse(false)}}oRange.select()}}else{if(this.controlBookmark!=null){var oSel=oEditor.document.body.createControlRange();oSel.add(this.controlBookmark);oSel.select()}}}catch(e){}}function bookmark_selection(){var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection;var oRange=oSel.createRange();if(oSel.type=="None"||oSel.type=="Text"){this.rangeBookmark=oRange;this.controlBookmark=null}else{this.controlBookmark=oRange.item(0);this.rangeBookmark=null}}function InnovaEditor(e){this.oName=e;this.RENDER=RENDER;this.onRender=function(){};this.init=initISEditor;this.IsSecurityRestricted=false;this.loadHTML=loadHTML;this.putHTML=putHTML;this.getHTMLBody=getHTMLBody;this.getXHTMLBody=getXHTMLBody;this.getHTML=getHTML;this.getXHTML=getXHTML;this.getTextBody=getTextBody;this.initialRefresh=false;this.preserveSpace=false;this.bInside=bInside;this.checkFocus=checkFocus;this.focus=iwe_focus;this.setFocus=set_focus;this.bookmarkSelection=bookmark_selection;this.disableFocusOnLoad=false;this.onKeyPress=function(){return true};this.styleSelectionHoverBg="#cccccc";this.styleSelectionHoverFg="white";this.styleSelectorPrefix="";this.cleanEmptySpan=cleanEmptySpan;this.cleanFonts=cleanFonts;this.cleanTags=cleanTags;this.replaceTags=replaceTags;this.cleanDeprecated=cleanDeprecated;this.doClean=doClean;this.applySpanStyle=applySpanStyle;this.applyLine=applyLine;this.applyBold=applyBold;this.applyItalic=applyItalic;this.doOnPaste=doOnPaste;this.isAfterPaste=false;this.doCmd=doCmd;this.applyParagraph=applyParagraph;this.applyFontName=applyFontName;this.applyFontSize=applyFontSize;this.applyBullets=applyBullets;this.applyNumbering=applyNumbering;this.applyJustifyLeft=applyJustifyLeft;this.applyJustifyCenter=applyJustifyCenter;this.applyJustifyRight=applyJustifyRight;this.applyJustifyFull=applyJustifyFull;this.applyBlockDirLTR=applyBlockDirLTR;this.applyBlockDirRTL=applyBlockDirRTL;this.doPaste=doPaste;this.doPasteText=doPasteText;this.applySpan=applySpan;this.makeAbsolute=makeAbsolute;this.insertHTML=insertHTML;this.clearAll=clearAll;this.insertCustomTag=insertCustomTag;this.selectParagraph=selectParagraph;this.hide=hide;this.width="700";this.height="350";this.publishingPath="";var a=document.getElementsByTagName("script");for(var c=0;c<a.length;c++){var b=a[c].src.toLowerCase();if(b.indexOf("scripts/editor.js")!=-1){this.scriptPath=a[c].src.replace(/editor.js/,"")}}this.dialogPath=this.scriptPath+"common/";this.GetEmoticons=GetEmoticons;this.insertEmoticon=insertEmoticon;this.applyQuote=applyQuote;this.iconPath="icons/";this.iconWidth=29;this.iconHeight=25;this.iconOffsetTop;this.dropTopAdjustment=-1;this.dropLeftAdjustment=0;this.heightAdjustment=-70;this.runtimeBorder=runtimeBorder;this.runtimeBorderOn=runtimeBorderOn;this.runtimeBorderOff=runtimeBorderOff;this.IsRuntimeBorderOn=true;this.runtimeStyles=runtimeStyles;this.applyColor=applyColor;this.oColor1=new ColorPicker("oColor1",this.oName);this.oColor2=new ColorPicker("oColor2",this.oName);this.expandSelection=expandSelection;this.fullScreen=fullScreen;this.stateFullScreen=false;this.onFullScreen=function(){return true};this.onNormalScreen=function(){return true};this.arrElm=new Array(300);this.getElm=iwe_getElm;this.features=[];this.btnParagraph=false;this.btnFontName=false;this.btnFontSize=false;this.btnCut=false;this.btnCopy=false;this.btnPaste=false;this.btnPasteText=false;this.btnUndo=false;this.btnRedo=false;this.btnBold=false;this.btnItalic=false;this.btnUnderline=false;this.btnStrikethrough=false;this.btnSuperscript=false;this.btnSubscript=false;this.btnJustifyLeft=false;this.btnJustifyCenter=false;this.btnJustifyRight=false;this.btnJustifyFull=false;this.btnNumbering=false;this.btnBullets=false;this.btnIndent=false;this.btnOutdent=false;this.btnLTR=false;this.btnRTL=false;this.btnForeColor=false;this.btnBackColor=false;this.btnTable=false;this.btnLine=false;this.tabs=[["tabHome","Home",["group1","group2","group4"]],["tabStyle","Insert",["group3"]]];this.groups=[["group1","",["Bold","Italic","Underline","FontDialog","ForeColor","TextDialog","RemoveFormat"]],["group2","",["Bullets","Numbering","JustifyLeft","JustifyCenter","JustifyRight"]],["group3","",["LinkDialog","ImageDialog","YoutubeDialog","Table","TableDialog","Emoticons","Quote"]],["group4","",["Undo","Redo","FullScreen","SourceDialog"]]];this.toolbarMode=2;this.showResizeBar=true;this.pasteTextOnCtrlV=false;this.fileBrowser="";this.enableFlickr=true;this.enableCssButtons=true;this.enableLightbox=true;this.enableTableAutoformat=true;this.flickrUser="ysw.insite";this.cmdAssetManager="";this.cmdFileManager="";this.cmdImageManager="";this.cmdMediaManager="";this.cmdFlashManager="";this.btnContentBlock=false;this.cmdContentBlock=";";this.btnInternalLink=false;this.cmdInternalLink=";";this.insertLink=insertLink;this.btnCustomObject=false;this.cmdCustomObject=";";this.btnInternalImage=false;this.cmdInternalImage=";";this.css="";this.arrStyle=[];this.isCssLoaded=false;this.openStyleSelect=openStyleSelect;this.arrParagraph=[[getTxt("Heading 1"),"H1"],[getTxt("Heading 2"),"H2"],[getTxt("Heading 3"),"H3"],[getTxt("Heading 4"),"H4"],[getTxt("Heading 5"),"H5"],[getTxt("Heading 6"),"H6"],[getTxt("Preformatted"),"PRE"],[getTxt("Normal (P)"),"P"],[getTxt("Normal (DIV)"),"DIV"]];this.arrFontName=["Impact, Charcoal, sans-serif","Palatino Linotype, Book Antiqua, Palatino, serif","Tahoma, Geneva, sans-serif","Century Gothic, sans-serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Times New Roman, Times, serif","Arial Narrow, sans-serif","Verdana, Geneva, sans-serif","Copperplate Gothic Light, sans-serif","Lucida Console, Monaco, monospace","Gill Sans MT, sans-serif","Trebuchet MS, Helvetica, sans-serif","Courier New, Courier, monospace","Arial, Helvetica, sans-serif","Georgia, Serif","Garamond, Serif"];this.arrFontSize=[[getTxt("Size 1"),"1"],[getTxt("Size 2"),"2"],[getTxt("Size 3"),"3"],[getTxt("Size 4"),"4"],[getTxt("Size 5"),"5"],[getTxt("Size 6"),"6"],[getTxt("Size 7"),"7"]];this.arrCustomTag=[];this.docType='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">';this.html="<html>";this.headContent="";this.preloadHTML="";this.originalContent="";this.isContentChanged=isContentChanged;this.onSave=function(){document.getElementById("iwe_btnSubmit"+this.oName).click()};this.useBR=false;this.useDIV=true;this.returnKeyMode=-1;this.doUndo=doUndo;this.doRedo=doRedo;this.saveForUndo=saveForUndo;this.arrUndoList=[];this.arrRedoList=[];this.useTagSelector=true;this.TagSelectorPosition="bottom";this.moveTagSelector=moveTagSelector;this.selectElement=selectElement;this.removeTag=removeTag;this.doClick_TabCreate=doClick_TabCreate;this.doRefresh_TabCreate=doRefresh_TabCreate;this.arrCustomButtons=[["CustomName1","alert(0)","caption here","btnSave.gif"],["CustomName2","alert(0)","caption here","btnSave.gif"]];this.customDialogShow=customDialogShow;this.customDialog=[];this.onSelectionChanged=function(){return true};this.spellCheckMode="ieSpell";this.encodeIO=false;this.changeHeight=changeHeight;this.fixWord=fixWord;this.rangeBookmark=null;this.controlBookmark=null;this.REPLACE=REPLACE;this.idTextArea;this.mode="XHTMLBody";var d=this;this.tbar=new ISToolbarManager(this.oName);this.tbar.iconPath=this.scriptPath+this.iconPath}function changeActiveEditor(oName){var edtObj=eval(oName);var edtFrm=document.getElementById("idContent"+oName);oUtil.activeElement=null;oUtil.oName=oName;oUtil.oEditor=edtFrm.contentWindow;oUtil.obj=edtObj;edtObj.hide()}function saveForUndo(){var oEditor=eval("idContent"+this.oName);var obj=eval(this.oName);if(obj.arrUndoList[0]){if(oEditor.document.body.innerHTML==obj.arrUndoList[0][0]){return}}for(var i=20;i>1;i--){obj.arrUndoList[i-1]=obj.arrUndoList[i-2]}obj.focus();var oSel=oEditor.document.selection.createRange();var sType=oEditor.document.selection.type;if(sType=="None"){obj.arrUndoList[0]=[oEditor.document.body.innerHTML,oEditor.document.selection.createRange().getBookmark(),"None"]}else{if(sType=="Text"){obj.arrUndoList[0]=[oEditor.document.body.innerHTML,oEditor.document.selection.createRange().getBookmark(),"Text"]}else{if(sType=="Control"){oSel.item(0).selThis="selThis";obj.arrUndoList[0]=[oEditor.document.body.innerHTML,null,"Control"];oSel.item(0).removeAttribute("selThis",0)}}}this.arrRedoList=[];if(this.btnUndo){this.tbar.btns["btnUndo"+this.oName].setState(1)}if(this.btnRedo){this.tbar.btns["btnRedo"+this.oName].setState(5)}}function doUndo(){var oEditor=eval("idContent"+this.oName);var obj=eval(this.oName);if(!obj.arrUndoList[0]){return}for(var i=20;i>1;i--){obj.arrRedoList[i-1]=obj.arrRedoList[i-2]}var oSel=oEditor.document.selection.createRange();var sType=oEditor.document.selection.type;if(sType=="None"){this.arrRedoList[0]=[oEditor.document.body.innerHTML,oEditor.document.selection.createRange().getBookmark(),"None"]}else{if(sType=="Text"){this.arrRedoList[0]=[oEditor.document.body.innerHTML,oEditor.document.selection.createRange().getBookmark(),"Text"]}else{if(sType=="Control"){oSel.item(0).selThis="selThis";this.arrRedoList[0]=[oEditor.document.body.innerHTML,null,"Control"];oSel.item(0).removeAttribute("selThis",0)}}}sHTML=obj.arrUndoList[0][0];sHTML=fixPathEncode(sHTML);oEditor.document.body.innerHTML=sHTML;fixPathDecode(oEditor);this.runtimeBorder(false);this.runtimeStyles();var oRange=oEditor.document.body.createTextRange();if(obj.arrUndoList[0][2]=="None"){oRange.moveToBookmark(obj.arrUndoList[0][1]);oRange.select()}else{if(obj.arrUndoList[0][2]=="Text"){oRange.moveToBookmark(obj.arrUndoList[0][1]);oRange.select()}else{if(obj.arrUndoList[0][2]=="Control"){for(var i=0;i<oEditor.document.all.length;i++){if(oEditor.document.all[i].selThis=="selThis"){var oSelRange=oEditor.document.body.createControlRange();oSelRange.add(oEditor.document.all[i]);oSelRange.select();oEditor.document.all[i].removeAttribute("selThis",0)}}}}}for(var i=0;i<19;i++){obj.arrUndoList[i]=obj.arrUndoList[i+1]}obj.arrUndoList[19]=null;realTime(this.oName)}function doRedo(){var oEditor=eval("idContent"+this.oName);var obj=eval(this.oName);if(!obj.arrRedoList[0]){return}for(var i=20;i>1;i--){obj.arrUndoList[i-1]=obj.arrUndoList[i-2]}var oSel=oEditor.document.selection.createRange();var sType=oEditor.document.selection.type;if(sType=="None"){obj.arrUndoList[0]=[oEditor.document.body.innerHTML,oEditor.document.selection.createRange().getBookmark(),"None"]}else{if(sType=="Text"){obj.arrUndoList[0]=[oEditor.document.body.innerHTML,oEditor.document.selection.createRange().getBookmark(),"Text"]}else{if(sType=="Control"){oSel.item(0).selThis="selThis";this.arrUndoList[0]=[oEditor.document.body.innerHTML,null,"Control"];oSel.item(0).removeAttribute("selThis",0)}}}sHTML=obj.arrRedoList[0][0];sHTML=fixPathEncode(sHTML);oEditor.document.body.innerHTML=sHTML;fixPathDecode(oEditor);this.runtimeBorder(false);this.runtimeStyles();var oRange=oEditor.document.body.createTextRange();if(obj.arrRedoList[0][2]=="None"){oRange.moveToBookmark(obj.arrRedoList[0][1])}else{if(obj.arrRedoList[0][2]=="Text"){oRange.moveToBookmark(obj.arrRedoList[0][1]);oRange.select()}else{if(obj.arrRedoList[0][2]=="Control"){for(var i=0;i<oEditor.document.all.length;i++){if(oEditor.document.all[i].selThis=="selThis"){var oSelRange=oEditor.document.body.createControlRange();oSelRange.add(oEditor.document.all[i]);oSelRange.select();oEditor.document.all[i].removeAttribute("selThis",0)}}}}}for(var i=0;i<19;i++){obj.arrRedoList[i]=obj.arrRedoList[i+1]}obj.arrRedoList[19]=null;realTime(this.oName)}var bOnSubmitOriginalSaved=false;function REPLACE(c,e){this.idTextArea=c;var a=document.getElementById(c);a.style.display="none";var d=a.form;if(d){if(!bOnSubmitOriginalSaved){onsubmit_original=d.onsubmit;bOnSubmitOriginalSaved=true}d.onsubmit=new Function("return onsubmit_new()")}var b=document.getElementById(c).value;b=b.replace(/&/g,"&amp;");b=b.replace(/</g,"&lt;");b=b.replace(/>/g,"&gt;");this.RENDER(b,e)}function isContentChanged(){var a="";if(this.mode=="HTMLBody"){a=this.getHTMLBody()}else{if(this.mode=="HTML"){a=this.getHTML()}else{if(this.mode=="XHTMLBody"){a=this.getXHTMLBody()}else{if(this.mode=="XHTML"){a=this.getXHTML()}}}}if(a!=this.originalContent){return true}return false}function onsubmit_new(){var sContent;for(var i=0;i<oUtil.arrEditor.length;i++){var oEdit=eval(oUtil.arrEditor[i]);var oEditor=eval("idContent"+oEdit.oName);var allSpans=oEditor.document.getElementsByTagName("SPAN");for(var j=0;j<allSpans.length;j++){if((allSpans[j].innerHTML=="")&&(allSpans[j].parentElement.children.length==1)){allSpans[j].innerHTML="&nbsp;"}}if(oEdit.mode=="HTMLBody"){sContent=oEdit.getHTMLBody()}if(oEdit.mode=="HTML"){sContent=oEdit.getHTML()}if(oEdit.mode=="XHTMLBody"){sContent=oEdit.getXHTMLBody()}if(oEdit.mode=="XHTML"){sContent=oEdit.getXHTML()}document.getElementById(oEdit.idTextArea).value=sContent}if(onsubmit_original){return onsubmit_original()}}function onsubmit_original(){}var iconHeight;function RENDER(sPreloadHTML,dvId){if(document.compatMode&&document.compatMode!="BackCompat"){if(String(this.height).indexOf("%")==-1){var eh=parseInt(this.height,10);eh+=this.heightAdjustment;this.height=eh+"px"}}iconHeight=this.iconHeight;if(sPreloadHTML.substring(0,4)=="<!--"&&sPreloadHTML.substring(sPreloadHTML.length-3)=="-->"){sPreloadHTML=sPreloadHTML.substring(4,sPreloadHTML.length-3)}if(sPreloadHTML.substring(0,4)=="<!--"&&sPreloadHTML.substring(sPreloadHTML.length-6)=="--&gt;"){sPreloadHTML=sPreloadHTML.substring(4,sPreloadHTML.length-6)}sPreloadHTML=sPreloadHTML.replace(/&lt;/g,"<");sPreloadHTML=sPreloadHTML.replace(/&gt;/g,">");sPreloadHTML=sPreloadHTML.replace(/&amp;/g,"&");this.preloadHTML=sPreloadHTML;var sHTMLDropMenus="";var sHTMLIcons="";var sTmp="";this.oColor1.onShow=new Function(this.oName+".hide()");this.oColor1.onPickColor=new Function(this.oName+".applyColor('ForeColor',eval('"+this.oName+"').oColor1.color)");this.oColor1.onRemoveColor=new Function(this.oName+".applyColor('ForeColor','')");this.oColor2.onShow=new Function(this.oName+".hide()");this.oColor2.onPickColor=new Function(this.oName+".applyColor('BackColor',eval('"+this.oName+"').oColor2.color)");this.oColor2.onRemoveColor=new Function(this.oName+".applyColor('BackColor','')");var me=this;var tmp=null,tmpTb,grpMap=new Object();for(var i=0;i<this.groups.length;i++){tmp=this.groups[i];tmpTb=this.tbar.createToolbar(this.oName+"tbar"+tmp[0]);tmpTb.onClick=function(id){tbAction(tmpTb,id,me,me.oName)};tmpTb.style.toolbar="main_istoolbar";tmpTb.iconPath=this.scriptPath+this.iconPath;tmpTb.btnWidth=this.iconWidth;tmpTb.btnHeight=this.iconHeight;for(var j=0;j<tmp[2].length;j++){eval(this.oName+".btn"+tmp[2][j]+"=true")}buildToolbar(tmpTb,this,tmp[2]);grpMap[tmp[0]]=tmp[1]}if(this.toolbarMode==1){var eTab=this.tbar.createTbTab("tabCtl"+this.oName),tmpGrp;for(var i=0;i<this.tabs.length;i++){tmp=this.tabs[i];tmpGrp=this.tbar.createTbGroup(this.oName+"grp"+tmp[0]);for(var j=0;j<tmp[2].length;j++){tmpGrp.addGroup(this.oName+tmp[2][j],grpMap[tmp[2][j]],this.oName+"tbar"+tmp[2][j])}eTab.addTab(this.oName+tmp[0],tmp[1],tmpGrp)}}else{if(this.groups.length>0){var tmpGrp;tmpGrp=this.tbar.createTbGroup(this.oName+"grp");for(var i=0;i<this.groups.length;i++){tmp=this.groups[i];tmpGrp.addGroup(this.oName+tmp[0],grpMap[tmp[0]],this.oName+"tbar"+tmp[0])}if(this.toolbarMode==3){tmpGrp.groupFlow=true}if(this.toolbarMode==4){tmpGrp.groupFlow=true;tmpGrp.draggable=true}}}var sHTML="";sHTML+="<iframe name=idFixZIndex"+this.oName+" id=idFixZIndex"+this.oName+"  frameBorder=0 style='display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)' src='"+this.scriptPath+"blank.gif' ></iframe>";sHTML+="<table id=idArea"+this.oName+" name=idArea"+this.oName+" border=0 cellpadding=0 cellspacing=0 width='"+this.width+"' height='"+this.height+"' style='width:"+this.width+";height:"+this.height+";border:none;border-bottom:#cfcfcf 1px solid'><tr><td colspan=2 style=\"position:relative;padding:0px;padding-left:0px;border:#cfcfcf 0px solid;border-bottom:0;background:url('"+this.scriptPath+"icons/bg.gif')\"><table cellpadding=0 cellspacing=0 width='100%' id='idToolbar"+this.oName+"'  style='border:none;margin:0px'><tr><td dir=ltr style='padding:0px'>"+this.tbar.render()+"</td></tr></table></td></tr><tr id=idTagSelTopRow"+this.oName+"><td colspan=2 id=idTagSelTop"+this.oName+" height=0 style='padding:0px;color:#000000'></td></tr>";sHTML+="<tr style='width:100%;height:100%'><td colspan=2 valign=top height=100% style='padding:0px;background:white;'>";sHTML+="<table cellpadding=0 cellspacing=0 width='100%' height=100% style='margin:0px;border:none;'><tr><td width=100% height=100% style='border:none;padding:0px;border:#cfcfcf 1px solid;border-bottom:none;'>";if(this.IsSecurityRestricted){sHTML+="<iframe security='restricted' style='width:100%;height:100%;' frameborder='no' src='"+this.scriptPath+"blank.gif' name=idContent"+this.oName+" id=idContent"+this.oName+" contentEditable=true></iframe>"}else{sHTML+="<iframe style='width:100%;height:100%;' frameborder='no' src='"+this.scriptPath+"blank.gif' name=idContent"+this.oName+" id=idContent"+this.oName+" contentEditable=true></iframe>"}sHTML+="<iframe style='position:absolute;left:-1000px;top:-1000px;width:1px;height:1px;overflow:auto;' src='"+this.scriptPath+"blank.gif' name=idContentWord"+this.oName+" id=idContentWord"+this.oName+" contentEditable=true onfocus='"+this.oName+".hide()'></iframe>";sHTML+="</td><td id=idStyles"+this.oName+" style='padding:0px;background:#f4f4f4' valign=top></td></tr></table>";sHTML+="</td></tr>";sHTML+="<tr id=idTagSelBottomRow"+this.oName+"><td colspan=2 id=idTagSelBottom"+this.oName+" style='padding:0px;color:#000000'></td></tr>";if(this.showResizeBar){sHTML+="<tr id=idResizeBar"+this.oName+"><td colspan=2 style='padding:0px;'><div class='resize_bar' style='cursor:n-resize;' onmousedown=\"onEditorStartResize(event, this, '"+this.oName+"')\" ></div></td></tr>"}sHTML+="</table>";sHTML+=sHTMLDropMenus;sHTML+="<input type=submit name=iwe_btnSubmit"+this.oName+" id=iwe_btnSubmit"+this.oName+" value=SUBMIT style='display:none' >";if(dvId){var edtStr=[];edtStr[0]=sHTML;document.getElementById(dvId).innerHTML=edtStr.join("")}else{document.write(sHTML)}this.init()}function onEditorStartResize(ev,elm,oName){document.onmousemove=onEditorResize;document.onmouseup=onEditorStopResize;document.onselectstart=function(){return false};document.ondragstart=function(){return false};document.body.style.cursor="n-resize";oUtil.currentResized=eval(oName);oUtil.resizeInit={x:ev.screenX,y:ev.screenY};if(!oUtil.isWindow){oUtil.isWindow=new ISWindow(oName)}oUtil.isWindow.showOverlay()}function onEditorStopResize(){oUtil.resizeOffset={dx:event.screenX-oUtil.resizeInit.x,dy:event.screenY-oUtil.resizeInit.y};oUtil.currentResized.changeHeight(oUtil.resizeOffset.dy);oUtil.isWindow.hideOverlay();document.onmousemove=null;document.onmouseup=null;document.body.style.cursor="default"}function onEditorResize(){oUtil.resizeOffset={dx:event.screenX-oUtil.resizeInit.x,dy:event.screenY-oUtil.resizeInit.y};oUtil.currentResized.changeHeight(oUtil.resizeOffset.dy);oUtil.resizeInit={x:event.screenX,y:event.screenY}}function initISEditor(){if(this.useTagSelector){if(this.TagSelectorPosition=="bottom"){this.TagSelectorPosition="top"}else{this.TagSelectorPosition="bottom"}this.moveTagSelector()}oUtil.oName=this.oName;oUtil.oEditor=eval("idContent"+this.oName);oUtil.obj=eval(this.oName);oUtil.arrEditor.push(this.oName);eval("idArea"+this.oName).style.position="absolute";window.setTimeout("eval('idArea"+this.oName+"').style.position='';",1);var arrA=String(this.preloadHTML).match(/<HTML[^>]*>/ig);if(arrA){this.loadHTML("");window.setTimeout(this.oName+".putHTML("+this.oName+".preloadHTML)",0)}else{this.loadHTML(this.preloadHTML)}switch(this.mode){case"HTMLBody":this.originalContent=this.getHTMLBody();break;case"HTML":this.originalContent=this.getHTML();break;case"XHTMLBody":this.originalContent=this.getXHTMLBody();break;case"XHTML":this.originalContent=this.getXHTML();break}if(this.returnKeyMode==-1){if(this.useDIV){this.returnKeyMode=1}else{if(this.useBR){this.returnKeyMode=2}else{if(!this.useDIV&&!this.useBR){this.returnKeyMode=3}}}}this.onRender();if(this.disableFocusOnLoad==false){this.focus()}}function buildToolbar(h,c,k){var r=c.oName;for(var l=0;l<k.length;l++){sButtonName=k[l];switch(sButtonName){case"|":h.addSeparator();break;case"BRK":h.addBreak();break;case"FullScreen":h.addButton("btnFullScreen"+r,"btnFullScreen.gif",getTxt("Full Screen"));break;case"Print":h.addButton("btnPrint"+r,"btnPrint.gif",getTxt("Print"));break;case"Search":h.addButton("btnSearch"+r,"btnSearch.gif",getTxt("Search"));break;case"SpellCheck":h.addButton("btnSpellCheck"+r,"btnSpellCheck.gif",getTxt("Check Spelling"));break;case"Styles":h.addButton("btnStyles"+r,"btnStyleSelect.gif",getTxt("Style Selection"));break;case"Paragraph":h.addDropdownButton("btnParagraph"+r,"ddParagraph"+r,"btnParagraph.gif",getTxt("Paragraph"),37);var w=new ISDropdown("ddParagraph"+r);w.onClick=function(m){ddAction(h,m,c,c.oName)};for(var g=0;g<c.arrParagraph.length;g++){w.addItem("btnParagraph_"+g+r,"<"+c.arrParagraph[g][1]+' style="margin-bottom:4px"  unselectable=on> '+c.arrParagraph[g][0]+"</"+c.arrParagraph[g][1]+">")}break;case"FontName":h.addDropdownButton("btnFontName"+r,"ddFontName"+r,"btnFontName.gif",getTxt("Font Name"),37);var o=new ISDropdown("ddFontName"+r);o.onClick=function(m){ddAction(h,m,c,c.oName)};for(var g=0;g<c.arrFontName.length;g++){o.addItem("btnFontName_"+g+r,"<span style='font-family:"+c.arrFontName[g]+";font-size:12px' unselectable=on>"+c.arrFontName[g]+"</span>")}break;case"FontSize":h.addDropdownButton("btnFontSize"+r,"ddFontSize"+r,"btnFontSize.gif",getTxt("Font Size"),37);var e=new ISDropdown("ddFontSize"+r);e.onClick=function(m){ddAction(h,m,c,c.oName)};for(var g=0;g<c.arrFontSize.length;g++){e.addItem("btnFontSize_"+g+r,'<font unselectable=on size="'+c.arrFontSize[g][1]+'">'+c.arrFontSize[g][0]+"</font>")}break;case"Cut":h.addButton("btnCut"+r,"btnCut.gif",getTxt("Cut"));break;case"Copy":h.addButton("btnCopy"+r,"btnCopy.gif",getTxt("Copy"));break;case"Paste":h.addDropdownButton("btnPaste"+r,"ddPaste"+r,"btnPaste.gif",getTxt("Paste"));var t=new ISDropdown("ddPaste"+r);t.iconPath=h.iconPath;t.addItem("btnPasteClip"+r,getTxt("Paste"),"btnPasteClip.gif");t.addItem("btnPasteText"+r,getTxt("Paste Text"),"btnPasteText.gif");t.onClick=function(m){ddAction(h,m,c,c.oName)};break;case"Emoticons":h.addDropdownButton("btnEmoticons"+r,"ddEmoticons"+r,"btnEmoticons.gif",getTxt("Emoticons"));var p=new ISDropdown("ddEmoticons"+r);p.add(new ISCustomDDItem("btnInsertEmoticons",c.GetEmoticons()));break;case"Quote":h.addToggleButton("btnQuote"+r,"",false,"btnQuote.gif",getTxt("Quote"));break;case"Undo":h.addButton("btnUndo"+r,"btnUndo.gif",getTxt("Undo"));break;case"Redo":h.addButton("btnRedo"+r,"btnRedo.gif",getTxt("Redo"));break;case"Bold":h.addToggleButton("btnBold"+r,"",false,"btnBold.gif",getTxt("Bold"));break;case"Italic":h.addToggleButton("btnItalic"+r,"",false,"btnItalic.gif",getTxt("Italic"));break;case"Underline":h.addToggleButton("btnUnderline"+r,"",false,"btnUnderline.gif",getTxt("Underline"));break;case"Strikethrough":h.addToggleButton("btnStrikethrough"+r,"",false,"btnStrikethrough.gif",getTxt("Strikethrough"));break;case"Superscript":h.addToggleButton("btnSuperscript"+r,"",false,"btnSuperscript.gif",getTxt("Superscript"));break;case"Subscript":h.addToggleButton("btnSubscript"+r,"",false,"btnSubscript.gif",getTxt("Subscript"));break;case"JustifyLeft":h.addToggleButton("btnJustifyLeft"+r,"align",false,"btnLeft.gif",getTxt("Justify Left"));break;case"JustifyCenter":h.addToggleButton("btnJustifyCenter"+r,"align",false,"btnCenter.gif",getTxt("Justify Center"));break;case"JustifyRight":h.addToggleButton("btnJustifyRight"+r,"align",false,"btnRight.gif",getTxt("Justify Right"));break;case"JustifyFull":h.addToggleButton("btnJustifyFull"+r,"align",false,"btnFull.gif",getTxt("Justify Full"));break;case"Numbering":h.addToggleButton("btnNumbering"+r,"bullet",false,"btnNumber.gif",getTxt("Numbering"));break;case"Bullets":h.addToggleButton("btnBullets"+r,"bullet",false,"btnList.gif",getTxt("Bullets"));break;case"Indent":h.addButton("btnIndent"+r,"btnIndent.gif",getTxt("Indent"));break;case"Outdent":h.addButton("btnOutdent"+r,"btnOutdent.gif",getTxt("Outdent"));break;case"LTR":h.addToggleButton("btnLTR"+r,"dir",false,"btnLTR.gif",getTxt("Left To Right"));break;case"RTL":h.addToggleButton("btnRTL"+r,"dir",false,"btnRTL.gif",getTxt("Right To Left"));break;case"ForeColor":h.addDropdownButton("btnForeColor"+r,"ddForeColor"+r,"btnForeColor.gif",getTxt("Foreground Color"));var p=new ISDropdown("ddForeColor"+r);p.add(new ISCustomDDItem("btnInsertForeColor",c.oColor1.generateHTML()));break;case"BackColor":h.addDropdownButton("btnBackColor"+r,"ddBackColor"+r,"btnBackColor.gif",getTxt("Background Color"));var p=new ISDropdown("ddBackColor"+r);p.add(new ISCustomDDItem("btnInsertBackColor",c.oColor2.generateHTML()));break;case"FontDialog":h.addButton("btnFontDialog"+r,"btnFont.gif",getTxt("Fonts"));break;case"TextDialog":h.addButton("btnTextDialog"+r,"btnText.gif",getTxt("Text"));break;case"CompleteTextDialog":h.addButton("btnCompleteTextDialog"+r,"btnText.gif",getTxt("Text"));break;case"LinkDialog":h.addButton("btnLinkDialog"+r,"btnHyperlink.gif",getTxt("Link"));break;case"ImageDialog":h.addButton("btnImageDialog"+r,"btnImage.gif",getTxt("Image"));break;case"YoutubeDialog":h.addButton("btnYoutubeDialog"+r,"btnYoutubeVideo.gif",getTxt("YoutubeVideo"));break;case"TableDialog":h.addButton("btnTableDialog"+r,"btnTableEdit.gif",getTxt("Table"));break;case"FlashDialog":h.addButton("btnFlashDialog"+r,"btnFlash.gif",getTxt("Flash"));break;case"CharsDialog":h.addButton("btnCharsDialog"+r,"btnSymbol.gif",getTxt("Special Characters"));break;case"SearchDialog":h.addButton("btnSearchDialog"+r,"btnSearch.gif",getTxt("Search & Replace"));break;case"SourceDialog":h.addButton("btnSourceDialog"+r,"btnSource.gif",getTxt("HTML Editor"));break;case"CustomTag":h.addDropdownButton("btnCustomTag"+r,"ddCustomTag"+r,"btnCustomTag.gif",getTxt("Tags"),37);var q=new ISDropdown("ddCustomTag"+r);q.onClick=function(m){ddAction(h,m,c,c.oName)};for(var g=0;g<c.arrCustomTag.length;g++){q.addItem("btnCustomTag_"+g+r,c.arrCustomTag[g][0])}break;case"ContentBlock":if(c.btnContentBlock){h.addButton("btnContentBlock"+r,"btnContentBlock.gif",getTxt("Content Block"))}break;case"InternalLink":h.addButton("btnInternalLink"+r,"btnInternalLink.gif",getTxt("Internal Link"));break;case"InternalImage":h.addButton("btnInternalImage"+r,"btnInternalImage.gif",getTxt("Internal Image"));break;case"CustomObject":h.addButton("btnCustomObject"+r,"btnCustomObject.gif",getTxt("Object"));break;case"Table":var v=[],a=0;v[a++]="<table width=195 id=dropTableCreate"+r+" onmouseout='doOut_TabCreate();event.cancelBubble=true' style='cursor:default;background:#f3f3f8;border:#8a867a 0px solid;' cellpadding=0 cellspacing=2 border=0 unselectable=on>";for(var d=0;d<8;d++){v[a++]="<tr>";for(var b=0;b<8;b++){v[a++]="<td onclick='"+r+".doClick_TabCreate()' onmouseover='doOver_TabCreate()' style='background:#ffffff;font-size:1px;border:#8a867a 1px solid;width:20px;height:20px;' unselectable=on>&nbsp;</td>"}v[a++]="</tr>"}v[a++]='<tr><td colspan=8 onclick="'+r+".hide();modelessDialogShow('"+c.dialogPath+"webtable.htm',785, 500);\" onmouseover=\"this.innerText='"+getTxt("Advanced Table Insert")+"';this.style.border='#777777 1px solid';this.style.backgroundColor='#444444';this.style.color='#ffffff'\" onmouseout=\"this.style.border='#f3f3f8 1px solid';this.style.backgroundColor='#f3f3f8';this.style.color='#000000'\" align=center style='font-family:verdana;font-size:10px;font-color:black;border:#f3f3f8 1px solid;' unselectable=on>"+getTxt("Advanced Table Insert")+"</td></tr>";v[a++]="</table>";h.addDropdownButton("btnTable"+r,"ddTable"+r,"btnTable.gif",getTxt("Insert Table"));var p=new ISDropdown("ddTable"+r);p.add(new ISCustomDDItem("btnInsertTable",v.join("")));break;case"Guidelines":h.addButton("btnGuidelines"+r,"btnGuideline.gif",getTxt("Show/Hide Guidelines"));break;case"Absolute":h.addButton("btnAbsolute"+r,"btnAbsolute.gif",getTxt("Absolute"));break;case"Line":h.addButton("btnLine"+r,"btnLine.gif",getTxt("Line"));break;case"RemoveFormat":h.addButton("btnRemoveFormat"+r,"btnRemoveFormat.gif",getTxt("Remove Formatting"));break;case"ClearAll":h.addButton("btnClearAll"+r,"btnDelete.gif",getTxt("Clear All"));break;default:for(g=0;g<c.arrCustomButtons.length;g++){if(sButtonName==c.arrCustomButtons[g][0]){sCbName=c.arrCustomButtons[g][0];sCbCaption=c.arrCustomButtons[g][2];sCbImage=c.arrCustomButtons[g][3];if(c.arrCustomButtons[g].length<5){if(c.arrCustomButtons[g][4]){h.addButton(sCbName+r,sCbImage,sCbCaption,c.arrCustomButtons[g][4])}else{h.addButton(sCbName+r,sCbImage,sCbCaption)}}else{if(c.arrCustomButtons[g][4]!=0){h.addDropdownButton(sCbName+r,"dd"+sCbName+r,sCbImage,sCbCaption,c.arrCustomButtons[g][4])}else{h.addDropdownButton(sCbName+r,"dd"+sCbName+r,sCbImage,sCbCaption)}var p=new ISDropdown("dd"+sCbName+r);var u=c.arrCustomButtons[g][5];for(var g=0;g<u.length;g++){tmp=u[g];p.addItem("item_"+sCbName+g+r,'<div style="margin:4px 0;padding:2px 0;font-size:13px;"  unselectable=on onclick="'+tmp[1]+'" > '+tmp[2]+"</div>")}}}}break}}}function iwe_getElm(a){return document.getElementById(a+this.oName)}var arrColorPickerObjects=[];function ColorPicker(a,b){this.oParent=b;if(b){this.oName=b+"."+a;this.oRenderName=a+b}else{this.oName=a;this.oRenderName=a}arrColorPickerObjects.push(this.oName);this.onShow=function(){return true};this.onHide=function(){return true};this.onPickColor=function(){return true};this.onRemoveColor=function(){return true};this.hide=hideColorPicker;this.hideAll=hideColorPickerAll;this.color;this.isActive=false;this.generateHTML=generateHTML}function generateHTML(){var a=[["#ef001b","#cc0017","#a60012","#83000e","#ef0078","#ce0067","#ad0057","#8b0045","#e301ed","#c501ce","#a401ab","#88018e","#6716ef","#5913ce","#4b10af","#3e0d90"],["#f67684","#e36875","#ca5965","#b34e59","#f563ac","#de599b","#cc5490","#b24d7f","#ee68f4","#db5fe1","#c759cc","#b255b6","#a779f5","#976cdf","#8d68cc","#7f5eb7"],["#fcc0c6","#eea8af","#dd959c","#ce8c93","#fec7e2","#f4b8d6","#e5a6c6","#d495b4","#fabffd","#eeaff1","#e19fe4","#cf90d2","#e0c3fd","#d1b1f1","#c1a0e2","#b192d1"],["#fef5f6","#fdeced","#f7dee0","#eacedc","#fef3f8","#fbe8f1","#efd0e0","#e6c7d6","#fef2fe","#fae6fb","#f1d3f2","#e3c1e4","#f5edfe","#f0e5fb","#e1d3ef","#d9cbe7"],["#028b6c","#02775d","#02644e","#015441","#1882ed","#1574d4","#115eab","#0e4f90","#0040eb","#0039d0","#0030b1","#002892","#50509e","#46468b","#3a3a73","#303060"],["#69baa7","#61a898","#57998a","#508b7d","#7bb8f5","#6ea7e0","#6195c9","#5684b2","#6d92f5","#5f82e0","#5675c9","#4d68b2","#9b9bc9","#8b8bb6","#7e7ea5","#747496"],["#d0eae4","#b3d7cf","#9bc4ba","#8fb4ac","#c3dffc","#aacdf0","#9bbde0","#97b4d1","#bdcdfb","#a8bbef","#96aae1","#8a9bcb","#d8d8eb","#c7c7dc","#b5b5cc","#a5a5bc"],["#f0f8f6","#deedea","#d7e6e2","#ceddda","#f1f7fe","#e5f0fb","#d8e5f2","#cfdbe7","#eff3fe","#e5eafa","#dde3f4","#d2d8ea","#f4f4f9","#e5e5ef","#dbdbe5","#d6d6df"],["#00a000","#008d00","#007700","#006000","#86d800","#73ba00","#629e00","#528400","#eded00","#cece00","#afaf00","#909000","#e3ab00","#c79600","#aa8000","#856400"],["#68c868","#5cb65c","#56a456","#4b924b","#b7e768","#a8d45f","#97c056","#86aa4d","#f1f164","#e1e15d","#caca58","#b2b24d","#eecc65","#dabc5e","#c7ac59","#b09850"],["#c6ecc6","#addead","#96cd96","#87b987","#e1f6c0","#d0eba6","#c1d99a","#b1c88c","#fbfbad","#f1f194","#e2e28e","#cece8c","#faeaba","#f2dfa7","#e6d090","#cbbb8b"],["#eef9ee","#dff1df","#d5e8d5","#c6dbc6","#f1fbe2","#e9f5d5","#dfebcd","#d4e1c0","#fefef0","#fafae3","#f0f0cb","#e4e4c5","#fdf8ea","#f9f2de","#eee4c7","#dfd7bf"],["#818181","#676767","#494949","#000000","#783c00","#673300","#562b00","#472300","#eb4600","#cd3d00","#ad3300","#8f2a00","#ed7700","#d26900","#af5800","#904800"],["#c9c9c9","#a9a9a9","#919191","#787878","#af8b68","#a28264","#917458","#856d55","#f19068","#dd8561","#c97654","#b47053","#f5ac63","#e1a05f","#ca9259","#b78451"],["#efefef","#dcdcdc","#c1c1c1","#9d9d9d","#dbcab9","#ccb8a5","#bda792","#a3917f","#fbcebc","#f1bba5","#e1aa93","#ce9f8b","#fcd7b3","#f3caa2","#e7b98c","#c8a078"],["#ffffff","#f7f7f7","#ededed","#dddddd","#f4efeb","#efe8e1","#e6ded6","#dbd3cc","#fef5f2","#fae8e1","#f0dbd3","#e1cbc2","#fef7f0","#faecde","#f1e2d3","#e3d3c3"]];var d="<table id=dropColor"+this.oRenderName+" style=\"background-color:#fcfcfc;\" unselectable=on cellpadding=0 cellspacing=0 width=140px><tr><td unselectable=on style='padding:2px;'>";d+="<table align=center cellpadding=0 cellspacing=0 border=0 unselectable=on>";for(var c=0;c<a.length;c++){d+="<tr>";for(var b=0;b<a[c].length;b++){d+='<td onclick="'+this.oName+".color='"+a[c][b]+"';"+this.oName+".onPickColor();"+this.oName+'.hideAll()" style="" unselectable=on><table style=\'-moz-border-radius:0px;-webkit-border-radius: 0px;margin:0px;padding:0px;width:12px;height:12px;background:'+a[c][b]+";' cellpadding=0 cellspacing=0 unselectable=on><tr><td unselectable=on style='cursor:pointer;margin:0px;padding:0px;line-height:normal;font-size:10px;'>&nbsp;</td></tr></table></td>"}d+="</tr>"}d+="<tr>";d+="<td colspan=16 unselectable=on style='padding:0px;'><table style='padding:0px;margin-left:1px;width:100%;height:14px;background:#f4f4f4;' cellpadding=0 cellspacing=0 unselectable=on><tr><td onclick=\""+this.oName+".onRemoveColor();"+this.oName+'.hideAll()" onmouseover="this.style.border=\'#777777 1px solid\'" onmouseout="this.style.border=\'white 1px solid\'" style="cursor:default;padding:1px;border:white 1px solid;font-family:verdana;font-size:10px;color:#000000;line-height:9px;" align=center valign=top unselectable=on>x</td></tr></table></td>';d+="</tr>";d+="</table>";d+="</td></tr></table>";return d}function hideColorPicker(){this.onHide();return;var box=eval("dropColor"+this.oRenderName);box.style.display="none";this.isActive=false}function hideColorPickerAll(){return;for(var i=0;i<arrColorPickerObjects.length;i++){var box=eval("dropColor"+eval(arrColorPickerObjects[i]).oRenderName);box.style.display="none";eval(arrColorPickerObjects[i]).isActive=false}}function loadHTML(sHTML){var oEditor=eval("idContent"+this.oName);var sStyle="";if(typeof this.css=="object"){for(var j=0;j<this.css.length;j++){sStyle+="<link href='"+this.css[j]+"' rel='stylesheet' type='text/css'>"}}else{if(this.css!=""){sStyle="<link href='"+this.css+"' rel='stylesheet' type='text/css'>"}}var oDoc=oEditor.document.open("text/html","replace");if(this.publishingPath!=""){var arrA=String(this.preloadHTML).match(/<base[^>]*>/ig);if(!arrA){sHTML=this.docType+'<html><head><base href="'+this.publishingPath+'"/>'+this.headContent+sStyle+"</head><body contenteditable=true>"+sHTML+"</body></html>"}}else{sHTML=this.docType+"<html><head>"+this.headContent+sStyle+"</head><body contentEditable='true'>"+sHTML+"</body></html>"}oDoc.write(sHTML);oDoc.close();oEditor.document.body.contentEditable=true;oEditor.document.execCommand("2D-Position",true,true);oEditor.document.execCommand("MultipleSelection",true,true);oEditor.document.execCommand("LiveResize",true,true);oEditor.document.body.onkeyup=new Function("editorDoc_onkeyup('"+this.oName+"')");oEditor.document.body.onmouseup=new Function("editorDoc_onmouseup('"+this.oName+"')");oEditor.document.body.onkeydown=new Function("doKeyPress(eval('idContent"+this.oName+"').event,'"+this.oName+"')");this.runtimeBorder(false);this.runtimeStyles();oEditor.document.body.onpaste=new Function("return "+this.oName+".doOnPaste()");oEditor.document.body.oncut=new Function(this.oName+".saveForUndo()");oEditor.document.body.style.lineHeight="1.2";oEditor.document.body.style.lineHeight="";if(this.initialRefresh){oEditor.document.execCommand("SelectAll");window.setTimeout("eval('idContentWord"+this.oName+"').document.execCommand('SelectAll');",0)}if(isIE9){if(this.arrStyle.length>0){var oElement=oEditor.document.createElement("STYLE");oEditor.document.documentElement.childNodes[0].appendChild(oElement);var sCssText="";for(var i=0;i<this.arrStyle.length;i++){selector=this.arrStyle[i][0];style=this.arrStyle[i][3];sCssText+=selector+" { "+style+" } "}oElement.appendChild(oEditor.document.createTextNode(sCssText))}}else{if(this.arrStyle.length>0){var oElement=oEditor.document.createElement("STYLE");var n=oEditor.document.styleSheets.length;oEditor.document.documentElement.childNodes[0].appendChild(oElement);for(var i=0;i<this.arrStyle.length;i++){selector=this.arrStyle[i][0];style=this.arrStyle[i][3];oEditor.document.styleSheets[n].addRule(selector,style)}}}this.cleanDeprecated()}function putHTML(sHTML){var oEditor=eval("idContent"+this.oName);var arrA=String(sHTML).match(/<!DOCTYPE[^>]*>/ig);if(arrA){for(var i=0;i<arrA.length;i++){this.docType=arrA[i]}}else{this.docType=""}var arrB=String(sHTML).match(/<HTML[^>]*>/ig);if(arrB){for(var i=0;i<arrB.length;i++){s=arrB[i];s=s.replace(/\"[^\"]*\"/ig,function(x){x=x.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/\s+/ig,"#_#");return x});s=s.replace(/<([^ >]*)/ig,function(x){return x.toLowerCase()});s=s.replace(/ ([^=]+)=([^" >]+)/ig,' $1="$2"');s=s.replace(/ ([^=]+)=/ig,function(x){return x.toLowerCase()});s=s.replace(/#_#/ig," ");this.html=s}}else{this.html="<html>"}var oDoc=oEditor.document.open("text/html","replace");oDoc.write(sHTML);oDoc.close();oEditor.document.body.contentEditable=true;oEditor.document.execCommand("2D-Position",true,true);oEditor.document.execCommand("MultipleSelection",true,true);oEditor.document.execCommand("LiveResize",true,true);oEditor.document.body.onkeyup=new Function("editorDoc_onkeyup('"+this.oName+"')");oEditor.document.body.onmouseup=new Function("editorDoc_onmouseup('"+this.oName+"')");oEditor.document.body.onkeydown=new Function("doKeyPress(eval('idContent"+this.oName+"').event,'"+this.oName+"')");this.runtimeBorder(false);this.runtimeStyles();this.cleanDeprecated()}function encodeHTMLCode(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function getTextBody(){var oEditor=eval("idContent"+this.oName);return oEditor.document.body.innerText}function getHTML(bEdit){var oEditor=eval("idContent"+this.oName);this.cleanDeprecated();sHTML=oEditor.document.documentElement.outerHTML;sHTML=String(sHTML).replace(/\<PARAM NAME=\"Play\" VALUE=\"0\">/ig,'<PARAM NAME="Play" VALUE="-1">');sHTML=this.docType+sHTML;sHTML=oUtil.replaceSpecialChar(sHTML);sHTML=sHTML.replace(/align=['"]*middle['"]*/gi,'align="center"');if(this.encodeIO){sHTML=encodeHTMLCode(sHTML)}if(!bEdit){sHTML=sHTML.replace(/ contenteditable=\"true\"/ig,"");sHTML=sHTML.replace(/ contenteditable=\"false\"/ig,"")}return sHTML}function getHTMLBody(bEdit){var oEditor=eval("idContent"+this.oName);this.cleanDeprecated();sHTML=oEditor.document.body.innerHTML;sHTML=String(sHTML).replace(/\<PARAM NAME=\"Play\" VALUE=\"0\">/ig,'<PARAM NAME="Play" VALUE="-1">');sHTML=oUtil.replaceSpecialChar(sHTML);sHTML=sHTML.replace(/align=['"]*middle['"]*/gi,'align="center"');if(this.encodeIO){sHTML=encodeHTMLCode(sHTML)}if(!bEdit){sHTML=sHTML.replace(/ contenteditable=\"true\"/ig,"");sHTML=sHTML.replace(/ contenteditable=\"false\"/ig,"")}return sHTML}var sBaseHREF="";function getXHTML(bEdit){var oEditor=eval("idContent"+this.oName);this.cleanDeprecated();sHTML=oEditor.document.documentElement.outerHTML;var arrTmp=sHTML.match(/<BASE([^>]*)>/ig);if(arrTmp!=null){sBaseHREF=arrTmp[0]}sBaseHREF=sBaseHREF.replace(/<([^ >]*)/ig,function(x){return x.toLowerCase()});sBaseHREF=sBaseHREF.replace(/ [^=]+="[^"]+"/ig,function(x){x=x.replace(/\s+/ig,"#_#");x=x.replace(/^#_#/," ");return x});sBaseHREF=sBaseHREF.replace(/ ([^=]+)=([^" >]+)/ig,' $1="$2"');sBaseHREF=sBaseHREF.replace(/ ([^=]+)=/ig,function(x){return x.toLowerCase()});sBaseHREF=sBaseHREF.replace(/#_#/ig," ");sBaseHREF=sBaseHREF.replace(/>$/ig," />").replace(/\/ \/>$/ig,"/>");sHTML=recur(oEditor.document.documentElement,"");sHTML=this.docType+this.html+sHTML+"\n</html>";sHTML=sHTML.replace(/<\/title>/,"</title>"+sBaseHREF);sHTML=oUtil.replaceSpecialChar(sHTML);sHTML=sHTML.replace(/align=['"]*middle['"]*/gi,'align="center"');if(this.encodeIO){sHTML=encodeHTMLCode(sHTML)}if(!bEdit){sHTML=sHTML.replace(/ contenteditable=\"true\"/ig,"");sHTML=sHTML.replace(/ contenteditable=\"false\"/ig,"")}return sHTML}function getXHTMLBody(bEdit){var oEditor=eval("idContent"+this.oName);this.cleanDeprecated();sHTML=oEditor.document.documentElement.outerHTML;var arrTmp=sHTML.match(/<BASE([^>]*)>/ig);if(arrTmp!=null){sBaseHREF=arrTmp[0]}sHTML=recur(oEditor.document.body,"");sHTML=oUtil.replaceSpecialChar(sHTML);sHTML=sHTML.replace(/align=['"]*middle['"]*/gi,'align="center"');if(this.encodeIO){sHTML=encodeHTMLCode(sHTML)}if(!bEdit){sHTML=sHTML.replace(/ contenteditable=\"true\"/ig,"");sHTML=sHTML.replace(/ contenteditable=\"false\"/ig,"")}return sHTML}function ApplyExternalStyle(oName){var edtObj=eval(oName);var oEditor=eval("idContent"+oName);var sTmp="";for(var j=0;j<oEditor.document.styleSheets.length;j++){var myStyle=oEditor.document.styleSheets[j];for(var i=0;i<myStyle.rules.length;i++){sSelector=myStyle.rules.item(i).selectorText;sCssText=myStyle.rules.item(i).style.cssText.replace(/"/g,"&quot;");if(sSelector.match(/table\./gi)){continue}if(edtObj.styleSelectorPrefix!=""&&!sSelector.indexOf("."+edtObj.styleSelectorPrefix)==0){continue}sSelector=sSelector.replace(/"/g,'\\"');var itemCount=sSelector.split(".").length;if(itemCount>1){sCaption=sSelector.split(".")[1];sTmp+=',["'+sSelector+'",true,"'+sCaption+'","'+sCssText+'"]'}else{sTmp+=',["'+sSelector+'",false,"","'+sCssText+'"]'}}}var arrStyle=eval("["+sTmp.substr(1)+"]");for(var i=0;i<arrStyle.length;i++){for(var j=0;j<edtObj.arrStyle.length;j++){if(arrStyle[i][0].toLowerCase()==edtObj.arrStyle[j][0].toLowerCase()){arrStyle[i][1]=edtObj.arrStyle[j][1]}}}edtObj.arrStyle=arrStyle}function doApplyStyle(oName,sClassName){if(!eval(oName).checkFocus()){return}var oEditor=eval("idContent"+oName);var oSel=oEditor.document.selection.createRange();eval(oName).saveForUndo();if(oUtil.activeElement){oElement=oUtil.activeElement;oElement.className=sClassName}else{if(oSel.parentElement){if(oSel.text==""){oElement=oSel.parentElement();if(oElement.tagName=="BODY"){return}oElement.className=sClassName}else{eval(oName).applySpanStyle([],sClassName)}}else{oElement=oSel.item(0);oElement.className=sClassName}}realTime(oName)}function openStyleSelect(){if(!this.isCssLoaded){ApplyExternalStyle(this.oName)}this.isCssLoaded=true;var k=false;var e=document.getElementById("idStyles"+this.oName);if(e.innerHTML!=""){if(e.style.display==""){e.style.display="none"}else{e.style.display=""}return}e.style.display="";var d=document.getElementById("idContent"+this.oName).offsetHeight-27;var l=this.arrStyle;var g="";g+="<div unselectable=on style='width:200px;margin:1px;margin-top:0;margin-right:2px;' align=right>";g+="<table style='margin-right:1px;margin-bottom:3px;width:14px;height:14px;background:#f4f4f4;' cellpadding=0 cellspacing=0 unselectable=on><tr><td onclick=\""+this.oName+".openStyleSelect();\" onmouseover=\"this.style.border='#708090 1px solid';this.style.color='white';this.style.backgroundColor='9FA7BB'\" onmouseout=\"this.style.border='white 1px solid';this.style.color='black';this.style.backgroundColor=''\" style=\"cursor:default;padding:1px;border:white 1px solid;font-family:verdana;font-size:10px;font-color:black;line-height:9px;\" align=center valign=top unselectable=on>x</td></tr></table></div>";var c="";for(var b=0;b<l.length;b++){sSelector=l[b][0];if(sSelector=="BODY"){c=l[b][3]}}g+="<div unselectable=on style='overflow:auto;width:200px;height:"+d+"px;padding-left:3px;'>";g+="<table name='tblStyles"+this.oName+"' id='tblStyles"+this.oName+"' cellpadding=0 cellspacing=0 style='background:#fcfcfc;"+c+";width:100%;height:100%;margin:0;'>";for(var b=0;b<l.length;b++){sSelector=l[b][0];isOnSelection=l[b][1];sCssText=l[b][3];sCaption=l[b][2];if(isOnSelection){if(sSelector.split(".").length>1){var a=sSelector;if(sSelector.indexOf(":")>0){a=sSelector.substring(0,sSelector.indexOf(":"))}k=true;if(a.indexOf("awesome")==-1){g+="<tr style=\"cursor:default\" onmouseover=\"if(this.style.marginRight!='1px'){this.style.background='"+this.styleSelectionHoverBg+"';this.style.color='"+this.styleSelectionHoverFg+"'}\" onmouseout=\"if(this.style.marginRight!='1px'){this.style.background='';this.style.color=''}\">";g+="<td unselectable=on onclick=\"doApplyStyle('"+this.oName+"','"+a.split(".")[1]+"')\" style='padding:2px;'>";if(sSelector.split(".")[0]==""){g+='<span unselectable=on style="'+sCssText+';margin:0;">'+sCaption+"</span>"}else{g+='<span unselectable=on style="'+sCssText+';margin:0;">'+sSelector+"</span>"}g+="</td></tr>"}}}}g+="<tr><td height=50%>&nbsp;</td></tr></table></div>";if(k){document.getElementById("idStyles"+this.oName).innerHTML=g}else{alert("No stylesheet found.")}}function editorDoc_onkeyup(oName){if(eval(oName).isAfterPaste){eval(oName).cleanDeprecated();eval(oName).runtimeBorder(false);eval(oName).runtimeStyles();eval(oName).isAfterPaste=false}var oEdt=eval(oName);if(oEdt.tmKeyup){clearTimeout(oEdt.tmKeyup);oEdt.tmKeyup=null}if(!oEdt.tmKeyup){oEdt.tmKeyup=setTimeout(function(){realTime(oName)},1000)}oEdt.bookmarkSelection()}function editorDoc_onmouseup(oName){oUtil.activeElement=null;oUtil.oName=oName;oUtil.oEditor=eval("idContent"+oName);oUtil.obj=eval(oName);eval(oName).hide();realTime(oName);oUtil.obj.bookmarkSelection()}function setActiveEditor(oName){oUtil.oName=oName;oUtil.oEditor=eval("idContent"+oName);oUtil.obj=eval(oName)}var arrTmp=[];function GetElement(b,a){while(b!=null&&b.tagName!=a){if(b.tagName=="BODY"){return null}b=b.parentElement}return b}var arrTmp2=[];function realTime(oName,bTagSel){if(!eval(oName).checkFocus()){return}var oEditor=eval("idContent"+oName);var oSel=oEditor.document.selection.createRange();var obj=eval(oName);var tbar=obj.tbar;var btn=null;var oTable=(oSel.parentElement!=null?GetElement(oSel.parentElement(),"TABLE"):GetElement(oSel.item(0),"TABLE"));if(oTable){obj.Table=oTable}var doc=oEditor.document;if(obj.btnParagraph){btn=tbar.btns["btnParagraph"+oName];btn.setState(doc.queryCommandEnabled("FormatBlock")?1:5)}if(obj.btnFontName){btn=tbar.btns["btnFontName"+oName];btn.setState(doc.queryCommandEnabled("FontName")?1:5)}if(obj.btnFontSize){btn=tbar.btns["btnFontSize"+oName];btn.setState(doc.queryCommandEnabled("FontSize")?1:5)}if(obj.btnCut){btn=tbar.btns["btnCut"+oName];btn.setState(doc.queryCommandEnabled("Cut")?1:5)}if(obj.btnCopy){btn=tbar.btns["btnCopy"+oName];btn.setState(doc.queryCommandEnabled("Copy")?1:5)}if(obj.btnPaste){btn=tbar.btns["btnPaste"+oName];btn.setState(doc.queryCommandEnabled("Paste")?1:5)}if(obj.btnUndo){btn=tbar.btns["btnUndo"+oName];btn.setState(!obj.arrUndoList[0]?5:1)}if(obj.btnRedo){btn=tbar.btns["btnRedo"+oName];btn.setState(!obj.arrRedoList[0]?5:1)}if(obj.btnBold){btn=tbar.btns["btnBold"+oName];btn.setState(doc.queryCommandEnabled("Bold")?(doc.queryCommandState("Bold")?4:1):5)}if(obj.btnItalic){btn=tbar.btns["btnItalic"+oName];btn.setState(doc.queryCommandEnabled("Italic")?(doc.queryCommandState("Italic")?4:1):5)}if(obj.btnUnderline){btn=tbar.btns["btnUnderline"+oName];btn.setState(doc.queryCommandEnabled("Underline")?(doc.queryCommandState("Underline")?4:1):5)}if(obj.btnStrikethrough){btn=tbar.btns["btnStrikethrough"+oName];btn.setState(doc.queryCommandEnabled("Strikethrough")?(doc.queryCommandState("Strikethrough")?4:1):5)}if(obj.btnSuperscript){btn=tbar.btns["btnSuperscript"+oName];btn.setState(doc.queryCommandEnabled("Superscript")?(doc.queryCommandState("Superscript")?4:1):5)}if(obj.btnSubscript){btn=tbar.btns["btnSubscript"+oName];btn.setState(doc.queryCommandEnabled("Subscript")?(doc.queryCommandState("Subscript")?4:1):5)}if(obj.btnNumbering){btn=tbar.btns["btnNumbering"+oName];btn.setState(doc.queryCommandEnabled("InsertOrderedList")?(doc.queryCommandState("InsertOrderedList")?4:1):5)}if(obj.btnBullets){btn=tbar.btns["btnBullets"+oName];btn.setState(doc.queryCommandEnabled("InsertUnorderedList")?(doc.queryCommandState("InsertUnorderedList")?4:1):5)}if(obj.btnJustifyLeft){btn=tbar.btns["btnJustifyLeft"+oName];btn.setState(doc.queryCommandEnabled("JustifyLeft")?(doc.queryCommandState("JustifyLeft")?4:1):5)}if(obj.btnJustifyCenter){btn=tbar.btns["btnJustifyCenter"+oName];btn.setState(doc.queryCommandEnabled("JustifyCenter")?(doc.queryCommandState("JustifyCenter")?4:1):5)}if(obj.btnJustifyRight){btn=tbar.btns["btnJustifyRight"+oName];btn.setState(doc.queryCommandEnabled("JustifyRight")?(doc.queryCommandState("JustifyRight")?4:1):5)}if(obj.btnJustifyFull){btn=tbar.btns["btnJustifyFull"+oName];btn.setState(doc.queryCommandEnabled("JustifyFull")?(doc.queryCommandState("JustifyFull")?4:1):5)}if(obj.btnIndent){btn=tbar.btns["btnIndent"+oName];btn.setState(doc.queryCommandEnabled("Indent")?1:5)}if(obj.btnOutdent){btn=tbar.btns["btnOutdent"+oName];btn.setState(doc.queryCommandEnabled("Outdent")?1:5)}if(obj.btnLTR){btn=tbar.btns["btnLTR"+oName];btn.setState(doc.queryCommandEnabled("BlockDirLTR")?(doc.queryCommandState("BlockDirLTR")?4:1):5)}if(obj.btnRTL){btn=tbar.btns["btnRTL"+oName];btn.setState(doc.queryCommandEnabled("BlockDirRTL")?(doc.queryCommandState("BlockDirRTL")?4:1):5)}var v=(oSel.parentElement?1:5);if(obj.btnForeColor){tbar.btns["btnForeColor"+oName].setState(v)}if(obj.btnBackColor){tbar.btns["btnBackColor"+oName].setState(v)}if(obj.btnLine){tbar.btns["btnLine"+oName].setState(v)}try{oUtil.onSelectionChanged()}catch(e){}var idStyles=document.getElementById("idStyles"+oName);if(idStyles.innerHTML!=""){var oElement;if(oUtil.activeElement){oElement=oUtil.activeElement}else{if(oSel.parentElement){oElement=oSel.parentElement()}else{oElement=oSel.item(0)}}var sCurrClass=oElement.className;var oRows=document.getElementById("tblStyles"+oName).rows;for(var i=0;i<oRows.length-1;i++){sClass=oRows[i].childNodes[0].innerText;if(sClass.split(".").length>1&&sClass!=""){sClass=sClass.split(".")[1]}if(sCurrClass==sClass){oRows[i].style.marginRight="1px";oRows[i].style.backgroundColor=obj.styleSelectionHoverBg;oRows[i].style.color=obj.styleSelectionHoverFg}else{oRows[i].style.marginRight="";oRows[i].style.backgroundColor="";oRows[i].style.color=""}}}if(obj.useTagSelector&&!bTagSel){if(oSel.parentElement){oElement=oSel.parentElement()}else{oElement=oSel.item(0)}var sHTML="";var i=0;arrTmp2=[];while(oElement!=null&&oElement.tagName!="BODY"){arrTmp2[i]=oElement;var sTagName=oElement.tagName;sHTML="&nbsp; &lt;<span id=tag"+oName+i+" unselectable=on style='text-decoration:underline;cursor:pointer' onclick=\""+oName+".selectElement("+i+')">'+sTagName+"</span>&gt;"+sHTML;oElement=oElement.parentElement;i++}sHTML="&nbsp;&lt;BODY&gt;"+sHTML;eval("idElNavigate"+oName).innerHTML=sHTML;eval("idElCommand"+oName).style.display="none"}if(obj.isAfterPaste){obj.cleanDeprecated();obj.runtimeBorder(false);obj.runtimeStyles();obj.isAfterPaste=false}if(tbar.btns["btnQuote"+oName]){var oQuote=(oSel.parentElement!=null?GetElement(oSel.parentElement(),"BLOCKQUOTE"):GetElement(oSel.item(0),"BLOCKQUOTE"));if(oQuote){tbar.btns["btnQuote"+oName].setState(4)}else{tbar.btns["btnQuote"+oName].setState(1)}}}function realtimeFontSelect(oName){var oEditor=eval("idContent"+oName);var sFontName=oEditor.document.queryCommandValue("FontName");var edt=eval(oName);var found=false;for(var i=0;i<edt.arrFontName.length;i++){if(sFontName==edt.arrFontName[i]){found=true;break}}if(found){isDDs["ddFontName"+oName].selectItem("btnFontName_"+i+oName,true)}else{isDDs["ddFontName"+oName].clearSelection()}}function realtimeSizeSelect(oName){var oEditor=eval("idContent"+oName);var sFontSize=oEditor.document.queryCommandValue("FontSize");var edt=eval(oName);var found=false;for(var i=0;i<edt.arrFontSize.length;i++){if(sFontSize==edt.arrFontSize[i][1]){found=true;break}}if(found){isDDs["ddFontSize"+oName].selectItem("btnFontSize_"+i+oName,true)}else{isDDs["ddFontSize"+oName].clearSelection()}}function moveTagSelector(){var sTagSelTop="<table unselectable=on ondblclick='"+this.oName+".moveTagSelector()' width='100%' cellpadding=0 cellspacing=0 style='border:none;border:#cfcfcf 1px solid;border-bottom:none;margin:0px;'><tr style='background:#f8f8f8;font-family:arial;font-size:10px;color:black;'><td id=idElNavigate"+this.oName+" style='color:inherit;line-height:normal;font-size:inherit;padding:1px;width:100%;' valign=top>&nbsp;</td><td align=right valign='center' nowrap style='color:inherit;padding:0;margin;0;font-size:inherit;line-height:normal'><span id=idElCommand"+this.oName+" unselectable=on style='vertical-align:middle;display:none;text-decoration:underline;cursor:pointer;padding-right:5px;' onclick='"+this.oName+".removeTag()'>"+getTxt("Remove Tag")+"</span></td></tr></table>";var sTagSelBottom="<table unselectable=on ondblclick='"+this.oName+".moveTagSelector()' width='100%' cellpadding=0 cellspacing=0 style='border:none;border-left:#cfcfcf 1px solid;border-right:#cfcfcf 1px solid;margin:0px;'><tr style='background-color:#f8f8f8;font-family:arial;font-size:10px;color:black;'><td id=idElNavigate"+this.oName+" style='color:inherit;line-height:normal;font-size:inherit;padding:1px;width:100%;' valign=top>&nbsp;</td><td align=right valign='center' nowrap style='color:inherit;padding:0;margin;0;font-size:inherit;line-height:normal'><span id=idElCommand"+this.oName+" unselectable=on style='vertical-align:middle;display:none;text-decoration:underline;cursor:pointer;padding-right:5px;' onclick='"+this.oName+".removeTag()'>"+getTxt("Remove Tag")+"</span></td></tr></table>";if(this.TagSelectorPosition=="top"){eval("idTagSelTop"+this.oName).innerHTML="";eval("idTagSelBottom"+this.oName).innerHTML=sTagSelBottom;eval("idTagSelTopRow"+this.oName).style.display="none";eval("idTagSelBottomRow"+this.oName).style.display="block";this.TagSelectorPosition="bottom"}else{eval("idTagSelTop"+this.oName).innerHTML=sTagSelTop;eval("idTagSelBottom"+this.oName).innerHTML="";eval("idTagSelTopRow"+this.oName).style.display="block";eval("idTagSelBottomRow"+this.oName).style.display="none";this.TagSelectorPosition="top"}}function selectElement(i){var oEditor=eval("idContent"+this.oName);var oSelRange=oEditor.document.body.createControlRange();var oActiveElement;try{oSelRange.add(arrTmp2[i]);oSelRange.select();realTime(this.oName,true);oActiveElement=arrTmp2[i];if(oActiveElement.tagName!="TD"&&oActiveElement.tagName!="TR"&&oActiveElement.tagName!="TBODY"&&oActiveElement.tagName!="LI"){eval("idElCommand"+this.oName).style.display=""}}catch(e){try{var oSelRange=oEditor.document.body.createTextRange();oSelRange.moveToElementText(arrTmp2[i]);oSelRange.select();realTime(this.oName,true);oActiveElement=arrTmp2[i];if(oActiveElement.tagName!="TD"&&oActiveElement.tagName!="TR"&&oActiveElement.tagName!="TBODY"&&oActiveElement.tagName!="LI"){eval("idElCommand"+this.oName).style.display=""}}catch(e){return}}for(var j=0;j<arrTmp2.length;j++){eval("tag"+this.oName+j).style.background=""}eval("tag"+this.oName+i).style.background="DarkGray";if(oActiveElement){oUtil.activeElement=oActiveElement}}function removeTag(){if(!this.checkFocus()){return}eval(this.oName).saveForUndo();var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();var sType=oEditor.document.selection.type;if(sType=="Control"){oSel.item(0).outerHTML="";this.focus();realTime(this.oName);return}var oActiveElement=oUtil.activeElement;var oSelRange=oEditor.document.body.createTextRange();oSelRange.moveToElementText(oActiveElement);oSel.setEndPoint("StartToStart",oSelRange);oSel.setEndPoint("EndToEnd",oSelRange);oSel.select();this.saveForUndo();sHTML=oActiveElement.innerHTML;sHTML=fixPathEncode(sHTML);var oTmp=oActiveElement.parentElement;if(oTmp.innerHTML==oActiveElement.outerHTML){oTmp.innerHTML=sHTML;fixPathDecode(oEditor);var oSelRange=oEditor.document.body.createTextRange();oSelRange.moveToElementText(oTmp);oSel.setEndPoint("StartToStart",oSelRange);oSel.setEndPoint("EndToEnd",oSelRange);oSel.select();realTime(this.oName);this.selectElement(0);return}else{oActiveElement.outerHTML="";oSel.pasteHTML(sHTML);fixPathDecode(oEditor);this.focus();realTime(this.oName)}this.runtimeBorder(false);this.runtimeStyles()}function runtimeBorderOn(){this.runtimeBorderOff();var oEditor=eval("idContent"+this.oName);var oTables=oEditor.document.getElementsByTagName("TABLE");for(i=0;i<oTables.length;i++){var oTable=oTables[i];if(oTable.border==0){var oCells=oTable.getElementsByTagName("TD");for(j=0;j<oCells.length;j++){if(oCells[j].style.borderLeftWidth=="0px"||oCells[j].style.borderLeftWidth==""||oCells[j].style.borderLeftWidth=="medium"){oCells[j].runtimeStyle.borderLeftWidth="1px";oCells[j].runtimeStyle.borderLeftColor="#BCBCBC";oCells[j].runtimeStyle.borderLeftStyle="dotted"}if(oCells[j].style.borderRightWidth=="0px"||oCells[j].style.borderRightWidth==""||oCells[j].style.borderRightWidth=="medium"){oCells[j].runtimeStyle.borderRightWidth="1px";oCells[j].runtimeStyle.borderRightColor="#BCBCBC";oCells[j].runtimeStyle.borderRightStyle="dotted"}if(oCells[j].style.borderTopWidth=="0px"||oCells[j].style.borderTopWidth==""||oCells[j].style.borderTopWidth=="medium"){oCells[j].runtimeStyle.borderTopWidth="1px";oCells[j].runtimeStyle.borderTopColor="#BCBCBC";oCells[j].runtimeStyle.borderTopStyle="dotted"}if(oCells[j].style.borderBottomWidth=="0px"||oCells[j].style.borderBottomWidth==""||oCells[j].style.borderBottomWidth=="medium"){oCells[j].runtimeStyle.borderBottomWidth="1px";oCells[j].runtimeStyle.borderBottomColor="#BCBCBC";oCells[j].runtimeStyle.borderBottomStyle="dotted"}}}}}function runtimeBorderOff(){var oEditor=eval("idContent"+this.oName);var oTables=oEditor.document.getElementsByTagName("TABLE");for(i=0;i<oTables.length;i++){var oTable=oTables[i];if(oTable.border==0){var oCells=oTable.getElementsByTagName("TD");for(j=0;j<oCells.length;j++){oCells[j].runtimeStyle.borderWidth="";oCells[j].runtimeStyle.borderColor="";oCells[j].runtimeStyle.borderStyle=""}}}}function runtimeBorder(a){if(a){if(this.IsRuntimeBorderOn){this.runtimeBorderOff();this.IsRuntimeBorderOn=false}else{this.runtimeBorderOn();this.IsRuntimeBorderOn=true}}else{if(this.IsRuntimeBorderOn){this.runtimeBorderOn()}else{this.runtimeBorderOff()}}}function runtimeStyles(){var oEditor=eval("idContent"+this.oName);var oForms=oEditor.document.getElementsByTagName("FORM");for(i=0;i<oForms.length;i++){oForms[i].runtimeStyle.border="#7bd158 1px dotted"}var oBookmarks=oEditor.document.getElementsByTagName("A");for(i=0;i<oBookmarks.length;i++){var oBookmark=oBookmarks[i];if(oBookmark.name||oBookmark.NAME){if(oBookmark.innerHTML==""){oBookmark.runtimeStyle.width="1px"}oBookmark.runtimeStyle.padding="0px";oBookmark.runtimeStyle.paddingLeft="1px";oBookmark.runtimeStyle.paddingRight="1px";oBookmark.runtimeStyle.border="#888888 1px dotted";oBookmark.runtimeStyle.borderLeft="#cccccc 10px solid"}}}function cleanFonts(){var oEditor=eval("idContent"+this.oName);var allFonts=oEditor.document.body.getElementsByTagName("FONT");if(allFonts.length==0){return false}var f;while(allFonts.length>0){f=allFonts[0];if(f.hasChildNodes&&f.childNodes.length==1&&f.childNodes[0].nodeType==1&&f.childNodes[0].nodeName=="SPAN"){copyAttribute(f.childNodes[0],f);f.removeNode(false)}else{if(f.parentElement.nodeName=="SPAN"&&f.parentElement.childNodes.length==1){copyAttribute(f.parentElement,f);f.removeNode(false)}else{var newSpan=oEditor.document.createElement("SPAN");copyAttribute(newSpan,f);var sHTML=f.innerHTML;sHTML=fixPathEncode(sHTML);newSpan.innerHTML=sHTML;f.replaceNode(newSpan);fixPathDecode(oEditor)}}}return true}function cleanTags(elements,sVal){var oEditor=eval("idContent"+this.oName);var f;while(elements.length>0){f=elements[0];if(f.hasChildNodes&&f.childNodes.length==1&&f.childNodes[0].nodeType==1&&f.childNodes[0].nodeName=="SPAN"){if(sVal=="bold"){f.childNodes[0].style.fontWeight="bold"}if(sVal=="italic"){f.childNodes[0].style.fontStyle="italic"}if(sVal=="line-through"){f.childNodes[0].style.textDecoration="line-through"}if(sVal=="underline"){f.childNodes[0].style.textDecoration="underline"}f.removeNode(false)}else{if(f.parentElement.nodeName=="SPAN"&&f.parentElement.childNodes.length==1){if(sVal=="bold"){f.parentElement.style.fontWeight="bold"}if(sVal=="italic"){f.parentElement.style.fontStyle="italic"}if(sVal=="line-through"){f.parentElement.style.textDecoration="line-through"}if(sVal=="underline"){f.parentElement.style.textDecoration="underline"}f.removeNode(false)}else{var newSpan=oEditor.document.createElement("SPAN");if(sVal=="bold"){newSpan.style.fontWeight="bold"}if(sVal=="italic"){newSpan.style.fontStyle="italic"}if(sVal=="line-through"){newSpan.style.textDecoration="line-through"}if(sVal=="underline"){newSpan.style.textDecoration="underline"}var sHTML=f.innerHTML;sHTML=fixPathEncode(sHTML);newSpan.innerHTML=sHTML;f.replaceNode(newSpan);fixPathDecode(oEditor)}}}}function replaceTags(sFrom,sTo){var oEditor=eval("idContent"+this.oName);var elements=oEditor.document.getElementsByTagName(sFrom);var newSpan;var count=elements.length;while(count>0){f=elements[0];newSpan=oEditor.document.createElement(sTo);var sHTML=f.innerHTML;sHTML=fixPathEncode(sHTML);newSpan.innerHTML=sHTML;f.replaceNode(newSpan);fixPathDecode(oEditor);count--}}function cleanDeprecated(){var oEditor=eval("idContent"+this.oName);var elements;elements=oEditor.document.body.getElementsByTagName("STRIKE");this.cleanTags(elements,"line-through");elements=oEditor.document.body.getElementsByTagName("S");this.cleanTags(elements,"line-through");elements=oEditor.document.body.getElementsByTagName("U");this.cleanTags(elements,"underline");this.replaceTags("DIR","DIV");this.replaceTags("MENU","DIV");this.replaceTags("CENTER","DIV");this.replaceTags("XMP","PRE");this.replaceTags("BASEFONT","SPAN");elements=oEditor.document.body.getElementsByTagName("APPLET");var count=elements.length;while(count>0){f=elements[0];f.removeNode(false);count--}this.cleanFonts();this.cleanEmptySpan();return true}function applyBold(){if(!this.checkFocus()){return}var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();this.saveForUndo();this.doCmd("bold");return;var currState=oEditor.document.queryCommandState("Bold");if(oUtil.activeElement){oElement=oUtil.activeElement}else{if(oSel.parentElement){if(oSel.text==""){oElement=oSel.parentElement();if(oElement.tagName=="BODY"){return}}else{if(currState){this.applySpanStyle([["fontWeight",""]]);this.cleanEmptySpan()}else{this.applySpanStyle([["fontWeight","bold"]])}if(currState==oEditor.document.queryCommandState("Bold")&&currState==true){this.applySpanStyle([["fontWeight","normal"]])}return}}else{oElement=oSel.item(0)}}if(currState){oElement.style.fontWeight=""}else{oElement.style.fontWeight="bold"}if(currState==oEditor.document.queryCommandState("Bold")&&currState==true){oElement.style.fontWeight="normal"}}function applyItalic(){if(!this.checkFocus()){return}var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();this.saveForUndo();this.doCmd("italic");return;var currState=oEditor.document.queryCommandState("Italic");if(oUtil.activeElement){oElement=oUtil.activeElement}else{if(oSel.parentElement){if(oSel.text==""){oElement=oSel.parentElement();if(oElement.tagName=="BODY"){return}}else{if(currState){this.applySpanStyle([["fontStyle",""]]);this.cleanEmptySpan()}else{this.applySpanStyle([["fontStyle","italic"]])}if(currState==oEditor.document.queryCommandState("Italic")&&currState==true){this.applySpanStyle([["fontStyle","normal"]])}return}}else{oElement=oSel.item(0)}}if(currState){oElement.style.fontStyle=""}else{oElement.style.fontStyle="italic"}if(currState==oEditor.document.queryCommandState("Italic")&&currState==true){oElement.style.fontStyle="normal"}}function GetUnderlinedTag(a){while(a!=null&&a.style.textDecoration.indexOf("underline")==-1){if(a.tagName=="BODY"){return null}a=a.parentElement}return a}function GetOverlinedTag(a){while(a!=null&&a.style.textDecoration.indexOf("line-through")==-1){if(a.tagName=="BODY"){return null}a=a.parentElement}return a}function applyLine(sCmd){if(!this.checkFocus()){return}var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();this.saveForUndo();if(!oSel.parentElement){return}var bIsUnderlined=oEditor.document.queryCommandState("Underline");var bIsOverlined=oEditor.document.queryCommandState("Strikethrough");if(bIsUnderlined&&!bIsOverlined){if(sCmd=="underline"){oElement=GetUnderlinedTag(oSel.parentElement());if(oElement){oElement.style.textDecoration=oElement.style.textDecoration.replace("underline","")}}else{if(oSel.text==""){oElement=oSel.parentElement();oElement.style.textDecoration=oElement.style.textDecoration+" line-through"}else{this.applySpanStyle([["textDecoration","line-through"]])}}}else{if(bIsOverlined&&!bIsUnderlined){if(sCmd=="line-through"){oElement=GetOverlinedTag(oSel.parentElement());if(oElement){oElement.style.textDecoration=oElement.style.textDecoration.replace("line-through","")}}else{if(oSel.text==""){oElement=oSel.parentElement();oElement.style.textDecoration=oElement.style.textDecoration+" underline"}else{this.applySpanStyle([["textDecoration","underline"]])}}}else{if(bIsUnderlined&&bIsOverlined){if(sCmd=="underline"){oElement=GetUnderlinedTag(oSel.parentElement());if(oElement){oElement.style.textDecoration=oElement.style.textDecoration.replace("underline","")}}else{oElement=GetOverlinedTag(oSel.parentElement());if(oElement){oElement.style.textDecoration=oElement.style.textDecoration.replace("line-through","")}}}else{if(sCmd=="underline"){if(oSel.text==""){oElement=oSel.parentElement();if(oElement.tagName=="BODY"){return}oElement.style.textDecoration="underline"}else{this.applySpanStyle([["textDecoration","underline"]])}}else{if(oSel.text==""){oElement=oSel.parentElement();if(oElement.tagName=="BODY"){return}oElement.style.textDecoration="line-through"}else{this.applySpanStyle([["textDecoration","line-through"]])}}}}}return;var currState1=oEditor.document.queryCommandState("Underline");var currState2=oEditor.document.queryCommandState("Strikethrough");var sValue;if(sCmd=="underline"){if(currState1&&currState2){sValue="line-through"}else{if(!currState1&&currState2){sValue="underline line-through"}else{if(currState1&&!currState2){sValue=""}else{if(!currState1&&!currState2){sValue="underline"}}}}}else{if(currState1&&currState2){sValue="underline"}else{if(!currState1&&currState2){sValue=""}else{if(currState1&&!currState2){sValue="underline line-through"}else{if(!currState1&&!currState2){sValue="line-through"}}}}}if(oUtil.activeElement){oElement=oUtil.activeElement}else{if(oSel.parentElement){if(oSel.text==""){oElement=oSel.parentElement();if(oElement.tagName=="BODY"){return}}else{if(sValue==""){this.applySpanStyle([["textDecoration",""]]);this.cleanEmptySpan()}else{this.applySpanStyle([["textDecoration",sValue]])}if((sCmd=="underline"&&currState1==oEditor.document.queryCommandState("Underline")&&currState1==true)||(sCmd=="line-through"&&currState2==oEditor.document.queryCommandState("Strikethrough")&&currState2==true)){this.applySpanStyle([["textDecoration",""]]);this.cleanEmptySpan()}return}}else{oElement=oSel.item(0)}}oElement.style.textDecoration=sValue;if((sCmd=="underline"&&currState1==oEditor.document.queryCommandState("Underline")&&currState1==true)||(sCmd=="line-through"&&currState2==oEditor.document.queryCommandState("Strikethrough")&&currState2==true)){this.applySpanStyle([["textDecoration",""]]);this.cleanEmptySpan()}}function applyColor(sType,sColor){if(!this.checkFocus()){return}this.hide();var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();this.saveForUndo();if(oUtil.activeElement){oElement=oUtil.activeElement;if(sType=="ForeColor"){oElement.style.color=sColor}else{oElement.style.backgroundColor=sColor}}else{if(oSel.parentElement){if(oSel.text==""){oElement=oSel.parentElement();if(oElement.tagName=="BODY"){return}if(sType=="ForeColor"){oElement.style.color=sColor}else{oElement.style.backgroundColor=sColor}}else{if(sType=="ForeColor"){this.applySpanStyle([["color",sColor]])}else{this.applySpanStyle([["backgroundColor",sColor]])}}}}if(sColor==""){this.cleanEmptySpan();realTime(this.oName)}}function applyFontName(val){this.hide();if(!this.checkFocus()){return}var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();this.hide();oSel.select();this.saveForUndo();if(oSel.parentElement){var tempRange=oEditor.document.body.createTextRange();var allSpans=oEditor.document.getElementsByTagName("SPAN");for(var i=0;i<allSpans.length;i++){tempRange.moveToElementText(allSpans[i]);if(oSel.inRange(tempRange)){allSpans[i].style.fontFamily=val}}}this.doCmd("fontname",val);replaceWithSpan(oEditor);realTime(this.oName)}function applyFontSize(val){this.hide();if(!this.checkFocus()){return}var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();this.hide();oSel.select();this.saveForUndo();if(oSel.parentElement){var tempRange=oEditor.document.body.createTextRange();var allSpans=oEditor.document.getElementsByTagName("SPAN");for(var i=0;i<allSpans.length;i++){tempRange.moveToElementText(allSpans[i]);if(oSel.inRange(tempRange)){if(val==1){allSpans[i].style.fontSize="8pt"}else{if(val==2){allSpans[i].style.fontSize="10pt"}else{if(val==3){allSpans[i].style.fontSize="12pt"}else{if(val==4){allSpans[i].style.fontSize="14pt"}else{if(val==5){allSpans[i].style.fontSize="18pt"}else{if(val==6){allSpans[i].style.fontSize="24pt"}else{if(val=7){allSpans[i].style.fontSize="36pt"}}}}}}}}}}this.doCmd("fontsize",val);replaceWithSpan(oEditor);realTime(this.oName)}function applySpanStyle(arrStyles,sClassName){var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();this.hide();oSel.select();this.saveForUndo();if(oSel.parentElement){var tempRange=oEditor.document.body.createTextRange();var oEl=oSel.parentElement();var allSpans=oEditor.document.getElementsByTagName("SPAN");for(var i=0;i<allSpans.length;i++){tempRange.moveToElementText(allSpans[i]);if(oSel.inRange(tempRange)){copyStyleClass(allSpans[i],arrStyles,sClassName)}}}this.doCmd("fontname","default");replaceWithSpan(oEditor,arrStyles,sClassName);this.cleanEmptySpan();realTime(this.oName)}function doClean(){if(!this.checkFocus()){return}var oEditor=eval("idContent"+this.oName);this.saveForUndo();this.doCmd("RemoveFormat");if(oUtil.activeElement){var oActiveElement=oUtil.activeElement;oActiveElement.removeAttribute("className",0);oActiveElement.removeAttribute("style",0);if(oActiveElement.tagName=="H1"||oActiveElement.tagName=="H2"||oActiveElement.tagName=="H3"||oActiveElement.tagName=="H4"||oActiveElement.tagName=="H5"||oActiveElement.tagName=="H6"||oActiveElement.tagName=="PRE"||oActiveElement.tagName=="P"||oActiveElement.tagName=="DIV"){if(this.returnKeyMode==1){this.doCmd("FormatBlock","<DIV>")}else{this.doCmd("FormatBlock","<P>")}}}else{var oSel=oEditor.document.selection.createRange();var sType=oEditor.document.selection.type;if(oSel.parentElement){if(oSel.text==""){oEl=oSel.parentElement();if(oEl.tagName=="BODY"){return}else{oEl.removeAttribute("className",0);oEl.removeAttribute("style",0);if(oEl.tagName=="H1"||oEl.tagName=="H2"||oEl.tagName=="H3"||oEl.tagName=="H4"||oEl.tagName=="H5"||oEl.tagName=="H6"||oEl.tagName=="PRE"||oEl.tagName=="P"||oEl.tagName=="DIV"){if(this.returnKeyMode==1){this.doCmd("FormatBlock","<DIV>")}else{this.doCmd("FormatBlock","<P>")}}}}else{this.applySpanStyle([["backgroundColor",""],["color",""],["fontFamily",""],["fontSize",""],["fontWeight",""],["fontStyle",""],["textDecoration",""],["letterSpacing",""],["verticalAlign",""],["textTransform",""],["fontVariant",""]],"");return}}else{oEl=oSel.item(0);oEl.removeAttribute("className",0);oEl.removeAttribute("style",0)}}this.cleanEmptySpan();realTime(this.oName)}function cleanEmptySpan(){var bReturn=false;var oEditor=eval("idContent"+this.oName);var allSpans=oEditor.document.getElementsByTagName("SPAN");if(allSpans.length==0){return false}var emptySpans=[];var reg=/<\s*SPAN\s*>/gi;for(var i=0;i<allSpans.length;i++){if(allSpans[i].outerHTML.search(reg)==0){emptySpans[emptySpans.length]=allSpans[i]}}var theSpan,theParent;for(var i=0;i<emptySpans.length;i++){theSpan=emptySpans[i];theSpan.removeNode(false);bReturn=true}return bReturn}function copyStyleClass(b,d,a){if(d){for(var c=0;c<d.length;c++){b.style[d[c][0]]=d[c][1]}}if(b.style.fontFamily==""){b.style.cssText=b.style.cssText.replace("FONT-FAMILY: ; ","");b.style.cssText=b.style.cssText.replace("FONT-FAMILY: ","")}if(a!=null){b.className=a;if(b.className==""){b.removeAttribute("className",0)}}}function copyAttribute(b,c){if((c.face!=null)&&(c.face!="")){b.style.fontFamily=c.face}if((c.size!=null)&&(c.size!="")){var a="";if(c.size==1){a="8pt"}else{if(c.size==2){a="10pt"}else{if(c.size==3){a="12pt"}else{if(c.size==4){a="14pt"}else{if(c.size==5){a="18pt"}else{if(c.size==6){a="24pt"}else{if(c.size>=7){a="36pt"}else{if(c.size<=-2||c.size=="0"){a="8pt"}else{if(c.size=="-1"){a="10pt"}else{if(c.size==0){a="12pt"}else{if(c.size=="+1"){a="14pt"}else{if(c.size=="+2"){a="18pt"}else{if(c.size=="+3"){a="24pt"}else{if(c.size=="+4"||c.size=="+5"||c.size=="+6"){a="36pt"}else{a=""}}}}}}}}}}}}}}if(a!=""){b.style.fontSize=a}}if((c.style.backgroundColor!=null)&&(c.style.backgroundColor!="")){b.style.backgroundColor=c.style.backgroundColor}if((c.color!=null)&&(c.color!="")){b.style.color=c.color}if((c.className!=null)&&(c.className!="")){b.className=c.className}}function replaceWithSpan(oEditor,arrStyles,sClassName){var oSel=oEditor.document.selection.createRange();var oSpanStart;oSel.select();var nSelLength=oSel.text.length;var allFonts=new Array();if(oSel.parentElement().nodeName=="FONT"&&oSel.parentElement().innerText==oSel.text){oSel.moveToElementText(oSel.parentElement());allFonts[0]=oSel.parentElement()}else{allFonts=oEditor.document.getElementsByTagName("FONT")}var tempRange=oEditor.document.body.createTextRange();var newSpan,f;var count=allFonts.length;while(count>0){f=allFonts[0];if(f==null||f.parentElement==null){count--;continue}tempRange.moveToElementText(f);var sTemp="f";var nLevel=0;while(eval(sTemp+".parentElement")){nLevel++;sTemp+=".parentElement"}var bBreak=false;for(var j=nLevel;j>0;j--){sTemp="f";for(var k=1;k<=j;k++){sTemp+=".parentElement"}if(!bBreak){if(eval(sTemp).nodeName=="SPAN"&&eval(sTemp).innerText==f.innerText){newSpan=eval(sTemp);if(arrStyles||sClassName){copyStyleClass(newSpan,arrStyles,sClassName)}else{copyAttribute(newSpan,f)}f.removeNode(false);bBreak=true}}}if(bBreak){continue}newSpan=oEditor.document.createElement("SPAN");if(arrStyles||sClassName){copyStyleClass(newSpan,arrStyles,sClassName)}else{copyAttribute(newSpan,f)}var sHTML=f.innerHTML;sHTML=fixPathEncode(sHTML);newSpan.innerHTML=sHTML;f.replaceNode(newSpan);fixPathDecode(oEditor);count--;if(!oSpanStart){oSpanStart=newSpan}}var rng=oEditor.document.selection.createRange();if(oSpanStart){rng.moveToElementText(oSpanStart);rng.select()}rng.moveEnd("character",nSelLength-rng.text.length);rng.select();rng.moveEnd("character",nSelLength-rng.text.length);rng.select();rng.moveEnd("character",nSelLength-rng.text.length);rng.select()}function doOnPaste(){this.isAfterPaste=true;this.saveForUndo();if(this.pasteTextOnCtrlV==true){this.doPasteText();return false}}function doPaste(){this.saveForUndo();if(this.pasteTextOnCtrlV==true){this.doOnPaste()}else{var edt=eval(this.oName);edt.bookmarkSelection();var pasteFrame=document.getElementById("idContentWord"+this.oName);var oDoc=pasteFrame.contentWindow.document;var oHTML=oDoc.open("text/html","replace");oHTML.close();oDoc.body.contentEditable=true;pasteFrame.contentWindow.focus();var oEditorWord=eval("idContentWord"+this.oName);var oSelWord=oEditorWord.document.selection.createRange();var sTypeWord=oEditorWord.document.selection.type;var oTarget=(sTypeWord=="None"?oEditorWord.document:sTypeWord);oTarget.execCommand("Paste",false);window.setTimeout(function(){edt.setFocus();edt.fixWord()},50)}this.runtimeBorder(false)}function doCmd(sCmd,sOption){if(!this.checkFocus()){return}if(sCmd=="Cut"||sCmd=="Copy"||sCmd=="Superscript"||sCmd=="Subscript"||sCmd=="Indent"||sCmd=="Outdent"||sCmd=="InsertHorizontalRule"||sCmd=="BlockDirLTR"||sCmd=="BlockDirRTL"){this.saveForUndo()}var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();var sType=oEditor.document.selection.type;var oTarget=(sType=="None"?oEditor.document:oSel);oTarget.execCommand(sCmd,false,sOption);realTime(this.oName)}function applyParagraph(val){this.hide();if(!this.checkFocus()){return}var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();this.hide();oSel.select();this.saveForUndo();this.doCmd("FormatBlock",val)}function applyBullets(){if(!this.checkFocus()){return}this.saveForUndo();this.doCmd("InsertUnOrderedList");this.tbar.btns["btnNumbering"+this.oName].setState(1);var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();var oElement=oSel.parentElement();while(oElement!=null&&oElement.tagName!="OL"&&oElement.tagName!="UL"){if(oElement.tagName=="BODY"){return}oElement=oElement.parentElement}oElement.removeAttribute("type",0);oElement.style.listStyleImage=""}function applyNumbering(){if(!this.checkFocus()){return}this.saveForUndo();this.doCmd("InsertOrderedList");this.tbar.btns["btnBullets"+this.oName].setState(1);var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();var oElement=oSel.parentElement();while(oElement!=null&&oElement.tagName!="OL"&&oElement.tagName!="UL"){if(oElement.tagName=="BODY"){return}oElement=oElement.parentElement}oElement.removeAttribute("type",0);oElement.style.listStyleImage=""}function applyJustifyLeft(){if(!this.checkFocus()){return}this.saveForUndo();this.doCmd("JustifyLeft")}function applyJustifyCenter(){if(!this.checkFocus()){return}this.saveForUndo();this.doCmd("JustifyCenter")}function applyJustifyRight(){if(!this.checkFocus()){return}this.saveForUndo();this.doCmd("JustifyRight")}function applyJustifyFull(){if(!this.checkFocus()){return}this.saveForUndo();this.doCmd("JustifyFull")}function applyBlockDirLTR(){if(!this.checkFocus()){return}this.doCmd("BlockDirLTR")}function applyBlockDirRTL(){if(!this.checkFocus()){return}this.doCmd("BlockDirRTL")}function doPasteText(){if(!this.checkFocus()){return}var oWord=eval("idContentWord"+this.oName);oWord.document.open("text/html","replace");oWord.document.write("<html><head></head><body></body></html>");oWord.document.close();oWord.document.body.contentEditable=true;var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();this.saveForUndo();var oWord=eval("idContentWord"+this.oName);oWord.focus();oWord.document.execCommand("SelectAll");oWord.document.execCommand("Paste");var sHTML=oWord.document.body.innerHTML;sHTML=sHTML.replace(/(<br>)/gi,"$1&lt;REPBR&gt;");sHTML=sHTML.replace(/(<\/tr>)/gi,"$1&lt;REPBR&gt;");sHTML=sHTML.replace(/(<\/div>)/gi,"$1&lt;REPBR&gt;");sHTML=sHTML.replace(/(<\/h1>)/gi,"$1&lt;REPBR&gt;");sHTML=sHTML.replace(/(<\/h2>)/gi,"$1&lt;REPBR&gt;");sHTML=sHTML.replace(/(<\/h3>)/gi,"$1&lt;REPBR&gt;");sHTML=sHTML.replace(/(<\/h4>)/gi,"$1&lt;REPBR&gt;");sHTML=sHTML.replace(/(<\/h5>)/gi,"$1&lt;REPBR&gt;");sHTML=sHTML.replace(/(<\/h6>)/gi,"$1&lt;REPBR&gt;");sHTML=sHTML.replace(/(<p>)/gi,"$1&lt;REPBR&gt;");sHTML=fixPathEncode(sHTML);oWord.document.body.innerHTML=sHTML;fixPathDecode(oWord);sHTML=oWord.document.body.innerText.replace(/<REPBR>/gi,"<br />");sHTML=sHTML.replace(/[\n\t\r]/gi,"");sHTML=sHTML.replace(/>\s*</gi,"><");oSel.pasteHTML(sHTML)}function insertCustomTag(a){this.hide();if(!this.checkFocus()){return}this.insertHTML(this.arrCustomTag[a][1]);this.hide();this.focus()}function insertHTML(sHTML){this.setFocus();if(!this.checkFocus()){return}var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();this.saveForUndo();var arrA=String(sHTML).match(/<A[^>]*>/ig);if(arrA){for(var i=0;i<arrA.length;i++){sTmp=arrA[i].replace(/href=/,"href_iwe=");sHTML=String(sHTML).replace(arrA[i],sTmp)}}var arrB=String(sHTML).match(/<IMG[^>]*>/ig);if(arrB){for(var i=0;i<arrB.length;i++){sTmp=arrB[i].replace(/src=/,"src_iwe=");sHTML=String(sHTML).replace(arrB[i],sTmp)}}if(oSel.parentElement){if(isIE9){var oSel=oEditor.getSelection();var range=oSel.getRangeAt(0);var frag=oEditor.document.createDocumentFragment(),div=oEditor.document.createElement("div");frag.appendChild(div);div.outerHTML=sHTML;range.insertNode(frag)}else{oSel.pasteHTML("<span id='iwe_delete'>toberemoved</span>"+sHTML)}}else{oSel.item(0).outerHTML=sHTML}var toRemoved=oEditor.document.getElementById("iwe_delete");if(toRemoved){toRemoved.removeNode(true)}for(var i=0;i<oEditor.document.all.length;i++){var elm=oEditor.document.all[i];if(elm.nodeType==1){if(elm.getAttribute("href_iwe")){elm.href=elm.getAttribute("href_iwe");elm.removeAttribute("href_iwe",0)}if(elm.getAttribute("src_iwe")){elm.src=elm.getAttribute("src_iwe");elm.removeAttribute("src_iwe",0)}}}this.bookmarkSelection()}function insertLink(url,title,target,rel){this.setFocus();if(!this.checkFocus()){return}var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();this.saveForUndo();if(oSel.parentElement){if(oSel.text==""){var oSelTmp=oSel.duplicate();if(title!=""&&title!=undefined){oSel.text=title}else{oSel.text=url}oSel.setEndPoint("StartToStart",oSelTmp);oSel.select()}}oSel.execCommand("CreateLink",false,url);if(oSel.parentElement){oEl=GetElement(oSel.parentElement(),"A")}else{oEl=GetElement(oSel.item(0),"A")}if(oEl){if(target!=""&&target!=undefined){oEl.target=target}if(rel!=""&&rel!=undefined){oEl.setAttribute("rel",rel)}}this.bookmarkSelection()}function clearAll(){if(confirm(getTxt("Are you sure you wish to delete all contents?"))==true){var oEditor=eval("idContent"+this.oName);this.saveForUndo();oEditor.document.body.innerHTML=""}}function applySpan(){if(!this.checkFocus()){return}var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();var sType=oEditor.document.selection.type;if(sType=="Control"||sType=="None"){return}sHTML=oSel.htmlText;var oParent=oSel.parentElement();if(oParent){if(oParent.innerText==oSel.text){if(oParent.tagName=="SPAN"){idSpan=oParent;return idSpan}}}var arrA=String(sHTML).match(/<A[^>]*>/ig);if(arrA){for(var i=0;i<arrA.length;i++){sTmp=arrA[i].replace(/href=/,"href_iwe=");sHTML=String(sHTML).replace(arrA[i],sTmp)}}var arrB=String(sHTML).match(/<IMG[^>]*>/ig);if(arrB){for(var i=0;i<arrB.length;i++){sTmp=arrB[i].replace(/src=/,"src_iwe=");sHTML=String(sHTML).replace(arrB[i],sTmp)}}oSel.pasteHTML("<SPAN id='idSpan__abc'>"+sHTML+"</SPAN>");var idSpan=oEditor.document.all.idSpan__abc;var oSelRange=oEditor.document.body.createTextRange();oSelRange.moveToElementText(idSpan);oSel.setEndPoint("StartToStart",oSelRange);oSel.setEndPoint("EndToEnd",oSelRange);oSel.select();for(var i=0;i<oEditor.document.all.length;i++){if(oEditor.document.all[i].getAttribute("href_iwe")){oEditor.document.all[i].href=oEditor.document.all[i].getAttribute("href_iwe");oEditor.document.all[i].removeAttribute("href_iwe",0)}if(oEditor.document.all[i].getAttribute("src_iwe")){oEditor.document.all[i].src=oEditor.document.all[i].getAttribute("src_iwe");oEditor.document.all[i].removeAttribute("src_iwe",0)}}idSpan.removeAttribute("id",0);return idSpan}function makeAbsolute(){if(!this.checkFocus()){return}var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();this.saveForUndo();if(oSel.parentElement){var oElement=oSel.parentElement();oElement.style.position="absolute"}else{this.doCmd("AbsolutePosition")}}function expandSelection(){if(!this.checkFocus()){return}var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();if(oSel.text!=""){return}oSel.expand("word");oSel.select();if(oSel.text.substr(oSel.text.length*1-1,oSel.text.length)==" "){oSel.moveEnd("character",-1);oSel.select()}}function selectParagraph(){if(!this.checkFocus()){return}var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();if(oSel.parentElement){if(oSel.text==""){var oElement=oSel.parentElement();while(oElement!=null&&oElement.tagName!="H1"&&oElement.tagName!="H2"&&oElement.tagName!="H3"&&oElement.tagName!="H4"&&oElement.tagName!="H5"&&oElement.tagName!="H6"&&oElement.tagName!="PRE"&&oElement.tagName!="P"&&oElement.tagName!="DIV"){if(oElement.tagName=="BODY"){return}oElement=oElement.parentElement}var oSelRange=oEditor.document.body.createControlRange();try{oSelRange.add(oElement);oSelRange.select()}catch(e){var oSelRange=oEditor.document.body.createTextRange();try{oSelRange.moveToElementText(oElement);oSelRange.select()}catch(e){}}}}}function doOver_TabCreate(){var k=event.srcElement;var h=k.parentElement.parentElement.parentElement;var c=k.parentElement.rowIndex;var g=k.cellIndex;var l=h.rows;l[l.length-1].childNodes[0].innerHTML="<div>"+(c*1+1)+" x "+(g*1+1)+" "+getTxt("Table Dimension Text")+"</div>";for(var e=0;e<l.length-1;e++){var a=l[e];for(var d=0;d<a.childNodes.length;d++){var b=a.childNodes[d];if(e<=c&&d<=g){b.style.backgroundColor="#316ac5"}else{b.style.backgroundColor="#ffffff"}}}event.cancelBubble=true}function doOut_TabCreate(){var b=event.srcElement;if(b.tagName!="TABLE"){return}var g=b.rows;for(var d=0;d<g.length-1;d++){var a=g[d];for(var c=0;c<a.childNodes.length;c++){var e=a.childNodes[c];e.style.backgroundColor="#ffffff"}}event.cancelBubble=true}function doRefresh_TabCreate(){if(!this.btnTable){return}var oTable=eval("dropTableCreate"+this.oName);var rows=oTable.rows;for(var i=0;i<rows.length-1;i++){var oRow=rows[i];for(var j=0;j<oRow.childNodes.length;j++){var oCol=oRow.childNodes[j];oCol.style.backgroundColor="#ffffff"}}}function doClick_TabCreate(){this.hide();if(!this.checkFocus()){return}var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();var oTD=event.srcElement;var nRow=oTD.parentElement.rowIndex+1;var nCol=oTD.cellIndex+1;this.saveForUndo();var sHTML="<table style='border-collapse:collapse;width:100%;'>";for(var i=1;i<=nRow;i++){sHTML+="<tr>";for(var j=1;j<=nCol;j++){sHTML+="<td></td>"}sHTML+="</tr>"}sHTML+="</table>";if(oSel.parentElement){oSel.collapse();oSel.pasteHTML(sHTML)}else{oSel.item(0).outerHTML=sHTML}realTime(this.oName);this.runtimeBorder(false);this.runtimeStyles()}function doKeyPress(evt,oName){var edt=eval(oName);if(!edt.arrUndoList[0]){edt.saveForUndo()}if(evt.ctrlKey){if(evt.keyCode==86){edt.bookmarkSelection();if(edt.pasteTextOnCtrlV==true){}else{var pasteFrame=document.getElementById("idContentWord"+oName);var oDoc=pasteFrame.contentWindow.document;var oHTML=oDoc.open("text/html","replace");oHTML.close();oDoc.body.contentEditable=true;pasteFrame.contentWindow.focus();window.setTimeout(function(){edt.setFocus();edt.fixWord()},50)}}if(evt.keyCode==89){if(!evt.altKey){edt.doRedo()}}if(evt.keyCode==90){if(!evt.altKey){edt.doUndo()}}if(evt.keyCode==65){if(!evt.altKey){edt.doCmd("SelectAll")}}if(evt.keyCode==66||evt.keyCode==73||evt.keyCode==85){if(!evt.altKey){edt.saveForUndo()}}}if(evt.keyCode==37||evt.keyCode==38||evt.keyCode==39||evt.keyCode==40){edt.saveForUndo()}if(evt.keyCode==13){if(edt.returnKeyMode==1){var oSel=document.selection.createRange();if(oSel.parentElement){edt.saveForUndo();if(GetElement(oSel.parentElement(),"LI")){}else{if(GetElement(oSel.parentElement(),"FORM")){var oSel=document.selection.createRange();oSel.pasteHTML("<br>");evt.cancelBubble=true;evt.returnValue=false;oSel.select();oSel.moveEnd("character",1);oSel.moveStart("character",1);oSel.collapse(false);return false}else{var oEl=GetElement(oSel.parentElement(),"H1");if(!oEl){oEl=GetElement(oSel.parentElement(),"H2")}if(!oEl){oEl=GetElement(oSel.parentElement(),"H3")}if(!oEl){oEl=GetElement(oSel.parentElement(),"H4")}if(!oEl){oEl=GetElement(oSel.parentElement(),"H5")}if(!oEl){oEl=GetElement(oSel.parentElement(),"H6")}if(!oEl){oEl=GetElement(oSel.parentElement(),"PRE")}if(!oEl){edt.doCmd("FormatBlock","<div>")}return true}}}}else{if(edt.returnKeyMode==2){var oSel=document.selection.createRange();if(oSel.parentElement){if(GetElement(oSel.parentElement(),"LI")){}else{oSel.pasteHTML("<br>");evt.cancelBubble=true;evt.returnValue=false;oSel.select();oSel.moveEnd("character",1);oSel.moveStart("character",1);oSel.collapse(false);return false}}}}edt.saveForUndo()}edt.onKeyPress()}function fullScreen(){this.hide();var oEditor=eval("idContent"+this.oName);if(this.stateFullScreen){this.onNormalScreen();this.stateFullScreen=false;document.body.style.overflow="";var idArea=eval("idArea"+this.oName);idArea.style.position="";idArea.style.top=0;idArea.style.left=0;var w=new String(this.width);if(w.indexOf("%")==-1){w=parseInt(w,10)+"px"}idArea.style.width=w;var h=new String(this.height);if(h.indexOf("%")==-1){h=parseInt(h,10)+"px"}idArea.style.height=this.height;var ifrm=document.getElementById("idFixZIndex"+this.oName);ifrm.style.top=0;ifrm.style.left=0;ifrm.style.width=0;ifrm.style.height=0;ifrm.style.display="none";oEditor.document.body.style.lineHeight="1.2";window.setTimeout("eval('idContent"+this.oName+"').document.body.style.lineHeight='';",0);for(var i=0;i<oUtil.arrEditor.length;i++){if(oUtil.arrEditor[i]!=this.oName){eval("idArea"+oUtil.arrEditor[i]).style.display="block"}}}else{this.onFullScreen();this.stateFullScreen=true;scroll(0,0);var idArea=eval("idArea"+this.oName);idArea.style.position="absolute";idArea.style.top=0;idArea.style.left=0;idArea.style.zIndex=2000;var tbPc=document.getElementById("idToolbar"+this.oName);nToolbarHeight=tbPc.offsetHeight;if(this.useTagSelector){nToolbarHeight+=13}if(this.showResizeBar){nToolbarHeight+=8}var w=0,h=0;if(isIE9){w=window.innerWidth;h=window.innerHeight;h=h-nToolbarHeight}else{if(document.compatMode&&document.compatMode!="BackCompat"){var html=document.documentElement;try{w=(document.body.offsetWidth);document.body.style.height="100%";h=html.clientHeight-nToolbarHeight;document.body.style.height=""}catch(e){w=(document.body.offsetWidth+20);document.body.style.height="100%";h=html.clientHeight-nToolbarHeight;document.body.style.height=""}}else{if(document.body.style.overflow=="hidden"){w=document.body.offsetWidth}else{w=document.body.offsetWidth-22}h=document.body.offsetHeight-4}}idArea.style.width=w+"px";idArea.style.height=h+"px";var ifrm=document.getElementById("idFixZIndex"+this.oName);ifrm.style.top=0;ifrm.style.left=0;ifrm.style.width=w;ifrm.style.height=h;ifrm.style.display="";ifrm.style.zIndex=1900;for(var i=0;i<oUtil.arrEditor.length;i++){if(oUtil.arrEditor[i]!=this.oName){eval("idArea"+oUtil.arrEditor[i]).style.display="none"}}oEditor.document.body.style.lineHeight="1.2";window.setTimeout("eval('idContent"+this.oName+"').document.body.style.lineHeight='';",0);oEditor.focus()}var idStyles=document.getElementById("idStyles"+this.oName);idStyles.innerHTML=""}function hide(){hideAllDD();this.oColor1.hide();this.oColor2.hide();if(this.btnTable){this.doRefresh_TabCreate()}}function convertBorderWidth(width){return eval(width.substr(0,width.length-2))}function modelessDialogShow(b,d,a,e,c){modalDialog(b,d,a)}function modalDialogShow(b,d,a,e,c){modalDialog(b,d,a)}function windowOpen(a,e,d,c,h,b){var k="ID"+(new Date()).getTime();var g=new ISWindow(k);g.iconPath=oUtil.scriptPath+"icons/";g.show({width:e+"px",height:d+"px",overlay:c,center:true,url:a,openerWin:h,options:b})}function lineBreak1(a){arrReturn=["\n","",""];if(a=="A"||a=="B"||a=="CITE"||a=="CODE"||a=="EM"||a=="FONT"||a=="I"||a=="SMALL"||a=="STRIKE"||a=="BIG"||a=="STRONG"||a=="SUB"||a=="SUP"||a=="U"||a=="SAMP"||a=="S"||a=="VAR"||a=="BASEFONT"||a=="KBD"||a=="TT"||a=="SPAN"||a=="IMG"){arrReturn=["","",""]}if(a=="TEXTAREA"||a=="TABLE"||a=="THEAD"||a=="TBODY"||a=="TR"||a=="OL"||a=="UL"||a=="DIR"||a=="MENU"||a=="FORM"||a=="SELECT"||a=="MAP"||a=="DL"||a=="HEAD"||a=="BODY"||a=="HTML"){arrReturn=["\n","","\n"]}if(a=="STYLE"||a=="SCRIPT"){arrReturn=["\n","",""]}if(a=="BR"||a=="HR"){arrReturn=["","\n",""]}return arrReturn}function fixAttr(a){a=String(a).replace(/&/g,"&amp;");a=String(a).replace(/</g,"&lt;");a=String(a).replace(/"/g,"&quot;");return a}function fixVal(b){b=String(b).replace(/&/g,"&amp;");b=String(b).replace(/</g,"&lt;");var a=escape(b);a=unescape(a.replace(/\%A0/gi,"-*REPL*-"));b=a.replace(/-\*REPL\*-/gi,"&nbsp;");return b}function recur(h,b){var e="";for(var g=0;g<h.childNodes.length;g++){var q=h.childNodes[g];if(q.parentNode!=h){continue}if(q.nodeType==1){var a=q.nodeName;var t=q.outerHTML;if(t.indexOf("<?xml:namespace")>-1){t=t.substr(t.indexOf(">")+1)}t=t.substring(1,t.indexOf(">"));if(t.indexOf(" ")>-1){t=t.substring(0,t.indexOf(" "))}var o=false;if(a.substring(0,1)=="/"){o=true}else{var d=b;e+=lineBreak1(a)[0];if(lineBreak1(a)[0]!=""){e+=d}}if(o){}else{if(a=="OBJECT"||a=="EMBED"){s=getOuterHTML(q);s=s.replace(/\"[^\"]*\"/ig,function(u){u=u.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/\s+/ig,"#_#").replace(/&amp;amp;/gi,"&amp;");return u});s=s.replace(/<([^ >]*)/ig,function(u){return u.toLowerCase()});s=s.replace(/ ([^=]+)=([^"' >]+)/ig,' $1="$2"');s=s.replace(/ ([^=]+)=/ig,function(u){return u.toLowerCase()});s=s.replace(/#_#/ig," ");if(a=="EMBED"){if(q.innerHTML==""){s=s.replace(/>$/ig," />").replace(/\/ \/>$/ig,"/>")}}s=s.replace(/<param name=\"Play\" value=\"0\" \/>/,'<param name="Play" value="-1" />');e+=s}else{if(a=="TITLE"){e+="<title>"+q.innerHTML+"</title>"}else{if(a=="AREA"){var c=q.coords;var m=q.shape}if(a=="BODY"){var p=q.outerHTML;if(isIE9){p=getOuterHTML(q)}s=p.substring(0,p.indexOf(">")+1)}else{var n=q.cloneNode();if(q.checked){n.checked=q.checked}if(q.selected){n.selected=q.selected}s=n.outerHTML.replace(/<\/[^>]*>/,"");if(isIE9){s=getOuterHTML(n).replace(/<\/[^>]*>/,"")}}if(a=="STYLE"){var l=s.match(/<[^>]*>/ig);s=l[0]}s=s.replace(/\"[^\"]*\"/ig,function(u){u=u.replace(/&/g,"&amp;").replace(/&amp;amp;/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\s+/ig,"#_#");return u});s=s.replace(/<([^ >]*)/ig,function(u){return u.toLowerCase()});s=s.replace(/ ([^=]+)=([^" >]+)/ig,' $1="$2"');s=s.replace(/ ([^=]+)=/ig,function(u){return u.toLowerCase()});s=s.replace(/#_#/ig," ");s=s.replace(/(<hr[^>]*)(noshade=""|noshade )/ig,'$1noshade="noshade" ');s=s.replace(/(<input[^>]*)(checked=""|checked )/ig,'$1checked="checked" ');s=s.replace(/(<select[^>]*)(multiple=""|multiple )/ig,'$1multiple="multiple" ');s=s.replace(/(<option[^>]*)(selected=""|selected )/ig,'$1selected="true" ');s=s.replace(/(<input[^>]*)(readonly=""|readonly )/ig,'$1readonly="readonly" ');s=s.replace(/(<input[^>]*)(disabled=""|disabled )/ig,'$1disabled="disabled" ');s=s.replace(/(<td[^>]*)(nowrap=""|nowrap )/ig,'$1nowrap="nowrap" ');s=s.replace(/(<td[^>]*)(nowrap=""\>|nowrap\>)/ig,'$1nowrap="nowrap">');if(a=="AREA"){s=s.replace(/ coords=\"0,0,0,0\"/ig,' coords="'+c+'"');s=s.replace(/ shape=\"RECT\"/ig,' shape="'+m+'"')}var r=true;if(a=="IMG"||a=="BR"||a=="AREA"||a=="HR"||a=="INPUT"||a=="BASE"||a=="LINK"){s=s.replace(/>$/ig," />").replace(/\/ \/>$/ig,"/>");r=false}e+=s;if(a!="TEXTAREA"){e+=lineBreak1(a)[1]}if(a!="TEXTAREA"){if(lineBreak1(a)[1]!=""){e+=d}}if(r){s=q.outerHTML;if(a=="SCRIPT"){s=s.replace(/<script([^>]*)>[\n+\s+\t+]*/ig,"<script$1>");s=s.replace(/[\n+\s+\t+]*<\/script>/ig,"<\/script>");s=s.replace(/<script([^>]*)>\/\/<!\[CDATA\[/ig,"");s=s.replace(/\/\/\]\]><\/script>/ig,"");s=s.replace(/<script([^>]*)>/ig,"");s=s.replace(/<\/script>/ig,"");s=s.replace(/^\s+/,"").replace(/\s+$/,"");e+="\n"+d+"//<![CDATA[\n"+d+s+"\n"+d+"//]]>\n"+d}if(a=="STYLE"){s=s.replace(/<style([^>]*)>[\n+\s+\t+]*/ig,"<style$1>");s=s.replace(/[\n+\s+\t+]*<\/style>/ig,"</style>");s=s.replace(/<style([^>]*)><!--/ig,"");s=s.replace(/--><\/style>/ig,"");s=s.replace(/<style([^>]*)>/ig,"");s=s.replace(/<\/style>/ig,"");s=s.replace(/^\s+/,"").replace(/\s+$/,"");e+="\n"+d+"<!--\n"+d+s+"\n"+d+"-->\n"+d}if(a=="DIV"||a=="P"){if(q.innerHTML==""||q.innerHTML=="&nbsp;"){e+="&nbsp;"}else{e+=recur(q,d+"\t")}}else{if(a=="STYLE"||a=="SCRIPT"){}else{e+=recur(q,d+"\t")}}if(a!="TEXTAREA"){e+=lineBreak1(a)[2]}if(a!="TEXTAREA"){if(lineBreak1(a)[2]!=""){e+=d}}if(t.indexOf(":")>=0){e+="</"+t.toLowerCase()+">"}else{e+="</"+a.toLowerCase()+">"}}}}}}else{if(q.nodeType==3){e+=fixVal(q.nodeValue).replace(/^[\t\r\n\v\f]*/,"").replace(/[\t\r\n\v\f]*$/,"")}else{if(q.nodeType==8){var k=q.nodeValue;k=k.replace(/^\s+/,"").replace(/\s+$/,"");var d="";e+="\n"+d+"<!--\n"+d+k+"\n"+d+"-->\n"+d}else{}}}}return e}function fixPathEncode(b){var e=String(b).match(/<A[^>]*>/g);if(e){for(var a=0;a<e.length;a++){sTmp=e[a].replace(/href=/,"href_iwe=");b=String(b).replace(e[a],sTmp)}}var d=String(b).match(/<IMG[^>]*>/g);if(d){for(var a=0;a<d.length;a++){sTmp=d[a].replace(/src=/,"src_iwe=");b=String(b).replace(d[a],sTmp)}}var c=String(b).match(/<AREA[^>]*>/ig);if(c){for(var a=0;a<c.length;a++){sTmp=c[a].replace(/href=/,"href_iwe=");b=String(b).replace(c[a],sTmp)}}return b}function fixPathDecode(b){for(var a=0;a<b.document.all.length;a++){if(b.document.all[a].getAttribute("href_iwe")){b.document.all[a].href=b.document.all[a].getAttribute("href_iwe");b.document.all[a].removeAttribute("href_iwe",0)}if(b.document.all[a].getAttribute("src_iwe")){b.document.all[a].src=b.document.all[a].getAttribute("src_iwe");b.document.all[a].removeAttribute("src_iwe",0)}}}function tbAction(tb,id,edt,sfx){var e=edt,oN=sfx,btn=id.substring(0,id.lastIndexOf(oN));switch(btn){case"btnFullScreen":e.fullScreen();break;case"btnPrint":e.focus();edt.doCmd("Print");break;case"btnSpellCheck":e.hide();if(e.spellCheckMode=="ieSpell"){modelessDialogShow(e.scriptPath+"spellcheck.htm",500,222)}else{if(e.spellCheckMode=="NetSpell"){checkSpellingById("idContent"+edt.oName)}}break;case"btnCut":e.doCmd("Cut");break;case"btnCopy":e.doCmd("Copy");break;case"btnUndo":e.doUndo();break;case"btnRedo":e.doRedo();break;case"btnBold":e.applyBold();break;case"btnItalic":e.applyItalic();break;case"btnUnderline":e.applyLine("underline");break;case"btnStrikethrough":e.applyLine("line-through");break;case"btnSuperscript":e.doCmd("Superscript");break;case"btnSubscript":e.doCmd("Subscript");break;case"btnJustifyLeft":e.applyJustifyLeft();break;case"btnJustifyCenter":e.applyJustifyCenter();break;case"btnJustifyRight":e.applyJustifyRight();break;case"btnJustifyFull":e.applyJustifyFull();break;case"btnNumbering":e.applyNumbering();break;case"btnBullets":e.applyBullets();break;case"btnIndent":e.doCmd("Indent");break;case"btnOutdent":e.doCmd("Outdent");break;case"btnLTR":e.applyBlockDirLTR();break;case"btnRTL":e.applyBlockDirRTL();break;case"btnFontDialog":e.hide();modelessDialogShow(e.dialogPath+"webfonts.htm",500,470);break;case"btnTextDialog":e.hide();modelessDialogShow(e.dialogPath+"webtext.htm",375,475);break;case"btnCompleteTextDialog":e.hide();modelessDialogShow(e.dialogPath+"webtextcomplete.htm",815,470);break;case"btnLinkDialog":e.hide();if(e.fileBrowser==""&&e.enableCssButtons==false){modelessDialogShow(e.dialogPath+"weblink.htm",755,545)}else{modelessDialogShow(e.dialogPath+"weblink.htm",755,545)}break;case"btnImageDialog":e.hide();modelessDialogShow(e.dialogPath+"webimage.htm",755,545);break;case"btnYoutubeDialog":e.hide();modelessDialogShow(e.dialogPath+"webyoutube.htm",421,545);break;case"btnTableDialog":e.hide();modelessDialogShow(e.dialogPath+"webtable.htm",785,500);break;case"btnFlashDialog":e.hide();modelessDialogShow(e.dialogPath+"webflash.htm",390,195);break;case"btnCharsDialog":e.hide();modelessDialogShow(e.dialogPath+"webchars.htm",700,122);break;case"btnSearchDialog":e.hide();modelessDialogShow(e.dialogPath+"websearch.htm",370,140);break;case"btnSourceDialog":e.hide();changeActiveEditor(e.oName);modelessDialogShow(e.dialogPath+"websource.htm",800,450);break;case"btnContentBlock":e.hide();eval(e.cmdContentBlock);break;case"btnInternalLink":e.hide();eval(e.cmdInternalLink);break;case"btnInternalImage":e.hide();eval(e.cmdInternalImage);break;case"btnCustomObject":e.hide();eval(e.cmdCustomObject);break;case"btnGuidelines":e.runtimeBorder(true);break;case"btnAbsolute":e.makeAbsolute();break;case"btnLine":e.doCmd("InsertHorizontalRule");break;case"btnRemoveFormat":e.doClean();break;case"btnClearAll":e.clearAll();break;case"btnStyles":e.hide();e.openStyleSelect();break;case"btnParagraph":e.hide();e.selectParagraph();break;case"btnFontName":e.hide();e.expandSelection();realtimeFontSelect(e.oName);break;case"btnFontSize":e.hide();e.expandSelection();realtimeSizeSelect(e.oName);break;case"btnCustomTag":e.hide();break;case"btnQuote":e.applyQuote();break;default:for(var i=0;i<e.arrCustomButtons.length;i++){if(e.arrCustomButtons[i][0]==btn){eval(e.arrCustomButtons[i][1]);break}}}}function ddAction(c,l,k,h){var b=h;var g=k;var d=l.substring(0,l.lastIndexOf(b));switch(d){case"btnPasteClip":g.doPaste();break;case"btnPasteWord":if(!g.customDialogShow("PasteWord")){modelessDialogShow(g.scriptPath+"paste_word.htm",400,280)}break;case"btnPasteText":g.doPasteText();break}var a=0;if(d.indexOf("btnParagraphFormatting")!=-1){}else{if(d.indexOf("btnParagraph")!=-1){a=d.substr(d.indexOf("_")+1);g.applyParagraph("<"+g.arrParagraph[parseInt(a)][1]+">")}else{if(d.indexOf("btnFontName")!=-1){a=d.substr(d.indexOf("_")+1);g.applyFontName(g.arrFontName[parseInt(a)])}else{if(d.indexOf("btnFontSize")!=-1){a=d.substr(d.indexOf("_")+1);g.applyFontSize(g.arrFontSize[parseInt(a)][1])}else{if(d.indexOf("btnCustomTag")!=-1){a=d.substr(d.indexOf("_")+1);g.insertCustomTag(parseInt(a))}}}}}}function changeHeight(b){var d=String(this.height);var c=document.getElementById("idArea"+this.oName);if(d.indexOf("%")>-1){d=c.childNodes[0].offsetHeight-c.rows[0].cells[0].childNodes[0].offsetHeight-(this.useTagSelector?20:0)}if(!this.minHeight){this.minHeight=parseInt(d,10)}var a=parseInt(d,10)+b;this.height=a+"px";c.style.height=this.height}function _isWordContent(a){return(/msonormal/i.test(a)||/<\\?\?xml[^>]*>/gi.test(a)||/<\/?o:p[^>]*>/gi.test(a)||/<\/?u1:p[^>]*>/gi.test(a)||/<\/?v:[^>]*>/gi.test(a)||/<\/?o:[^>]*>/gi.test(a)||/<\/?st1:[^>]*>/gi.test(a)||/<\/?w:wrap[^>]*>/gi.test(a)||/<\/?w:anchorlock[^>]*>/gi.test(a))}function fixWord(){var c=document.getElementById("idContentWord"+this.oName);var d=c.contentWindow;var g=_isWordContent(d.document.body.innerHTML);if(!g){this.insertHTML(d.document.body.innerHTML);return}for(var a=0;a<d.document.body.all.length;a++){d.document.body.all[a].removeAttribute("class","",0);d.document.body.all[a].removeAttribute("className","",0);d.document.body.all[a].removeAttribute("style","",0)}var e=d.document.body.innerHTML;e=String(e).replace(/<\\?\?xml[^>]*>/gi,"");e=String(e).replace(/<\/?o:p[^>]*>/gi,"");e=String(e).replace(/<\/?u1:p[^>]*>/gi,"");e=String(e).replace(/<\/?v:[^>]*>/gi,"");e=String(e).replace(/<\/?o:[^>]*>/gi,"");e=String(e).replace(/<\/?st1:[^>]*>/gi,"");e=String(e).replace(/<\/?w:wrap[^>]*>/gi,"");e=String(e).replace(/<\/?w:anchorlock[^>]*>/gi,"");e=String(e).replace(/&nbsp;/gi,"");e=String(e).replace(/<\/?SPAN[^>]*>/gi,"");e=String(e).replace(/<\/?FONT[^>]*>/gi,"");e=String(e).replace(/<\/?STRONG[^>]*>/gi,"");e=String(e).replace(/<\/?H1[^>]*>/gi,"");e=String(e).replace(/<\/?H2[^>]*>/gi,"");e=String(e).replace(/<\/?H3[^>]*>/gi,"");e=String(e).replace(/<\/?H4[^>]*>/gi,"");e=String(e).replace(/<\/?H5[^>]*>/gi,"");e=String(e).replace(/<\/?H6[^>]*>/gi,"");e=String(e).replace(/<\/?P[^>]*><\/P>/gi,"");var b=new RegExp(String.fromCharCode(8217),"gi");e=String(e).replace(b,"'");e=String(e).replace(/  /gi," ");e=String(e).replace(/\n\n/gi,"\n");this.insertHTML(e)}function getOuterHTML(g){var e="";switch(g.nodeType){case 1:e="<"+g.nodeName;var h="",a="";for(var c=0;c<g.attributes.length;c++){if(g.attributes[c].nodeName.substr(0,4)=="_moz"){continue}if(g.attributes[c].nodeValue.substr(0,4)=="_moz"){continue}if(g.nodeName=="TEXTAREA"&&g.attributes[c].nodeName.toLowerCase()=="value"){h=g.attributes[c].nodeValue}else{if(g.attributes[c].nodeName.toLowerCase()=="althtml"){a=g.attributes[c].nodeValue.replace(/^\s+|\s+$/g,"");a=a.replace(/>$/ig," />").replace(/\/ \/>$/ig,"/>").replace(/\s*\/>/gi,"></embed>")}else{e+=" "+g.attributes[c].nodeName+'="'+g.attributes[c].nodeValue.replace(/"/gi,"'")+'"'}}}e+=">";if(a!=""){e+=a}if(g.nodeName=="TEXTAREA"){e+=h}else{if(g.nodeName=="OBJECT"){var d;for(var b=0;b<g.childNodes.length;b++){d=g.childNodes[b];if(d.nodeType==1){if(d.tagName=="PARAM"){e+='<param name="'+d.name+'" value="'+d.value.replace(/"/gi,"'")+'"/>\n'}else{if(d.tagName=="EMBED"){e+=getOuterHTML(d)}}}}}else{e+=g.innerHTML}}e+="</"+g.nodeName+">";break;case 8:e="<!--"+g.nodeValue+"-->";break;case 3:e=g.nodeValue;break}return e}function customDialogShow(s){for(var j=0;j<this.customDialog.length;j++){if(this.customDialog[j][0]==s){eval(this.customDialog[j][1]);return true}}return false}function GetEmoticons(){var d="";var c=[["smiley.png","smiley"],["smiley-lol.png","lol"],["smiley-confuse.png","confuse"],["smiley-cool.png","cool"],["smiley-cry.png","cry"],["smiley-wink.png","wink"],["smiley-surprise.png","surprise"],["smiley-sad.png","sad"],["smiley-red.png","red"],["smiley-neutral.png","neutral"],["smiley-kiss.png","kiss"],["smiley-mad.png","mad"],["smiley-money.png","money"],["smiley-sleep.png","sleep"],["smiley-yell.png","yell"],["smiley-roll.png","roll"],["smiley-grin.png","grin"],["smiley-razz.png","razz"],["smiley-sweat.png","sweat"],["smiley-eek.png","eek"],["smiley-zipper.png","zipper"],["heart.png","love"],["heart-break.png","heart break"],["light-bulb.png","idea"]];var a=this.scriptPath+this.iconPath;d+="<div style='width:193px;height:72px;margin:2px;'>";for(var b=0;b<c.length;b++){d+="<img unselectable='on' src='"+a+c[b][0]+"' onmouseover='this.style.border=\"#aaaaaa 1px solid\"' onmouseout='this.style.border=\"#ffffff 1px solid\"' style='float:left;margin:1px;cursor:pointer;border:#ffffff 1px solid;padding:2px;' onclick='"+this.oName+'.insertEmoticon("'+a+c[b][0]+'","'+c[b][1]+"\");' alt='"+c[b][1]+"' />"}d+="</div>";return d}function insertEmoticon(a,c){this.insertHTML("<img src='"+a+"' alt='"+c+"' />");var b=document.getElementById("ddEmoticons"+this.oName);b.style.display="none";this.isActive=false}function applyQuote(){var oEditor=eval("idContent"+this.oName);var oSel=oEditor.document.selection.createRange();var oQuote=(oSel.parentElement!=null?GetElement(oSel.parentElement(),"BLOCKQUOTE"):GetElement(oSel.item(0),"BLOCKQUOTE"));if(oQuote){var oQuote=(oSel.parentElement!=null?GetElement(oSel.parentElement(),"BLOCKQUOTE"):GetElement(oSel.item(0),"BLOCKQUOTE"));var oSelRange=oEditor.document.body.createTextRange();oSelRange.moveToElementText(oQuote);oSel.setEndPoint("StartToStart",oSelRange);oSel.setEndPoint("EndToEnd",oSelRange);oSel.select();this.saveForUndo();sHTML=oQuote.innerHTML;sHTML=fixPathEncode(sHTML);var oTmp=oQuote.parentElement;if(oTmp.innerHTML==oQuote.outerHTML){oTmp.innerHTML="<p>"+sHTML+"</p>";fixPathDecode(oEditor);var oSelRange=oEditor.document.body.createTextRange();oSelRange.moveToElementText(oTmp);oSel.setEndPoint("StartToStart",oSelRange);oSel.setEndPoint("EndToEnd",oSelRange);oSel.select();realTime(this.oName);this.selectElement(0);return}else{oQuote.outerHTML="";oSel.pasteHTML("<p>"+sHTML+"</p>");fixPathDecode(oEditor);this.focus();realTime(this.oName)}this.runtimeBorder(false);this.runtimeStyles()}else{this.applyParagraph("<pre>");var oPre=(oSel.parentElement!=null?GetElement(oSel.parentElement(),"PRE"):GetElement(oSel.item(0),"PRE"));var oSelRange=oEditor.document.body.createTextRange();oSelRange.moveToElementText(oPre);oSel.setEndPoint("StartToStart",oSelRange);oSel.setEndPoint("EndToEnd",oSelRange);oSel.select();this.saveForUndo();sHTML=oPre.innerHTML;sHTML=fixPathEncode(sHTML);var oTmp=oPre.parentElement;if(oTmp.innerHTML==oPre.outerHTML){oTmp.innerHTML="<blockquote>"+sHTML+"</blockquote>";fixPathDecode(oEditor);var oSelRange=oEditor.document.body.createTextRange();oSelRange.moveToElementText(oTmp);oSel.setEndPoint("StartToStart",oSelRange);oSel.setEndPoint("EndToEnd",oSelRange);oSel.select();realTime(this.oName);this.selectElement(0);return}else{oPre.outerHTML="";oSel.pasteHTML("<blockquote>"+sHTML+"</blockquote>");fixPathDecode(oEditor);this.focus();realTime(this.oName)}this.runtimeBorder(false);this.runtimeStyles()}};