var editor=new Array();var oUtil=new InnovaEditorUtil();function InnovaEditorUtil(){this.langDir="en-US";try{if(LanguageDirectory){this.langDir=LanguageDirectory}}catch(d){}var a=document.getElementsByTagName("script");for(var c=0;c<a.length;c++){var b=a[c].src.toLowerCase();if(b.indexOf("moz/editor.js")!=-1){this.scriptPath=a[c].src.replace(/editor.js/,"")}else{if(b.indexOf("scripts/innovaeditor.js")!=-1){if(!this.scriptPath){this.scriptPath=a[c].src.replace(/innovaeditor.js/,"")+"moz/"}}}}this.scriptPathLang=this.scriptPath.replace(/\/moz/,"")+"language/"+this.langDir+"/";if(this.langDir=="en-US"){document.write("<script src='"+this.scriptPathLang+"editor_lang.js'><\/script>")}this.oName;this.oEditor;this.obj;this.oSel;this.sType;this.bInside=bInside;this.useSelection=true;this.arrEditor=[];this.onSelectionChanged=function(){return true};this.activeElement;this.activeModalWin;this.setEdit=setEdit;this.bOnLoadReplaced=false;this.Table;this.protocol=window.location.protocol;this.spcCharCode=[[169,"&copy;"],[163,"&pound;"],[174,"&reg;"],[233,"&eacute;"],[201,"&Eacute;"],[8364,"&euro;"],[8220,'"']];this.spcChar=[];this.loadSpecialCharCode=function(e){if(e!=null){this.spcCharCode=e;this.spcChar=[]}for(var g=0;g<this.spcCharCode.length;g++){this.spcChar[g]=[new RegExp(String.fromCharCode(this.spcCharCode[g][0]),"g"),this.spcCharCode[g][1]]}};for(var c=0;c<this.spcCharCode.length;c++){this.spcChar[c]=[new RegExp(String.fromCharCode(this.spcCharCode[c][0]),"g"),this.spcCharCode[c][1]]}this.replaceSpecialChar=function(g){for(var e=0;e<this.spcChar.length;e++){g=g.replace(this.spcChar[e][0],this.spcChar[e][1])}return g};this.initializeEditor=function(h,e){var m=[],l,g;if(typeof(h)=="object"&&h.tagName&&h.tagName=="TEXTAREA"){m[0]=h}else{if(h.substr(0,1)=="#"){l=document.getElementById(h.substr(1));if(!l){return}m[0]=l}else{var o=document.getElementsByTagName("TEXTAREA");for(var k=0;k<o.length;k++){if(o[k].className==h){m[m.length]=o[k]}}}}for(var k=0;k<m.length;k++){l=m[k];if(l.id||l.id==""){l.id="editorarea"+k}g=document.createElement("DIV");g.id="innovaeditor"+k;l.parentNode.insertBefore(g,l);window["oEdit"+k]=new InnovaEditor("oEdit"+k);var n;if(window.getComputedStyle){n=window.getComputedStyle(l,null)}else{if(l.currentStyle){n=l.currentStyle}else{n={width:window["oEdit"+k].width,height:window["oEdit"+k].height}}}window["oEdit"+k].width=n.width;window["oEdit"+k].height=n.height;if(e){for(var j in e){window["oEdit"+k][j]=e[j]}}window["oEdit"+k].REPLACE(l.id,"innovaeditor"+k)}}}function bInside(a){while(a!=null){if(a.designMode&&a.designMode=="on"){return true}a=a.parentNode}return false}function checkFocus(){var c=document.getElementById("idContent"+this.oName).contentWindow;var a=c.getSelection();var b=getSelectedElement(a);if(b!=null){if(!bInside(b)){return false}}else{if(!bInside(b)){return false}}return true}function iwe_focus(d){var g=document.getElementById("idContent"+this.oName);if(g){g=g.contentWindow;g.focus()}if(d&&g){var c;var b=g.document.createRange();if(g.document.body.childNodes.length>0){var h=null;if(d=="start"){h=g.document.body.childNodes[0];b.selectNode(h);b.collapse(true)}else{h=g.document.body.childNodes[g.document.body.childNodes.length-1];b.selectNode(h);if(h.nodeType==1&&h.tagName=="BR"){b.collapse(true)}else{b.collapse(false)}}}else{b.selectNodeContents(g.document.body);b.collapse(false)}var e=g.getSelection();e.removeAllRanges();e.addRange(b);var a=g.document.createEvent("KeyboardEvent");a.initKeyEvent("keypress",true,true,null,false,false,false,false,0,32);g.document.dispatchEvent(a);a=g.document.createEvent("KeyboardEvent");a.initKeyEvent("keypress",true,true,null,false,false,false,false,8,0);g.document.dispatchEvent(a)}}function setFocus(a){this.focus(a)}function setEdit(d){if((d!=null)&&(d!="")){try{var c=document.getElementById("idContent"+d);c.contentDocument.designMode="on";c.focus()}catch(g){}}else{for(var a=0;a<this.arrEditor.length;a++){try{var c=document.getElementById("idContent"+this.arrEditor[a]).contentWindow;c.document.designMode="on";var b=c.getSelection().getRangeAt(0);b.selectNode(c.document.getElementsByTagName("Body")[0]);b.collapse(true);c.focus()}catch(g){}}}}var iconHeight;function InnovaEditor(e){this.oName=e;this.init=initISEditor;this.RENDER=RENDER;this.onRender=function(){};this.loadHTML=loadHTML;this.loadHTMLFull=loadHTMLFull;this.getHTMLBody=getHTMLBody;this.getHTML=getHTML;this.getXHTMLBody=getXHTMLBody;this.getXHTML=getXHTML;this.getTextBody=getTextBody;this.putHTML=putHTML;this.css="";this.onKeyPress=function(){return true};this.styleSelectionHoverBg="#cccccc";this.styleSelectionHoverFg="white";this.styleSelectorPrefix="";this.cleanEmptySpan=cleanEmptySpan;this.cleanFonts=cleanFonts;this.cleanTags=cleanTags;this.replaceTags=replaceTags;this.cleanDeprecated=cleanDeprecated;this.doClean=doClean;this.applySpanStyle=applySpanStyle;this.bInside=bInside;this.checkFocus=checkFocus;this.focus=iwe_focus;this.setFocus=setFocus;this.disableFocusOnLoad=false;this.doCmd=doCmd;this.applyParagraph=applyParagraph;this.applyFontName=applyFontName;this.applyFontSize=applyFontSize;this.applyBullets=applyBullets;this.applyNumbering=applyNumbering;this.applyJustifyLeft=applyJustifyLeft;this.applyJustifyCenter=applyJustifyCenter;this.applyJustifyRight=applyJustifyRight;this.applyJustifyFull=applyJustifyFull;this.applyBlockDirLTR=applyBlockDirLTR;this.applyBlockDirRTL=applyBlockDirRTL;this.applySpan=applySpan;this.makeAbsolute=makeAbsolute;this.insertHTML=insertHTML;this.clearAll=clearAll;this.insertCustomTag=insertCustomTag;this.selectParagraph=selectParagraph;this.hide=hide;this.width="700px";this.height="350px";this.publishingPath="";var a=document.getElementsByTagName("script");for(var c=0;c<a.length;c++){var b=a[c].src.toLowerCase();if(b.indexOf("moz/editor.js")!=-1){this.scriptPath=a[c].src.replace(/editor.js/,"");break}else{if(b.indexOf("innovaeditor.js")!=-1){this.scriptPath=a[c].src.replace(/innovaeditor.js/,"moz/");break}}}this.dialogPath=this.scriptPath.substring(0,this.scriptPath.indexOf("moz/"))+"common/";this.GetEmoticons=GetEmoticons;this.insertEmoticon=insertEmoticon;this.applyQuote=applyQuote;this.iconPath="icons/";this.iconWidth=29;this.iconHeight=25;this.dropTopAdjustment_moz=0;this.dropLeftAdjustment_moz=0;this.heightAdjustment=0;this.applyColor=applyColor;this.oColor1=new ColorPicker("oColor1",this.oName);this.oColor2=new ColorPicker("oColor2",this.oName);this.expandSelection=expandSelection;this.useLastForeColor=false;this.useLastBackColor=false;this.stateForeColor="";this.stateBackColor="";this.fullScreen=doFullScreen;this.stateFullScreen=false;this.getElm=iwe_getElm;this.features=[];this.btnParagraph=false;this.btnFontName=false;this.btnFontSize=false;this.btnCut=false;this.btnCopy=false;this.btnPaste=false;this.btnPasteText=false;this.btnUndo=false;this.btnRedo=false;this.btnBold=false;this.btnItalic=false;this.btnUnderline=false;this.btnStrikethrough=false;this.btnSuperscript=false;this.btnSubscript=false;this.btnJustifyLeft=false;this.btnJustifyCenter=false;this.btnJustifyRight=false;this.btnJustifyFull=false;this.btnNumbering=false;this.btnBullets=false;this.btnIndent=false;this.btnOutdent=false;this.btnLTR=false;this.btnRTL=false;this.btnForeColor=false;this.btnBackColor=false;this.btnTable=false;this.btnLine=false;this.tabs=[["tabHome","Home",["group1","group2","group4"]],["tabStyle","Insert",["group3"]]];this.groups=[["group1","",["Bold","Italic","Underline","FontDialog","ForeColor","TextDialog","RemoveFormat"]],["group2","",["Bullets","Numbering","JustifyLeft","JustifyCenter","JustifyRight"]],["group3","",["LinkDialog","ImageDialog","YoutubeDialog","Table","TableDialog","Emoticons","Quote"]],["group4","",["Undo","Redo","FullScreen","SourceDialog"]]];this.toolbarMode=2;this.showResizeBar=true;this.pasteTextOnCtrlV=false;this.fileBrowser="";this.enableFlickr=true;this.enableCssButtons=true;this.enableLightbox=true;this.enableTableAutoformat=true;this.flickrUser="ysw.insite";this.cmdAssetManager="";this.cmdFileManager="";this.cmdImageManager="";this.cmdMediaManager="";this.cmdFlashManager="";this.btnContentBlock=false;this.cmdContentBlock=";";this.btnInternalLink=false;this.cmdInternalLink=";";this.insertLink=insertLink;this.btnCustomObject=false;this.cmdCustomObject=";";this.btnInternalImage=false;this.cmdInternalImage=";";this.arrStyle=[];this.isCssLoaded=false;this.openStyleSelect=openStyleSelect;this.arrParagraph=[[getTxt("Heading 1"),"H1"],[getTxt("Heading 2"),"H2"],[getTxt("Heading 3"),"H3"],[getTxt("Heading 4"),"H4"],[getTxt("Heading 5"),"H5"],[getTxt("Heading 6"),"H6"],[getTxt("Preformatted"),"PRE"],[getTxt("Normal (P)"),"P"],[getTxt("Normal (DIV)"),"DIV"]];this.arrFontName=["Impact, Charcoal, sans-serif","Palatino Linotype, Book Antiqua, Palatino, serif","Tahoma, Geneva, sans-serif","Century Gothic, sans-serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Times New Roman, Times, serif","Arial Narrow, sans-serif","Verdana, Geneva, sans-serif","Copperplate Gothic Light, sans-serif","Lucida Console, Monaco, monospace","Gill Sans MT, sans-serif","Trebuchet MS, Helvetica, sans-serif","Courier New, Courier, monospace","Arial, Helvetica, sans-serif","Georgia, Serif","Garamond, Serif"];this.arrFontSize=[[getTxt("Size 1"),"1"],[getTxt("Size 2"),"2"],[getTxt("Size 3"),"3"],[getTxt("Size 4"),"4"],[getTxt("Size 5"),"5"],[getTxt("Size 6"),"6"],[getTxt("Size 7"),"7"]];this.arrCustomTag=[];this.docType='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">';this.html="<html>";this.headContent="";this.preloadHTML="";this.originalContent="";this.isContentChanged=isContentChanged;this.onSave=function(){document.getElementById("iwe_btnSubmit"+this.oName).click()};this.useBR=false;this.useDIV=true;this.returnKeyMode=-1;this.onFullScreen=function(){return true};this.onNormalScreen=function(){return true};this.initialRefresh=false;this.doUndo=doUndo;this.doRedo=doRedo;this.saveForUndo=saveForUndo;this.doUndoRedo=doUndoRedo;this.arrUndoList=[];this.arrRedoList=[];this.useTagSelector=true;this.TagSelectorPosition="bottom";this.moveTagSelector=moveTagSelector;this.selectElement=selectElement;this.removeTag=removeTag;this.doClick_TabCreate=doClick_TabCreate;this.doRefresh_TabCreate=doRefresh_TabCreate;this.arrCustomButtons=[["CustomName1","alert(0)","caption here","btnSave.gif"],["CustomName2","alert(0)","caption here","btnSave.gif"]];this.customDialogShow=customDialogShow;this.customDialog=[];this.onSelectionChanged=function(){return true};this.spellCheckMode="ieSpell";this.encodeIO=false;this.changeHeight=changeHeight;this.fixWord=fixWord;this.REPLACE=REPLACE;this.mode="XHTMLBody";this.idTextArea;var d=this;this.tbar=new ISToolbarManager(this.oName);this.tbar.iconPath=this.scriptPath.substring(0,this.scriptPath.indexOf("moz/"))+this.iconPath;editor[editor.length]=this;return this}function changeActiveEditor(oName){var edtObj=eval(oName);var edtFrm=document.getElementById("idContent"+oName);oUtil.activeElement=null;oUtil.oName=oName;oUtil.oEditor=edtFrm.contentWindow;oUtil.obj=edtObj;edtObj.hide()}function saveForUndo(){var e=document.getElementById("idContent"+this.oName).contentWindow;var d=this;if(d.arrUndoList[0]){if(e.document.body.innerHTML==d.arrUndoList[0][0]){return}}for(var c=20;c>1;c--){d.arrUndoList[c-1]=d.arrUndoList[c-2]}d.focus();var a=e.getSelection();var b=a.getRangeAt(0);d.arrUndoList[0]=[e.document.body.innerHTML,b.cloneRange()];this.arrRedoList=[];if(this.btnUndo){this.tbar.btns["btnUndo"+this.oName].setState(1)}if(this.btnRedo){this.tbar.btns["btnRedo"+this.oName].setState(5)}}function doUndo(){this.doUndoRedo(this.arrUndoList,this.arrRedoList)}function doRedo(){this.doUndoRedo(this.arrRedoList,this.arrUndoList)}function doUndoRedo(e,d){var h=document.getElementById("idContent"+this.oName).contentWindow;var g=this;if(!e[0]){return}for(var c=20;c>1;c--){d[c-1]=d[c-2]}var a=h.getSelection();var b=a.getRangeAt(0);d[0]=[h.document.body.innerHTML,b.cloneRange()];sHTML=e[0][0];h.document.body.innerHTML=sHTML;a=h.getSelection();a.removeAllRanges();a.addRange(e[0][1]);for(var c=0;c<19;c++){e[c]=e[c+1]}e[19]=null;realTime(this)}var bOnSubmitOriginalSaved=false;function REPLACE(c,e){this.idTextArea=c;var a=document.getElementById(c);a.style.display="none";var d=a.form;if(d){if(!bOnSubmitOriginalSaved){if(d.onsubmit){onsubmit_original=d.onsubmit}bOnSubmitOriginalSaved=true}d.onsubmit=new Function("return onsubmit_new()")}var b=document.getElementById(c).value;b=b.replace(/&/g,"&amp;");b=b.replace(/</g,"&lt;");b=b.replace(/>/g,"&gt;");this.RENDER(b,e)}function isContentChanged(){var a="";if(this.mode=="HTMLBody"){a=this.getHTMLBody()}else{if(this.mode=="HTML"){a=this.getHTML()}else{if(this.mode=="XHTMLBody"){a=this.getXHTMLBody()}else{if(this.mode=="XHTML"){a=this.getXHTML()}}}}if(a!=this.originalContent){return true}return false}function onsubmit_new(){var sContent;for(var i=0;i<oUtil.arrEditor.length;i++){var oEdit=eval(oUtil.arrEditor[i]);if(oEdit.mode=="HTMLBody"){sContent=oEdit.getHTMLBody()}if(oEdit.mode=="HTML"){sContent=oEdit.getHTML()}if(oEdit.mode=="XHTMLBody"){sContent=oEdit.getXHTMLBody()}if(oEdit.mode=="XHTML"){sContent=oEdit.getXHTML()}document.getElementById(oEdit.idTextArea).value=sContent}if(onsubmit_original){return onsubmit_original()}}function onsubmit_original(){}function RENDER(sPreloadHTML,dvId){iconHeight=this.iconHeight;if(sPreloadHTML.substring(0,4)=="<!--"&&sPreloadHTML.substring(sPreloadHTML.length-3)=="-->"){sPreloadHTML=sPreloadHTML.substring(4,sPreloadHTML.length-3)}if(sPreloadHTML.substring(0,4)=="<!--"&&sPreloadHTML.substring(sPreloadHTML.length-6)=="--&gt;"){sPreloadHTML=sPreloadHTML.substring(4,sPreloadHTML.length-6)}sPreloadHTML=sPreloadHTML.replace(/&lt;/g,"<");sPreloadHTML=sPreloadHTML.replace(/&gt;/g,">");sPreloadHTML=sPreloadHTML.replace(/&amp;/g,"&");this.preloadHTML=sPreloadHTML;var sHTMLDropMenus="";var sHTMLIcons="";var sTmp="";this.oColor1.onShow=new Function(this.oName+".hide()");this.oColor1.onPickColor=new Function(this.oName+".applyColor('ForeColor', "+this.oName+".oColor1.color)");this.oColor1.onRemoveColor=new Function(this.oName+".applyColor('ForeColor','')");this.oColor2.onShow=new Function(this.oName+".hide()");this.oColor2.onPickColor=new Function(this.oName+".applyColor('hilitecolor', "+this.oName+".oColor2.color)");this.oColor2.onRemoveColor=new Function(this.oName+".applyColor('HiliteColor','')");var me=this;var tmp=null,tmpTb,grpMap=new Object();for(var i=0;i<this.groups.length;i++){tmp=this.groups[i];tmpTb=this.tbar.createToolbar(this.oName+"tbar"+tmp[0]);tmpTb.onClick=function(id){tbAction(tmpTb,id,me,me.oName)};tmpTb.style.toolbar="main_istoolbar";tmpTb.iconPath=this.scriptPath.substring(0,this.scriptPath.indexOf("moz/"))+this.iconPath;tmpTb.btnWidth=this.iconWidth;tmpTb.btnHeight=this.iconHeight;for(var j=0;j<tmp[2].length;j++){eval(this.oName+".btn"+tmp[2][j]+"=true")}buildToolbar(tmpTb,this,tmp[2]);grpMap[tmp[0]]=tmp[1]}if(this.toolbarMode==1){var eTab=this.tbar.createTbTab("tabCtl"+this.oName),tmpGrp;for(var i=0;i<this.tabs.length;i++){tmp=this.tabs[i];tmpGrp=this.tbar.createTbGroup(this.oName+"grp"+tmp[0]);for(var j=0;j<tmp[2].length;j++){tmpGrp.addGroup(this.oName+tmp[2][j],grpMap[tmp[2][j]],this.oName+"tbar"+tmp[2][j])}eTab.addTab(this.oName+tmp[0],tmp[1],tmpGrp)}}else{if(this.groups.length>0){var tmpGrp;tmpGrp=this.tbar.createTbGroup(this.oName+"grp");for(var i=0;i<this.groups.length;i++){tmp=this.groups[i];tmpGrp.addGroup(this.oName+tmp[0],grpMap[tmp[0]],this.oName+"tbar"+tmp[0])}if(this.toolbarMode==3){tmpGrp.groupFlow=true}if(this.toolbarMode==4){tmpGrp.groupFlow=true;tmpGrp.draggable=true}}}var sHTML="";var icPath=this.scriptPath.substring(0,this.scriptPath.indexOf("moz/"))+this.iconPath;if(!document.getElementById("id_refresh_z_index")){sHTML+="<div id=id_refresh_z_index style='margin:0px'></div>"}sHTML+="<table id=idArea"+this.oName+" name=idArea"+this.oName+" border='0px' cellpadding=0 cellspacing=0 width='"+this.width+"' height='"+this.height+"' style='width:"+this.width+";height:"+this.height+";border:none;border-bottom:#cfcfcf 1px solid;'><tr><td colspan=2 style=\"padding:0px;border:#cfcfcf 0px solid;background:url('"+icPath+"bg.gif')\"><table cellpadding=0 cellspacing=0 border=0 width='100%' style='border:none;margin:0px'><tr><td dir=ltr style='padding:0px;'>"+this.tbar.render()+"</td></tr></table></td></tr><tr id=idTagSelTopRow"+this.oName+"><td colspan=2 id=idTagSelTop"+this.oName+" height=0px style='color:#000000;padding:0px;'></td></tr>";sHTML+="<tr style='width:100%;height:100%'><td colspan=2 valign=top height=100% style='padding:0px;background:white;padding-right:0px;'>";sHTML+="<table id='cntContainer"+this.oName+"' cellpadding=0 cellspacing=0 width='100%' height='100%' style='margin-top:0px;border:none;'><tr style='width:100%;height:100%'><td width='100%' height='100%' style='padding:0px;border:solid 1px #cfcfcf;border-bottom:none'>";sHTML+="<iframe style='width:100%;height:100%;border:none;'  name=idContent"+this.oName+" id=idContent"+this.oName+" src='"+this.scriptPath+"blank.gif'></iframe>";sHTML+="<iframe style='position:absolute;left:-1000px;width:1px;height:1px;overflow:auto;'  name='idContentWord"+this.oName+"' id='idContentWord"+this.oName+"' src='"+this.scriptPath+"blank.gif'></iframe>";sHTML+="<iframe style='width:1px;height:1px;overflow:auto;border:0px' id=\"myStyle"+this.oName+'" name="myStyle'+this.oName+"\" src='"+this.scriptPath+"blank.gif'></iframe>";sHTML+="</td><td id=idStyles"+this.oName+" style='padding:0px;background:#f4f4f4'></td></tr></table>";sHTML+="</td></tr>";sHTML+="<tr id=idTagSelBottomRow"+this.oName+"><td colspan=2 id=idTagSelBottom"+this.oName+" style='color:#000000;padding:0px;'></td></tr>";if(this.showResizeBar){sHTML+="<tr id=idResizeBar"+this.oName+"><td colspan=2 style='padding:0px;'><div style='cursor:n-resize;' class='resize_bar' onmousedown=\"onEditorStartResize(event, this, '"+this.oName+"')\" ></div></td></tr>"}sHTML+="</table>";sHTML+=sHTMLDropMenus;sHTML+="<input type=submit name=iwe_btnSubmit"+this.oName+" id=iwe_btnSubmit"+this.oName+" value=SUBMIT style='display:none' >";if(dvId){var edtStr=[];edtStr[0]=sHTML;document.getElementById(dvId).innerHTML=edtStr.join("")}else{document.write(sHTML)}var me=this;setTimeout(function(){me.init()},10)}function onEditorStartResize(ev,elm,oName){document.onmousemove=onEditorResize;document.onmouseup=onEditorStopResize;document.onselectstart=function(){return false};document.ondragstart=function(){return false};document.body.style.cursor="n-resize";oUtil.currentResized=eval(oName);oUtil.resizeInit={x:ev.screenX,y:ev.screenY};if(!oUtil.isWindow){oUtil.isWindow=new ISWindow(oName)}oUtil.isWindow.showOverlay();ev.preventDefault()}function onEditorStopResize(a){oUtil.resizeOffset={dx:a.screenX-oUtil.resizeInit.x,dy:a.screenY-oUtil.resizeInit.y};oUtil.currentResized.changeHeight(oUtil.resizeOffset.dy);oUtil.isWindow.hideOverlay();document.onmousemove=null;document.onmouseup=null;document.body.style.cursor="default"}function onEditorResize(a){oUtil.resizeOffset={dx:a.screenX-oUtil.resizeInit.x,dy:a.screenY-oUtil.resizeInit.y};oUtil.currentResized.changeHeight(oUtil.resizeOffset.dy);oUtil.resizeInit={x:a.screenX,y:a.screenY}}function initISEditor(){if(this.useTagSelector){if(this.TagSelectorPosition=="bottom"){this.TagSelectorPosition="top"}else{this.TagSelectorPosition="bottom"}this.moveTagSelector()}var g=document.getElementById("idContent"+this.oName).contentWindow;oUtil.oName=this.oName;oUtil.oEditor=g;oUtil.obj=this;oUtil.arrEditor.push(this.oName);try{g.document.designMode="on"}catch(d){}var h=String(this.preloadHTML).match(/<HTML[^>]*>/ig);if(h){this.loadHTMLFull(this.preloadHTML)}else{this.loadHTML(this.preloadHTML)}if(!oUtil.bOnLoadReplaced){if(window.onload){onload_original=window.onload}window.onload=new Function("onload_new()");oUtil.bOnLoadReplaced=true}try{var b=g.document.body.innerHTML;b=b.replace(/\s+/gi,"");if(b==""){g.document.body.innerHTML='<br class="innova" />'}var a=g.document.createRange();a.selectNode(g.document.body.childNodes[0]);a.collapse(true);var c=g.getSelection();c.removeAllRanges();c.addRange(a)}catch(d){}switch(this.mode){case"HTMLBody":this.originalContent=this.getHTMLBody();break;case"HTML":this.originalContent=this.getHTML();break;case"XHTMLBody":this.originalContent=this.getXHTMLBody();break;case"XHTML":this.originalContent=this.getXHTML();break}if(this.returnKeyMode==-1){if(this.useDIV){this.returnKeyMode=1}else{if(this.useBR){this.returnKeyMode=2}else{if(!this.useDIV&&!this.useBR){this.returnKeyMode=3}}}}this.onRender();if(this.disableFocusOnLoad==false){this.focus()}}function buildToolbar(h,c,k){var r=c.oName;for(var l=0;l<k.length;l++){sButtonName=k[l];switch(sButtonName){case"|":h.addSeparator();break;case"BRK":h.addBreak();break;case"FullScreen":h.addButton("btnFullScreen"+r,"btnFullScreen.gif",getTxt("Full Screen"));break;case"Print":h.addButton("btnPrint"+r,"btnPrint.gif",getTxt("Print"));break;case"Search":h.addButton("btnSearch"+r,"btnSearch.gif",getTxt("Search"));break;case"SpellCheck":if(c.spellCheckMode!="ieSpell"){h.addButton("btnSpellCheck"+r,"btnSpellCheck.gif",getTxt("Check Spelling"))}break;case"Styles":h.addButton("btnStyles"+r,"btnStyleSelect.gif",getTxt("Style Selection"));break;case"Paragraph":h.addDropdownButton("btnParagraph"+r,"ddParagraph"+r,"btnParagraph.gif",getTxt("Paragraph"),37);var w=new ISDropdown("ddParagraph"+r);w.onClick=function(i){ddAction(h,i,c,c.oName)};for(var g=0;g<c.arrParagraph.length;g++){w.addItem("btnParagraph_"+g+r,"<"+c.arrParagraph[g][1]+' style="margin-bottom:4px"  unselectable=on> '+c.arrParagraph[g][0]+"</"+c.arrParagraph[g][1]+">")}break;case"FontName":h.addDropdownButton("btnFontName"+r,"ddFontName"+r,"btnFontName.gif",getTxt("Font Name"),37);var o=new ISDropdown("ddFontName"+r);o.onClick=function(i){ddAction(h,i,c,c.oName)};for(var g=0;g<c.arrFontName.length;g++){o.addItem("btnFontName_"+g+r,"<span style='font-family:"+c.arrFontName[g]+";font-size:12px' unselectable=on>"+c.arrFontName[g]+"</span>")}break;case"FontSize":h.addDropdownButton("btnFontSize"+r,"ddFontSize"+r,"btnFontSize.gif",getTxt("Font Size"),37);var e=new ISDropdown("ddFontSize"+r);e.onClick=function(i){ddAction(h,i,c,c.oName)};for(var g=0;g<c.arrFontSize.length;g++){e.addItem("btnFontSize_"+g+r,'<font unselectable=on size="'+c.arrFontSize[g][1]+'">'+c.arrFontSize[g][0]+"</font>")}break;case"Undo":h.addButton("btnUndo"+r,"btnUndo.gif",getTxt("Undo"));break;case"Redo":h.addButton("btnRedo"+r,"btnRedo.gif",getTxt("Redo"));break;case"Paste":h.addDropdownButton("btnPaste"+r,"ddPaste"+r,"btnPaste.gif",getTxt("Paste"));var t=new ISDropdown("ddPaste"+r);t.iconPath=h.iconPath;t.addItem("btnPasteClip"+r,getTxt("Paste"),"btnPasteClip.gif");t.addItem("btnPasteText"+r,getTxt("Paste Text"),"btnPasteText.gif");t.onClick=function(i){ddAction(h,i,c,c.oName)};break;case"Emoticons":h.addDropdownButton("btnEmoticons"+r,"ddEmoticons"+r,"btnEmoticons.gif",getTxt("Emoticons"));var p=new ISDropdown("ddEmoticons"+r);p.add(new ISCustomDDItem("btnInsertEmoticons",c.GetEmoticons()));break;case"Quote":h.addToggleButton("btnQuote"+r,"",false,"btnQuote.gif",getTxt("Quote"));break;case"Bold":if(c.btnBold){h.addToggleButton("btnBold"+r,"",false,"btnBold.gif",getTxt("Bold"))}break;case"Italic":h.addToggleButton("btnItalic"+r,"",false,"btnItalic.gif",getTxt("Italic"));break;case"Underline":h.addToggleButton("btnUnderline"+r,"",false,"btnUnderline.gif",getTxt("Underline"));break;case"Strikethrough":h.addToggleButton("btnStrikethrough"+r,"",false,"btnStrikethrough.gif",getTxt("Strikethrough"));break;case"Superscript":h.addToggleButton("btnSuperscript"+r,"",false,"btnSuperscript.gif",getTxt("Superscript"));break;case"Subscript":h.addToggleButton("btnSubscript"+r,"",false,"btnSubscript.gif",getTxt("Subscript"));break;case"JustifyLeft":h.addToggleButton("btnJustifyLeft"+r,"align",false,"btnLeft.gif",getTxt("Justify Left"));break;case"JustifyCenter":h.addToggleButton("btnJustifyCenter"+r,"align",false,"btnCenter.gif",getTxt("Justify Center"));break;case"JustifyRight":h.addToggleButton("btnJustifyRight"+r,"align",false,"btnRight.gif",getTxt("Justify Right"));break;case"JustifyFull":h.addToggleButton("btnJustifyFull"+r,"align",false,"btnFull.gif",getTxt("Justify Full"));break;case"Numbering":h.addToggleButton("btnNumbering"+r,"bullet",false,"btnNumber.gif",getTxt("Numbering"));break;case"Bullets":h.addToggleButton("btnBullets"+r,"bullet",false,"btnList.gif",getTxt("Bullets"));break;case"Indent":h.addButton("btnIndent"+r,"btnIndent.gif",getTxt("Indent"));break;case"Outdent":h.addButton("btnOutdent"+r,"btnOutdent.gif",getTxt("Outdent"));break;case"LTR":h.addToggleButton("btnLTR"+r,"dir",false,"btnLTR.gif",getTxt("Left To Right"));break;case"RTL":h.addToggleButton("btnRTL"+r,"dir",false,"btnRTL.gif",getTxt("Right To Left"));break;case"ForeColor":h.addDropdownButton("btnForeColor"+r,"ddForeColor"+r,"btnForeColor.gif",getTxt("Foreground Color"));var p=new ISDropdown("ddForeColor"+r);p.add(new ISCustomDDItem("btnInsertForeColor",c.oColor1.generateHTML()));break;case"BackColor":h.addDropdownButton("btnBackColor"+r,"ddBackColor"+r,"btnBackColor.gif",getTxt("Background Color"));var p=new ISDropdown("ddBackColor"+r);p.add(new ISCustomDDItem("btnInsertBackColor",c.oColor2.generateHTML()));break;case"FontDialog":h.addButton("btnFontDialog"+r,"btnFont.gif",getTxt("Fonts"));break;case"TextDialog":h.addButton("btnTextDialog"+r,"btnText.gif",getTxt("Text"));break;case"CompleteTextDialog":h.addButton("btnCompleteTextDialog"+r,"btnText.gif",getTxt("Text"));break;case"LinkDialog":h.addButton("btnLinkDialog"+r,"btnHyperlink.gif",getTxt("Link"));break;case"ImageDialog":h.addButton("btnImageDialog"+r,"btnImage.gif",getTxt("Image"));break;case"YoutubeDialog":h.addButton("btnYoutubeDialog"+r,"btnYoutubeVideo.gif",getTxt("YoutubeVideo"));break;case"TableDialog":h.addButton("btnTableDialog"+r,"btnTableEdit.gif",getTxt("Table"));break;case"FlashDialog":h.addButton("btnFlashDialog"+r,"btnFlash.gif",getTxt("Flash"));break;case"CharsDialog":h.addButton("btnCharsDialog"+r,"btnSymbol.gif",getTxt("Special Characters"));break;case"SearchDialog":h.addButton("btnSearchDialog"+r,"btnSearch.gif",getTxt("Search & Replace"));break;case"SourceDialog":h.addButton("btnSourceDialog"+r,"btnSource.gif",getTxt("HTML Editor"));break;case"CustomTag":h.addDropdownButton("btnCustomTag"+r,"ddCustomTag"+r,"btnCustomTag.gif",getTxt("Tags"),37);var q=new ISDropdown("ddCustomTag"+r);q.onClick=function(i){ddAction(h,i,c,c.oName)};for(var g=0;g<c.arrCustomTag.length;g++){q.addItem("btnCustomTag_"+g+r,c.arrCustomTag[g][0])}break;case"ContentBlock":h.addButton("btnContentBlock"+r,"btnContentBlock.gif",getTxt("Content Block"));break;case"InternalLink":h.addButton("btnInternalLink"+r,"btnInternalLink.gif",getTxt("Internal Link"));break;case"InternalImage":h.addButton("btnInternalImage"+r,"btnInternalImage.gif",getTxt("Internal Image"));break;case"CustomObject":h.addButton("btnCustomObject"+r,"btnCustomObject.gif",getTxt("Object"));break;case"Table":var v=[],a=0;v[a++]="<table width='175' id='dropTableCreate"+r+"' style='cursor:default;background:#f3f3f8;' cellpadding=0 cellspacing=1 unselectable=on>";for(var d=0;d<8;d++){v[a++]="<tr>";for(var b=0;b<8;b++){v[a++]="<td onclick='"+r+".doClick_TabCreate(this)' onmouseover='doOver_TabCreate(this);event.cancelBubble=true;' style='background:#ffffff;font-size:1px;border:#d3d3d3 1px solid;width:20px;height:20px;' unselectable=on>&nbsp;</td>"}v[a++]="</tr>"}v[a++]='<tr><td colspan=8 onclick="'+r+".hide();modelessDialogShow('"+c.dialogPath+"webtable.htm',785, 500);\" onmouseover=\"doOut_TabCreate(document.getElementById('dropTableCreate"+r+"'));this.innerHTML='"+getTxt("Advanced Table Insert")+"';this.style.border='#777777 1px solid';this.style.backgroundColor='#444444';this.style.color='#ffffff'\" onmouseout=\"this.style.border='#f3f3f8 1px solid';this.style.backgroundColor='#f3f3f8';this.style.color='#000000'\" align=center style='font-family:verdana;font-size:10px;color:#000000;border:#f3f3f8 1px solid;padding:1px 1px 1px 1px' unselectable=on>"+getTxt("Advanced Table Insert")+"</td></tr>";v[a++]="</table>";h.addDropdownButton("btnTable"+r,"ddTable"+r,"btnTable.gif",getTxt("Insert Table"));var p=new ISDropdown("ddTable"+r);p.add(new ISCustomDDItem("btnInsertTable",v.join("")));break;case"Absolute":h.addButton("btnAbsolute"+r,"btnAbsolute.gif",getTxt("Absolute"));break;case"Line":h.addButton("btnLine"+r,"btnLine.gif",getTxt("Line"));break;case"RemoveFormat":h.addButton("btnRemoveFormat"+r,"btnRemoveFormat.gif",getTxt("Remove Formatting"));break;case"ClearAll":h.addButton("btnClearAll"+r,"btnDelete.gif",getTxt("Clear All"));break;default:for(g=0;g<c.arrCustomButtons.length;g++){if(sButtonName==c.arrCustomButtons[g][0]){sCbName=c.arrCustomButtons[g][0];sCbCaption=c.arrCustomButtons[g][2];sCbImage=c.arrCustomButtons[g][3];if(c.arrCustomButtons[g].length<5){if(c.arrCustomButtons[g][4]){h.addButton(sCbName+r,sCbImage,sCbCaption,c.arrCustomButtons[g][4])}else{h.addButton(sCbName+r,sCbImage,sCbCaption)}}else{if(c.arrCustomButtons[g][4]!=0){h.addDropdownButton(sCbName+r,"dd"+sCbName+r,sCbImage,sCbCaption,c.arrCustomButtons[g][4])}else{h.addDropdownButton(sCbName+r,"dd"+sCbName+r,sCbImage,sCbCaption)}var p=new ISDropdown("dd"+sCbName+r);var u=c.arrCustomButtons[g][5];for(var g=0;g<u.length;g++){tmp=u[g];p.addItem("item_"+sCbName+g+r,'<div style="margin:4px 0;padding:2px 0;font-size:13px;"  unselectable=on onclick="'+tmp[1]+'" > '+tmp[2]+"</div>")}}}}break}}}function iwe_getElm(a){return document.getElementById(a+this.oName)}function onload_new(){onload_original()}function onload_original(){}var arrColorPickerObjects=[];function ColorPicker(a,b){this.oParent=b;if(b){this.oName=b+"."+a;this.oRenderName=a+b}else{this.oName=a;this.oRenderName=a}arrColorPickerObjects.push(this.oName);this.onShow=function(){return true};this.onHide=function(){return true};this.onPickColor=function(){return true};this.onRemoveColor=function(){return true};this.hide=hideColorPicker;this.hideAll=hideColorPickerAll;this.color;this.isActive=false;this.generateHTML=generateHTML}function generateHTML(){var a=[["#ef001b","#cc0017","#a60012","#83000e","#ef0078","#ce0067","#ad0057","#8b0045","#e301ed","#c501ce","#a401ab","#88018e","#6716ef","#5913ce","#4b10af","#3e0d90"],["#f67684","#e36875","#ca5965","#b34e59","#f563ac","#de599b","#cc5490","#b24d7f","#ee68f4","#db5fe1","#c759cc","#b255b6","#a779f5","#976cdf","#8d68cc","#7f5eb7"],["#fcc0c6","#eea8af","#dd959c","#ce8c93","#fec7e2","#f4b8d6","#e5a6c6","#d495b4","#fabffd","#eeaff1","#e19fe4","#cf90d2","#e0c3fd","#d1b1f1","#c1a0e2","#b192d1"],["#fef5f6","#fdeced","#f7dee0","#eacedc","#fef3f8","#fbe8f1","#efd0e0","#e6c7d6","#fef2fe","#fae6fb","#f1d3f2","#e3c1e4","#f5edfe","#f0e5fb","#e1d3ef","#d9cbe7"],["#028b6c","#02775d","#02644e","#015441","#1882ed","#1574d4","#115eab","#0e4f90","#0040eb","#0039d0","#0030b1","#002892","#50509e","#46468b","#3a3a73","#303060"],["#69baa7","#61a898","#57998a","#508b7d","#7bb8f5","#6ea7e0","#6195c9","#5684b2","#6d92f5","#5f82e0","#5675c9","#4d68b2","#9b9bc9","#8b8bb6","#7e7ea5","#747496"],["#d0eae4","#b3d7cf","#9bc4ba","#8fb4ac","#c3dffc","#aacdf0","#9bbde0","#97b4d1","#bdcdfb","#a8bbef","#96aae1","#8a9bcb","#d8d8eb","#c7c7dc","#b5b5cc","#a5a5bc"],["#f0f8f6","#deedea","#d7e6e2","#ceddda","#f1f7fe","#e5f0fb","#d8e5f2","#cfdbe7","#eff3fe","#e5eafa","#dde3f4","#d2d8ea","#f4f4f9","#e5e5ef","#dbdbe5","#d6d6df"],["#00a000","#008d00","#007700","#006000","#86d800","#73ba00","#629e00","#528400","#eded00","#cece00","#afaf00","#909000","#e3ab00","#c79600","#aa8000","#856400"],["#68c868","#5cb65c","#56a456","#4b924b","#b7e768","#a8d45f","#97c056","#86aa4d","#f1f164","#e1e15d","#caca58","#b2b24d","#eecc65","#dabc5e","#c7ac59","#b09850"],["#c6ecc6","#addead","#96cd96","#87b987","#e1f6c0","#d0eba6","#c1d99a","#b1c88c","#fbfbad","#f1f194","#e2e28e","#cece8c","#faeaba","#f2dfa7","#e6d090","#cbbb8b"],["#eef9ee","#dff1df","#d5e8d5","#c6dbc6","#f1fbe2","#e9f5d5","#dfebcd","#d4e1c0","#fefef0","#fafae3","#f0f0cb","#e4e4c5","#fdf8ea","#f9f2de","#eee4c7","#dfd7bf"],["#818181","#676767","#494949","#000000","#783c00","#673300","#562b00","#472300","#eb4600","#cd3d00","#ad3300","#8f2a00","#ed7700","#d26900","#af5800","#904800"],["#c9c9c9","#a9a9a9","#919191","#787878","#af8b68","#a28264","#917458","#856d55","#f19068","#dd8561","#c97654","#b47053","#f5ac63","#e1a05f","#ca9259","#b78451"],["#efefef","#dcdcdc","#c1c1c1","#9d9d9d","#dbcab9","#ccb8a5","#bda792","#a3917f","#fbcebc","#f1bba5","#e1aa93","#ce9f8b","#fcd7b3","#f3caa2","#e7b98c","#c8a078"],["#ffffff","#f7f7f7","#ededed","#dddddd","#f4efeb","#efe8e1","#e6ded6","#dbd3cc","#fef5f2","#fae8e1","#f0dbd3","#e1cbc2","#fef7f0","#faecde","#f1e2d3","#e3d3c3"]];var d="<table id=dropColor"+this.oRenderName+" style=\"background-color:#fcfcfc;\" unselectable=on cellpadding=0 cellspacing=0 width=140px><tr><td unselectable=on style='padding:2px;'>";d+="<table align=center cellpadding=0 cellspacing=0 border=0 unselectable=on>";for(var c=0;c<a.length;c++){d+="<tr>";for(var b=0;b<a[c].length;b++){d+='<td onclick="'+this.oName+".color='"+a[c][b]+"';"+this.oName+".onPickColor();"+this.oName+'.hideAll()" style="" unselectable=on><table style=\'-moz-border-radius:0px;-webkit-border-radius: 0px;margin:0px;padding:0px;width:12px;height:12px;background:'+a[c][b]+";' cellpadding=0 cellspacing=0 unselectable=on><tr><td unselectable=on style='cursor:pointer;margin:0px;padding:0px;line-height:normal;font-size:10px;'>&nbsp;</td></tr></table></td>"}d+="</tr>"}d+="<tr>";d+="<td colspan=16 unselectable=on style='padding:0px;'><table style='padding:0px;margin-left:1px;width:100%;height:14px;background:#f4f4f4;' cellpadding=0 cellspacing=0 unselectable=on><tr><td onclick=\""+this.oName+".onRemoveColor();"+this.oName+'.hideAll()" onmouseover="this.style.border=\'#777777 1px solid\'" onmouseout="this.style.border=\'white 1px solid\'" style="cursor:default;padding:1px;border:white 1px solid;font-family:verdana;font-size:10px;color:#000000;line-height:9px;" align=center valign=top unselectable=on>x</td></tr></table></td>';d+="</tr>";d+="</table>";d+="</td></tr></table>";return d}function hideColorPicker(){this.onHide();return;var a=document.getElementById("dropColor"+this.oRenderName);a.style.display="none";this.isActive=false}function hideColorPickerAll(){return;for(var i=0;i<arrColorPickerObjects.length;i++){var box=document.getElementById("dropColor"+eval(arrColorPickerObjects[i]).oRenderName);box.style.display="none";eval(arrColorPickerObjects[i]).isActive=false}}function loadHTML(d){var k=document.getElementById("idContent"+this.oName).contentWindow;var l=k.document.open("text/html");if(this.publishingPath!=""){var m=String(this.preloadHTML).match(/<base[^>]*>/ig);if(!m){d=this.docType+'<html><head><base href="'+this.publishingPath+'"/>'+this.headContent+"</head><body>"+d+"</body></html>"}}else{d=this.docType+"<html><head>"+this.headContent+"</head><body>"+d+"</body></html>"}l.write(d);l.close();var h=this;k.document.addEventListener("keyup",new Function("editorDoc_onkeyup("+this.oName+")"),true);k.document.addEventListener("mouseup",function(i){editorDoc_onmouseup(i,h.oName)},true);k.document.addEventListener("keydown",new Function("var e=arguments[0];doKeyPress(eval(e), "+this.oName+")"),false);var a=k.document.createElement("LINK");a.href=this.scriptPath+"default_edit.css";a.rel="StyleSheet";a.id="tmp_xxinnova";k.document.documentElement.childNodes[0].appendChild(a);if(typeof this.css=="object"){for(var e=0;e<this.css.length;e++){var a=k.document.createElement("LINK");a.href=this.css[e];a.rel="StyleSheet";k.document.documentElement.childNodes[0].appendChild(a)}}else{if(this.css!=""){var a=k.document.createElement("LINK");a.href=this.css;a.rel="StyleSheet";k.document.documentElement.childNodes[0].appendChild(a)}}if(this.arrStyle.length>0){var b=k.document.createElement("STYLE");k.document.documentElement.childNodes[0].appendChild(b);var c="";for(var g=0;g<this.arrStyle.length;g++){selector=this.arrStyle[g][0];style=this.arrStyle[g][3];c+=selector+" { "+style+" } "}b.appendChild(k.document.createTextNode(c))}this.cleanDeprecated()}function loadHTMLFull(c,j){var m=document.getElementById("idContent"+this.oName).contentWindow;var p=String(c).match(/<!DOCTYPE[^>]*>/ig);if(p){for(var d=0;d<p.length;d++){this.docType=p[d]}}else{this.docType=""}var o=String(c).match(/<HTML[^>]*>/ig);if(o){for(var d=0;d<o.length;d++){s=o[d];s=s.replace(/\"[^\"]*\"/ig,function(e){e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/\s+/ig,"#_#");return e});s=s.replace(/<([^ >]*)/ig,function(e){return e.toLowerCase()});s=s.replace(/ ([^=]+)=([^" >]+)/ig,' $1="$2"');s=s.replace(/ ([^=]+)=/ig,function(e){return e.toLowerCase()});s=s.replace(/#_#/ig," ");this.html=s}}else{this.html="<html>"}if(this.publishingPath!=""){var p=c.match(/<base[^>]*>/ig);if(!p){c='<BASE HREF="'+this.publishingPath+'"/>'+c}}if(j){try{m.document.designMode="on"}catch(g){}}var l=m.document.documentElement;var b=/<head>([\S\s]*?)<\/head>/gi;var h=b.exec(c),a="";if(h){a=h[1]}if(a.indexOf("default_edit.css")==-1){a=a+"<link id='tmp_xxinnova' rel='stylesheet' href='"+this.scriptPath+"default_edit.css' />"}c=c.replace(b,"<head>"+a+"</head>");var n=m.document.open("text/html","replace");n.write(c);n.close();var k=this;m.document.addEventListener("keyup",new Function("editorDoc_onkeyup("+k.oName+")"),true);m.document.addEventListener("mouseup",function(i){editorDoc_onmouseup(i,k.oName)},true);m.document.addEventListener("keydown",new Function("var e=arguments[0];doKeyPress(eval(e), "+this.oName+")"),false);this.cleanDeprecated()}function putHTML(a){this.loadHTMLFull(a,true)}function encodeHTMLCode(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function cleanHTML(d){var b=d.replace(/<br class="innova" \/>/gi,"").replace(/<br class="innova">/gi,"");var c=b.match(/<link[^>]*>/ig);if(c){for(var a=0;a<c.length;a++){if(c[a].indexOf("tmp_xxinnova")!=-1){b=b.replace(new RegExp(c[a],"gi"),"")}}}return b}function getTextBody(){var b=document.getElementById("idContent"+this.oName).contentWindow;var a=b.document.body.textContent;a=a.replace(/<!(?:--[\s\S]*?--\s*)?>\s*/gi,"");return a}function getHTML(b){var a=document.getElementById("idContent"+this.oName).contentWindow;this.cleanDeprecated();sHTML=getOuterHTML(a.document.documentElement);sHTML=this.docType+sHTML;sHTML=oUtil.replaceSpecialChar(sHTML);if(this.encodeIO){sHTML=encodeHTMLCode(sHTML)}sHTML=cleanHTML(sHTML);if(!b){sHTML=sHTML.replace(/ contenteditable=\"true\"/ig,"");sHTML=sHTML.replace(/ contenteditable=\"false\"/ig,"")}return sHTML}function getHTMLBody(b){var a=document.getElementById("idContent"+this.oName).contentWindow;this.cleanDeprecated();sHTML=a.document.body.innerHTML;sHTML=oUtil.replaceSpecialChar(sHTML);if(this.encodeIO){sHTML=encodeHTMLCode(sHTML)}sHTML=cleanHTML(sHTML);if(!b){sHTML=sHTML.replace(/ contenteditable=\"true\"/ig,"");sHTML=sHTML.replace(/ contenteditable=\"false\"/ig,"")}return sHTML}var sBaseHREF="";function getXHTML(e){var d=document.getElementById("idContent"+this.oName).contentWindow;this.cleanDeprecated();sHTML=getOuterHTML(d.document.documentElement);var c=sHTML.match(/<BASE([^>]*)>/ig);if(c!=null){sBaseHREF=c[0]}var a=d.document.getElementsByTagName("BASE");if(a.length!=null){for(var b=0;b<a.length;b++){a[b].parentNode.removeChild(a[b])}}sBaseHREF=sBaseHREF.replace(/<([^ >]*)/ig,function(g){return g.toLowerCase()});sBaseHREF=sBaseHREF.replace(/ [^=]+="[^"]+"/ig,function(g){g=g.replace(/\s+/ig,"#_#");g=g.replace(/^#_#/," ");return g});sBaseHREF=sBaseHREF.replace(/ ([^=]+)=([^" >]+)/ig,' $1="$2"');sBaseHREF=sBaseHREF.replace(/ ([^=]+)=/ig,function(g){return g.toLowerCase()});sBaseHREF=sBaseHREF.replace(/#_#/ig," ");sBaseHREF=sBaseHREF.replace(/>$/ig," />").replace(/\/ \/>$/ig,"/>");sHTML=recur(d.document.documentElement,"");sHTML=this.docType+this.html+sHTML+"\n</html>";sHTML=sHTML.replace(/<head>/i,"<head>"+sBaseHREF);sHTML=oUtil.replaceSpecialChar(sHTML);if(this.encodeIO){sHTML=encodeHTMLCode(sHTML)}sHTML=cleanHTML(sHTML);if(!e){sHTML=sHTML.replace(/ contenteditable=\"true\"/ig,"");sHTML=sHTML.replace(/ contenteditable=\"false\"/ig,"")}return sHTML}function getXHTMLBody(c){var b=document.getElementById("idContent"+this.oName).contentWindow;this.cleanDeprecated();sHTML=getOuterHTML(b.document.documentElement);var a=sHTML.match(/<BASE([^>]*)>/ig);if(a!=null){sBaseHREF=a[0]}sHTML=recur(b.document.body,"");sHTML=oUtil.replaceSpecialChar(sHTML);if(this.encodeIO){sHTML=encodeHTMLCode(sHTML)}sHTML=cleanHTML(sHTML);if(!c){sHTML=sHTML.replace(/ contenteditable=\"true\"/ig,"");sHTML=sHTML.replace(/ contenteditable=\"false\"/ig,"")}return sHTML}function ApplyCSS(oName){var sTmp="";var myStyle=document.getElementById("myStyle"+oName).contentWindow;for(var i=0;i<myStyle.document.styleSheets[0].cssRules.length;i++){var sSelector=myStyle.document.styleSheets[0].cssRules[i].selectorText;if(sSelector!=undefined){sCssText=myStyle.document.styleSheets[0].cssRules[i].style.cssText.replace(/"/g,"&quot;");var itemCount=sSelector.split(".").length;if(itemCount>1){sCaption=sSelector.split(".")[1];sTmp+=',["'+sSelector+'",true,"'+sCaption+'","'+sCssText+'"]'}else{sTmp+=',["'+sSelector+'",false,"","'+sCssText+'"]'}}}var arrStyle=eval("["+sTmp.substr(1)+"]");if(arrStyle.length>0){var oEditor=document.getElementById("idContent"+oName).contentWindow;var oElement=oEditor.document.createElement("STYLE");oEditor.document.documentElement.childNodes[0].appendChild(oElement);var sCssText="";for(var i=0;i<arrStyle.length;i++){selector=arrStyle[i][0];style=arrStyle[i][3].replace(/&quot;/g,'"');sCssText+=selector+" { "+style+" } "}oElement.appendChild(oEditor.document.createTextNode(sCssText))}}function ApplyExternalStyle(oName){var edtObj=eval(oName);var oEditor=document.getElementById("idContent"+oName).contentWindow;var edtHost=oEditor.location.href.match(/:\/\/(.[^/]+)/)[1];var sTmp="";for(var j=0;j<oEditor.document.styleSheets.length;j++){var myStyle=oEditor.document.styleSheets[j];if(myStyle.href&&myStyle.href.match(/:\/\/(.[^/]+)/)[1]!=edtHost){continue}for(var i=0;i<myStyle.cssRules.length;i++){sSelector=myStyle.cssRules[i].selectorText;if(sSelector!=undefined){if(sSelector.match(/table\./gi)){continue}if(edtObj.styleSelectorPrefix!=""&&!sSelector.indexOf("."+edtObj.styleSelectorPrefix)==0){continue}sSelector=sSelector.replace(/"/g,'\\"');sCssText=myStyle.cssRules[i].style.cssText.replace(/"/g,"&quot;");var itemCount=sSelector.split(".").length;if(itemCount>1){sCaption=sSelector.split(".")[1];sTmp+=',["'+sSelector+'",true,"'+sCaption+'","'+sCssText+'"]'}else{sTmp+=',["'+sSelector+'",false,"","'+sCssText+'"]'}}}}var arrStyle=eval("["+sTmp.substr(1)+"]");for(var i=0;i<arrStyle.length;i++){for(var j=0;j<edtObj.arrStyle.length;j++){if(arrStyle[i][0].toLowerCase()==edtObj.arrStyle[j][0].toLowerCase()){arrStyle[i][1]=edtObj.arrStyle[j][1];break}}}edtObj.arrStyle=arrStyle}function doApplyStyle(oName,sClassName){var oEditor=document.getElementById("idContent"+oName).contentWindow;var oSel=oEditor.getSelection();eval(oName).saveForUndo();var element;if(oUtil.activeElement){element=oUtil.activeElement;element.className=sClassName}else{element=getSelectedElement(oSel);if(isTextSelected(oSel)){if(oSel!=""){eval(oName).applySpanStyle([],sClassName)}else{if(element.tagName=="BODY"){return}element.className=sClassName}}else{if(element.tagName=="BODY"){return}element.className=sClassName}}realTime(eval(oName))}function openStyleSelect(){if(!this.isCssLoaded){ApplyExternalStyle(this.oName)}this.isCssLoaded=true;var e=document.getElementById("idStyles"+this.oName);if(e.innerHTML!=""){if(e.style.display==""){e.style.display="none"}else{e.style.display=""}return}e.style.display="";var d=document.getElementById("idContent"+this.oName).offsetHeight-27;var j=this.arrStyle;var g="";g+="<div unselectable=on style='margin:5px;margin-top:0;margin-right:0' align=right>";g+="<table style='margin:1px;margin-top:2px;margin-bottom:3px;width:14px;height:14px;background:#E9E8F2;' cellpadding=0 cellspacing=0 unselectable=on><tr><td onclick=\""+this.oName+".openStyleSelect();\" onmouseover=\"this.style.border='#708090 1px solid';this.style.color='white';this.style.backgroundColor='9FA7BB'\" onmouseout=\"this.style.border='white 1px solid';this.style.color='black';this.style.backgroundColor=''\" style=\"cursor:default;padding:1px;border:white 1px solid;font-family:verdana;font-size:10px;color:#000000;line-height:9px;\" align=center valign=top unselectable=on>x</td></tr></table>";var c="";for(var b=0;b<j.length;b++){sSelector=j[b][0];if(sSelector=="body"){c=j[b][3]}}g+="<div unselectable=on style='overflow:auto;width:200px;height:"+d+"px;'>";g+="<table name='tblStyles"+this.oName+"' id='tblStyles"+this.oName+"' cellpadding=0 cellspacing=0 style='background:#fcfcfc;"+c+";height:100%;width:100%;margin:0;'>";for(var b=0;b<j.length;b++){sSelector=j[b][0];isOnSelection=j[b][1];sCssText=j[b][3];sCaption=j[b][2];if(isOnSelection){if(sSelector.split(".").length>1){var a=sSelector;if(sSelector.indexOf(":")>0){a=sSelector.substring(0,sSelector.indexOf(":"))}if(a.indexOf("awesome")==-1){g+="<tr style=\"cursor:default\" onmouseover=\"if(this.style.marginRight!='1px'){this.style.background='"+this.styleSelectionHoverBg+"';this.style.color='"+this.styleSelectionHoverFg+"'}\" onmouseout=\"if(this.style.marginRight!='1px'){this.style.background='';this.style.color=''}\">";g+="<td unselectable=on onclick=\"doApplyStyle('"+this.oName+"','"+a.split(".")[1]+"')\" style='padding:2px'>";if(sSelector.split(".")[0]==""){g+='<span unselectable=on style="'+sCssText+';margin:0;">'+sCaption+"</span>"}else{g+='<span unselectable=on style="'+sCssText+';margin:0;">'+sSelector+"</span>"}g+="</td></tr>"}}}}g+="<tr><td height=100%>&nbsp;</td></tr></table></div>";g+="</div>";document.getElementById("idStyles"+this.oName).innerHTML=g}function cleanFonts(){var e=document.getElementById("idContent"+this.oName).contentWindow;var b=e.document.body.getElementsByTagName("FONT");if(b.length==0){return false}var d;var a;while(b.length>0){d=b[0];if(d.hasChildNodes&&d.childNodes.length==1&&d.childNodes[0].nodeType==1&&d.childNodes[0].nodeName=="SPAN"){var g=d.childNodes[0];copyAttribute(g,d);a=e.document.createRange();a.selectNode(d);a.insertNode(g);a.selectNode(d);a.deleteContents()}else{if(d.parentNode.nodeName=="SPAN"&&d.parentNode.childNodes.length==1){var g=d.parentNode;copyAttribute(g,d);g.innerHTML=d.innerHTML}else{var c=e.document.createElement("SPAN");copyAttribute(c,d);c.innerHTML=d.innerHTML;d.parentNode.replaceChild(c,d)}}}return true}function cleanTags(e,a){var g=document.getElementById("idContent"+this.oName).contentWindow;if(e.length==0){return false}var d;var b;while(e.length>0){d=e[0];if(d.hasChildNodes&&d.childNodes.length==1&&d.childNodes[0].nodeType==1&&d.childNodes[0].nodeName=="SPAN"){var h=d.childNodes[0];if(a=="bold"){h.style.fontWeight="bold"}if(a=="italic"){h.style.fontStyle="italic"}if(a=="line-through"){h.style.textDecoration="line-through"}if(a=="underline"){h.style.textDecoration="underline"}b=g.document.createRange();b.selectNode(d);b.insertNode(h);b.selectNode(d);b.deleteContents()}else{if(d.parentNode.nodeName=="SPAN"&&d.parentNode.childNodes.length==1){var h=d.parentNode;if(a=="bold"){h.style.fontWeight="bold"}if(a=="italic"){h.style.fontStyle="italic"}if(a=="line-through"){h.style.textDecoration="line-through"}if(a=="underline"){h.style.textDecoration="underline"}h.innerHTML=d.innerHTML}else{var c=g.document.createElement("SPAN");if(a=="bold"){c.style.fontWeight="bold"}if(a=="italic"){c.style.fontStyle="italic"}if(a=="line-through"){c.style.textDecoration="line-through"}if(a=="underline"){c.style.textDecoration="underline"}c.innerHTML=d.innerHTML;d.parentNode.replaceChild(c,d)}}}return true}function replaceTags(c,b){var e=document.getElementById("idContent"+this.oName).contentWindow;var d=e.document.body.getElementsByTagName(c);while(d.length>0){f=d[0];var a=e.document.createElement(b);a.innerHTML=f.innerHTML;f.parentNode.replaceChild(a,f)}}function cleanDeprecated(){var c=document.getElementById("idContent"+this.oName).contentWindow;var b;b=c.document.body.getElementsByTagName("STRONG");this.cleanTags(b,"bold");b=c.document.body.getElementsByTagName("B");this.cleanTags(b,"bold");b=c.document.body.getElementsByTagName("STRIKE");this.cleanTags(b,"line-through");b=c.document.body.getElementsByTagName("S");this.cleanTags(b,"line-through");b=c.document.body.getElementsByTagName("U");this.cleanTags(b,"underline");this.replaceTags("DIR","DIV");this.replaceTags("MENU","DIV");this.replaceTags("CENTER","DIV");this.replaceTags("XMP","PRE");this.replaceTags("BASEFONT","SPAN");b=c.document.body.getElementsByTagName("APPLET");while(b.length>0){var a=b[0];theParent=a.parentNode;theParent.removeChild(a)}this.cleanFonts();this.cleanEmptySpan();return true}function applySpanStyle(h,b,i){var g="SPAN";if(i!=null&&i!=""){g=i}var e=document.getElementById("idContent"+this.oName).contentWindow;var a=e.getSelection();var c;var d;this.hide();this.doCmd("fontsize","0");replaceWithSpan(e,h,b,g);realTime(this)}function doClean(){this.saveForUndo();if(oUtil.activeElement){var c=oUtil.activeElement}else{var d=document.getElementById("idContent"+this.oName).contentWindow;var a=d.getSelection();c=getSelectedElement(a);if(isTextSelected(a)){if(a!=""){var b=a.getRangeAt(0);if(c.innerHTML!=b.toString()){this.doCmd("RemoveFormat");realTime(this);return}}else{if(c.tagName=="BODY"){return}}}else{if(c.tagName=="BODY"){return}}}c.removeAttribute("className");c.removeAttribute("style");if(c.tagName=="H1"||c.tagName=="H2"||c.tagName=="H3"||c.tagName=="H4"||c.tagName=="H5"||c.tagName=="H6"||c.tagName=="PRE"||c.tagName=="P"||c.tagName=="DIV"){this.doCmd("FormatBlock","<P>")}this.doCmd("RemoveFormat");realTime(this)}function cleanEmptySpan(){var b=false;var j=document.getElementById("idContent"+this.oName).contentWindow;var a=/<\s*SPAN\s*>/gi;while(true){var h=j.document.getElementsByTagName("SPAN");if(h.length==0){break}var l=[];for(var e=0;e<h.length;e++){if(getOuterHTML(h[e]).search(a)==0){l[l.length]=h[e]}}if(l.length==0){break}var c,d;for(var e=0;e<l.length;e++){c=l[e];d=c.parentNode;if(!d){continue}if(c.hasChildNodes()){var g=j.document.createRange();g.selectNodeContents(c);var k=g.extractContents();d.replaceChild(k,c)}else{d.removeChild(c)}b=true}}return b}function copyStyleClass(b,d,a){if(d){for(var c=0;c<d.length;c++){b.style[d[c][0]]=d[c][1]}if(b.style.cssText==""){b.removeAttribute("style",0)}}if(a){b.className=a}}function copyAttribute(b,c){if((c.face!=null)&&(c.face!="")){b.style.fontFamily=c.face}if((c.size!=null)&&(c.size!="")){var a="";if(c.size==1){a="8pt"}else{if(c.size==2){a="10pt"}else{if(c.size==3){a="12pt"}else{if(c.size==4){a="14pt"}else{if(c.size==5){a="18pt"}else{if(c.size==6){a="24pt"}else{if(c.size>=7){a="36pt"}else{if(c.size<=-2||c.size=="0"){a="8pt"}else{if(c.size=="-1"){a="10pt"}else{if(c.size==0){a="12pt"}else{if(c.size=="+1"){a="14pt"}else{if(c.size=="+2"){a="18pt"}else{if(c.size=="+3"){a="24pt"}else{if(c.size=="+4"||c.size=="+5"||c.size=="+6"){a="36pt"}else{a=""}}}}}}}}}}}}}}if(a!=""){b.style.fontSize=a}}if((c.style.backgroundColor!=null)&&(c.style.backgroundColor!="")){b.style.backgroundColor=c.style.backgroundColor}if((c.color!=null)&&(c.color!="")){b.style.color=c.color}if((c.className!=null)&&(c.className!="")){b.className=c.className}}function replaceWithSpan(r,n,c,l){var i="SPAN";if(l!=null&&l!=""){i=l}var e=r.getSelection();var k=e.getRangeAt(0);var p=k.cloneRange();var t=k.startContainer;var d=k.endContainer;var q=r.document.getElementsByTagName("FONT");var h=null;var m=null;while(q.length>0){m=q[0];if(m.childNodes&&m.childNodes.length==1&&m.childNodes[0].nodeType==1&&m.childNodes[0].nodeName==i){h=m.childNodes[0];var o=h.getElementsByTagName(i);if(o){for(var g=0;g<o.length;g++){if(n||c){copyStyleClass(o[g],n,c)}else{copyAttribute(o[g],m)}}}if(n||c){copyStyleClass(h,n,c)}else{copyAttribute(h,m)}k=r.document.createRange();k.selectNode(m);k.insertNode(h);k.selectNode(m);k.deleteContents()}else{var o=m.getElementsByTagName(i);if(o){for(var g=0;g<o.length;g++){if(n||c){copyStyleClass(o[g],n,c)}else{copyAttribute(o[g],m)}}}h=r.document.createElement(i);h.innerHTML=m.innerHTML;if(n||c){copyStyleClass(h,n,c)}else{copyAttribute(h,m)}m.parentNode.replaceChild(h,m);var b=r.getSelection();var k=b.getRangeAt(0);if(k.startContainer.nodeType==Node.TEXT_NODE){var a=k.startContainer.nextSibling;if(a){k=r.document.createRange();k.selectNode(a);b=r.getSelection();b.removeAllRanges();b.addRange(k)}}return}}e=r.getSelection();e.removeAllRanges();e.addRange(p)}function editorDoc_onkeyup(a){if(a.tmKeyup){clearTimeout(a.tmKeyup);a.tmKeyup=null}if(!a.tmKeyup){a.tmKeyup=setTimeout(function(){realTime(a)},1000)}}function editorDoc_onmouseup(e,oName){var edtObj=eval(oName);var edtFrm=document.getElementById("idContent"+edtObj.oName);oUtil.activeElement=null;oUtil.oName=oName;oUtil.oEditor=edtFrm.contentWindow;oUtil.obj=edtObj;edtObj.hide();realTime(edtObj)}function setActiveEditor(a){oUtil.oName=a.oName;oUtil.oEditor=document.getElementById("idContent"+a.oName).contentWindow;oUtil.obj=a}var arrTmp=[];function GetElement(b,a){while(b!=null&&b.tagName!=a){if(b.tagName=="BODY"){return null}b=b.parentNode}return b}var arrTmp2=[];function realTime(c){try{var o=c.oName;var j=document.getElementById("idContent"+o).contentWindow;var l=j.getSelection();var b=getSelectedElement(l);var k=c;var a=k.tbar;var g=null;var p=GetElement(b,"TABLE");if(p){k.Table=p}var x=j.document;if(k.btnParagraph){g=a.btns["btnParagraph"+o];g.setState(x.queryCommandEnabled("FormatBlock")?1:5)}if(k.btnFontName){g=a.btns["btnFontName"+o];g.setState(x.queryCommandEnabled("FontName")?1:5)}if(k.btnFontSize){g=a.btns["btnFontSize"+o];g.setState(x.queryCommandEnabled("FontSize")?1:5)}if(k.btnPaste){g=a.btns["btnPaste"+o];g.setState(x.queryCommandEnabled("Paste")?1:5)}if(k.btnUndo){g=a.btns["btnUndo"+o];g.setState(!k.arrUndoList[0]?5:1)}if(k.btnRedo){g=a.btns["btnRedo"+o];g.setState(!k.arrRedoList[0]?5:1)}if(k.btnBold){g=a.btns["btnBold"+o];g.setState(x.queryCommandEnabled("Bold")?(x.queryCommandState("Bold")?4:1):5)}if(k.btnItalic){g=a.btns["btnItalic"+o];g.setState(x.queryCommandEnabled("Italic")?(x.queryCommandState("Italic")?4:1):5)}if(k.btnUnderline){g=a.btns["btnUnderline"+o];g.setState(x.queryCommandEnabled("Underline")?(x.queryCommandState("Underline")?4:1):5)}if(k.btnStrikethrough){g=a.btns["btnStrikethrough"+o];g.setState(x.queryCommandEnabled("Strikethrough")?(x.queryCommandState("Strikethrough")?4:1):5)}if(k.btnSuperscript){g=a.btns["btnSuperscript"+o];g.setState(x.queryCommandEnabled("Superscript")?(x.queryCommandState("Superscript")?4:1):5)}if(k.btnSubscript){g=a.btns["btnSubscript"+o];g.setState(x.queryCommandEnabled("Subscript")?(x.queryCommandState("Subscript")?4:1):5)}if(k.btnNumbering){g=a.btns["btnNumbering"+o];g.setState(x.queryCommandEnabled("InsertOrderedList")?(x.queryCommandState("InsertOrderedList")?4:1):5)}if(k.btnBullets){g=a.btns["btnBullets"+o];g.setState(x.queryCommandEnabled("InsertUnorderedList")?(x.queryCommandState("InsertUnorderedList")?4:1):5)}if(k.btnJustifyLeft){g=a.btns["btnJustifyLeft"+o];g.setState(x.queryCommandEnabled("JustifyLeft")?(x.queryCommandState("JustifyLeft")?4:1):5)}if(k.btnJustifyCenter){g=a.btns["btnJustifyCenter"+o];g.setState(x.queryCommandEnabled("JustifyCenter")?(x.queryCommandState("JustifyCenter")?4:1):5)}if(k.btnJustifyRight){g=a.btns["btnJustifyRight"+o];g.setState(x.queryCommandEnabled("JustifyRight")?(x.queryCommandState("JustifyRight")?4:1):5)}if(k.btnJustifyFull){g=a.btns["btnJustifyFull"+o];g.setState(x.queryCommandEnabled("JustifyFull")?(x.queryCommandState("JustifyFull")?4:1):5)}if(k.btnIndent){g=a.btns["btnIndent"+o];g.setState(x.queryCommandEnabled("Indent")?1:5)}if(k.btnOutdent){g=a.btns["btnOutdent"+o];g.setState(x.queryCommandEnabled("Outdent")?1:5)}if(k.btnLTR){g=a.btns["btnLTR"+o];g.setState(b.dir?(b.dir.toLowerCase()=="ltr"?4:1):1)}if(k.btnRTL){g=a.btns["btnRTL"+o];g.setState(b.dir?(b.dir.toLowerCase()=="rtl"?4:1):1)}var h=(b?1:5);if(k.btnForeColor){a.btns["btnForeColor"+o].setState(h)}if(k.btnBackColor){a.btns["btnBackColor"+o].setState(h)}if(k.btnLine){a.btns["btnLine"+o].setState(h)}try{oUtil.onSelectionChanged()}catch(w){}try{k.onSelectionChanged()}catch(w){}var u=document.getElementById("idStyles"+o);if(u.innerHTML!=""){var m;if(oUtil.activeElement){m=oUtil.activeElement}else{m=getSelectedElement(l)}var n=m.className;var d=document.getElementById("tblStyles"+o).rows;for(var t=0;t<d.length-1;t++){sClass=d[t].childNodes[0].childNodes[0].innerHTML;if(sClass.split(".").length>1&&sClass!=""){sClass=sClass.split(".")[1]}if(n==sClass){d[t].style.marginRight="1px";d[t].style.backgroundColor=k.styleSelectionHoverBg;d[t].style.color=k.styleSelectionHoverFg}else{d[t].style.marginRight="";d[t].style.backgroundColor="";d[t].style.color=""}}}if(k.useTagSelector){m=b;var q="";var t=0;arrTmp2=[];while(m!=null&&m.tagName!="BODY"&&m.nodeType==1){arrTmp2[t]=m;q="&nbsp; &lt;<span id=tag"+o+t+" unselectable=on style='text-decoration:underline;cursor:pointer' onclick=\""+o+".selectElement("+t+')">'+m.tagName+"</span>&gt;"+q;m=m.parentNode;t++}q="&nbsp;&lt;BODY&gt;"+q;document.getElementById("idElNavigate"+o).innerHTML=q;document.getElementById("idElCommand"+o).style.display="none";for(t=0;t<arrTmp2.length;t++){document.getElementById("tag"+o+t).addEventListener("click",new Function(o+".selectElement("+t+")"),true)}}g=a.btns["btnQuote"+o];if(g){var r=GetElement(b,"BLOCKQUOTE");g.setState(r?4:1)}}catch(w){}}function realtimeFontSelect(oName){var oEditor=document.getElementById("idContent"+oName).contentWindow;var sFontName=oEditor.document.queryCommandValue("FontName");var edt=eval(oName);var found=false;for(var i=0;i<edt.arrFontName.length;i++){if(sFontName==edt.arrFontName[i]){found=true;break}}if(found){isDDs["ddFontName"+oName].selectItem("btnFontName_"+i+oName,true)}else{isDDs["ddFontName"+oName].clearSelection()}}function realtimeSizeSelect(oName){var oEditor=document.getElementById("idContent"+oName).contentWindow;var sFontSize=oEditor.document.queryCommandValue("FontSize");var edt=eval(oName);var found=false;for(var i=0;i<edt.arrFontSize.length;i++){if(sFontSize==edt.arrFontSize[i][1]){found=true;break}}if(found){isDDs["ddFontSize"+oName].selectItem("btnFontSize_"+i+oName,true)}else{isDDs["ddFontSize"+oName].clearSelection()}}function moveTagSelector(){var h=document.getElementById("idArea"+this.oName);var d=h.offsetWidth-90;var i=this.scriptPath.substring(0,this.scriptPath.indexOf("moz/"))+this.iconPath;var c="<table unselectable=on ondblclick='"+this.oName+".moveTagSelector()' width='100%' cellpadding=0 cellspacing=0 style='border:none;border:#cfcfcf 1px solid;border-bottom:none;margin:0px'><tr style='background-color:#f4f4f4;font-family:arial;font-size:10px;color:black;'><td id=idElNavigate"+this.oName+" style='color:inherit;line-height:normal;font-size:inherit;padding:1px;width:"+d+"px' valign=top>&nbsp;</td><td align=right valign='center' nowrap style='color:inherit;padding:0;margin;0;font-size:inherit;line-height:normal'><span id=idElCommand"+this.oName+" unselectable=on style='vertical-align:middle;display:none;text-decoration:underline;cursor:pointer;padding-right:5px;' onclick='"+this.oName+".removeTag()'>"+getTxt("Remove Tag")+"</span></td></tr></table>";var e="<table unselectable=on ondblclick='"+this.oName+".moveTagSelector()' width='100%' cellpadding=0 cellspacing=0 style='border:none;border-left:#cfcfcf 1px solid;border-right:#cfcfcf 1px solid;margin:0px'><tr style='background-color:#f4f4f4;font-family:arial;font-size:10px;color:black;'><td id=idElNavigate"+this.oName+" style='color:inherit;line-height:normal;font-size:inherit;padding:1px;width:"+d+"px' valign=top>&nbsp;</td><td align=right valign='center' nowrap style='color:inherit;padding:0;margin;0;font-size:inherit;line-height:normal'><span id=idElCommand"+this.oName+" unselectable=on style='vertical-align:middle;display:none;text-decoration:underline;cursor:pointer;padding-right:5px;' onclick='"+this.oName+".removeTag()'>"+getTxt("Remove Tag")+"</span></td></tr></table>";var a=document.getElementById("idTagSelTop"+this.oName);var j=document.getElementById("idTagSelTopRow"+this.oName);var b=document.getElementById("idTagSelBottom"+this.oName);var g=document.getElementById("idTagSelBottomRow"+this.oName);if(this.TagSelectorPosition=="top"){a.innerHTML="";b.innerHTML=e;j.style.display="none";g.style.display="";this.TagSelectorPosition="bottom"}else{a.innerHTML=c;b.innerHTML="";j.style.display="";g.style.display="none";this.TagSelectorPosition="top"}}function selectElement(d){if(!this.useTagSelector){return}var e=document.getElementById("idContent"+this.oName).contentWindow;var b=e.document.createRange();b.selectNode(arrTmp2[d]);var a=e.getSelection();a.removeAllRanges();a.addRange(b);oActiveElement=arrTmp2[d];if(oActiveElement.tagName!="TD"&&oActiveElement.tagName!="TR"&&oActiveElement.tagName!="TBODY"&&oActiveElement.tagName!="LI"){document.getElementById("idElCommand"+this.oName).style.display=""}for(var c=0;c<arrTmp2.length;c++){document.getElementById("tag"+this.oName+c).style.background=""}document.getElementById("tag"+this.oName+d).style.background="DarkGray";if(oActiveElement){oUtil.activeElement=oActiveElement}this.focus()}function removeTag(){this.saveForUndo();var h=document.getElementById("idContent"+this.oName).contentWindow;var a=h.getSelection();var d=getSelectedElement(a);var i=d.nextSibling==null?(d.previousSibling==null?d.parentNode:d.previousSibling):d.nextSibling;switch(d.nodeName){case"TABLE":case"IMG":case"INPUT":case"FORM":case"SELECT":d.parentNode.removeChild(d);break;default:a=h.getSelection();var b=a.getRangeAt(0);var c=b.createContextualFragment(d.innerHTML);b.deleteContents();b.insertNode(c);try{h.document.designMode="on"}catch(g){}break}a=h.getSelection();a.removeAllRanges();var b=h.document.createRange();b.setStart(i,0);b.setEnd(i,0);a.addRange(b);this.focus();realTime(this)}function doCmd(c,b){if(c=="Bold"||c=="Italic"||c=="Underline"||c=="Strikethrough"||c=="Superscript"||c=="Subscript"||c=="Indent"||c=="Outdent"||c=="InsertHorizontalRule"){this.saveForUndo()}var a=document.getElementById("idContent"+this.oName).contentWindow;a.document.execCommand(c,false,b);realTime(this)}function applyColor(g,c){this.hide();this.focus();var e=document.getElementById("idContent"+this.oName).contentWindow;this.saveForUndo();if(c!=null&&c!=""){e.document.execCommand(g,false,c);var d=e.getSelection();var a=d.getRangeAt(0);if(a.startContainer.nodeType==Node.TEXT_NODE){var b=a.startContainer.nextSibling;if(b){a=e.document.createRange();a.selectNode(b);d=e.getSelection();d.removeAllRanges();d.addRange(a)}}}else{var b=getSelectedElement(e.getSelection());if(g=="ForeColor"){b.style.color=""}else{if(g=="HiliteColor"){b.style.backgroundColor=""}}}realTime(this);if(c==""){return}}function applyParagraph(c){var b=document.getElementById("idContent"+this.oName).contentWindow;var a=b.getSelection();this.hide();this.saveForUndo();this.doCmd("FormatBlock",c)}function applyFontName(c){var b=document.getElementById("idContent"+this.oName).contentWindow;var a=b.getSelection();this.hide();this.saveForUndo();this.doCmd("fontname",c)}function applyFontSize(c){var b=document.getElementById("idContent"+this.oName).contentWindow;var a=b.getSelection();this.hide();this.saveForUndo();this.doCmd("fontsize",c);replaceWithSpan(b);realTime(this)}function applyBullets(){this.saveForUndo();this.doCmd("InsertUnOrderedList");this.tbar.btns["btnNumbering"+this.oName].setState(1);var g=document.getElementById("idContent"+this.oName).contentWindow;var b=g.getSelection();var e=getSelectedElement(b);var a=(e.tagName=="LI")?e:null;while(e!=null&&e.tagName!="OL"&&e.tagName!="UL"){if(e.tagName=="BODY"){return}e=e.parentNode}e.removeAttribute("type",0);e.style.listStyleImage="";var c=e.parentNode;if(c.firstChild==c.lastChild&&c.tagName!="BODY"){c.parentNode.insertBefore(e,c);c.parentNode.removeChild(c)}if(a){b=g.getSelection();var d=b.getRangeAt(0);d.selectNodeContents(a);d.collapse(false);b.removeAllRanges();b.addRange(d)}}function applyNumbering(){this.saveForUndo();this.doCmd("InsertOrderedList");this.tbar.btns["btnBullets"+this.oName].setState(1);var g=document.getElementById("idContent"+this.oName).contentWindow;var b=g.getSelection();var e=getSelectedElement(b);var a=(e.tagName=="LI")?e:null;while(e!=null&&e.tagName!="OL"&&e.tagName!="UL"){if(e.tagName=="BODY"){return}e=e.parentNode}e.removeAttribute("type",0);e.style.listStyleImage="";var c=e.parentNode;if(c.firstChild==c.lastChild&&c.tagName!="BODY"){c.parentNode.insertBefore(e,c);c.parentNode.removeChild(c)}if(a){b=g.getSelection();var d=b.getRangeAt(0);d.selectNodeContents(a);d.collapse(false);b.removeAllRanges();b.addRange(d)}}function applyJustifyLeft(){this.saveForUndo();this.doCmd("JustifyLeft")}function applyJustifyCenter(){this.saveForUndo();this.doCmd("JustifyCenter")}function applyJustifyRight(){this.saveForUndo();this.doCmd("JustifyRight")}function applyJustifyFull(){this.saveForUndo();this.doCmd("JustifyFull")}function applyBlockDirLTR(){this.saveForUndo();var c=document.getElementById("idContent"+this.oName).contentWindow;var a=c.getSelection();var b=getSelectedElement(a);if(b.dir){b.removeAttribute("dir")}else{b.dir="ltr"}this.focus()}function applyBlockDirRTL(){this.saveForUndo();var c=document.getElementById("idContent"+this.oName).contentWindow;var a=c.getSelection();var b=getSelectedElement(a);if(b.dir){b.removeAttribute("dir")}else{b.dir="rtl"}this.focus()}function insertCustomTag(a){this.insertHTML(this.arrCustomTag[a][1]);this.hide();this.focus()}function expandSelection(){var g=document.getElementById("idContent"+this.oName).contentWindow;var b=g.getSelection();var d=b.getRangeAt(0);if(d.startContainer.nodeType==Node.TEXT_NODE){if(d.toString()==""){var c=d.startOffset;var a=d.endOffset;var e=d.startContainer;var h=e.nodeValue;c=h.substring(0,d.startOffset).search(/(\W+\w*)$/i);c=c==-1?0:c;var i=h.substring(c,d.startOffset).search(/\w+/i);c+=(i==-1?h.substring(c,d.startOffset).length:i);a=h.substr(d.endOffset).search(/\W+/i);a=a==-1?h.length:a+d.endOffset;d=g.document.createRange();d.setStart(e,c);d.setEnd(e,a);b=g.getSelection();b.removeAllRanges();b.addRange(d)}}return}function selectParagraph(){var e=document.getElementById("idContent"+this.oName).contentWindow;var a=e.getSelection();var d=getSelectedElement(a);if(d){if(a.getRangeAt(0).toString()==""){var c=d;while(c!=null&&c.tagName!="H1"&&c.tagName!="H2"&&c.tagName!="H3"&&c.tagName!="H4"&&c.tagName!="H5"&&c.tagName!="H6"&&c.tagName!="PRE"&&c.tagName!="P"&&c.tagName!="DIV"){if(c.tagName=="BODY"){return}c=c.parentNode}var b=e.document.createRange();b.selectNode(c);a=e.getSelection();a.removeAllRanges();a.addRange(b)}}}function insertHTML(g){var j=document.getElementById("idContent"+this.oName).contentWindow;var a=j.getSelection();var b=a.getRangeAt(0);this.saveForUndo();b.extractContents();b.collapse(true);var c=b.createContextualFragment(g);var d=c.lastChild;b.insertNode(c);try{j.document.designMode="on"}catch(i){}b.setStartAfter(d);b.setEndAfter(d);b.collapse(false);var h=b.commonAncestorContainer;if(h&&h.parentNode){try{h.parentNode.normalize()}catch(i){}}a.removeAllRanges();a.addRange(b)}function insertLink(a,k,j,o){var l=document.getElementById("idContent"+this.oName).contentWindow;var c=l.getSelection();var h=c.getRangeAt(0);this.saveForUndo();var n=false;if(h.toString()==""){if(h.startContainer.nodeType==Node.ELEMENT_NODE){if(h.startContainer.childNodes[h.startOffset].nodeType!=Node.TEXT_NODE){if(h.startContainer.childNodes[h.startOffset].nodeName=="BR"){n=true}else{n=false}}else{n=true}}else{n=true}if(n){var m=(k!=""&&k!=null?k:a);var b=l.document.createTextNode(m);h.insertNode(b);try{l.document.designMode="on"}catch(i){}h=l.document.createRange();h.setStart(b,0);h.setEnd(b,m.length);c=l.getSelection();c.removeAllRanges();c.addRange(h)}}var g=(h.startContainer.nodeType==Node.TEXT_NODE)&&(h.startOffset>0);l.document.execCommand("CreateLink",false,a);c=l.getSelection();h=c.getRangeAt(0);if(h.startContainer.nodeType==Node.TEXT_NODE){var b=(n||!g?h.startContainer.parentNode:h.startContainer.nextSibling);h=l.document.createRange();h.selectNode(b);c=l.getSelection();c.removeAllRanges();c.addRange(h)}var d=h.startContainer.childNodes[h.startOffset];if(d){if(j!=""&&j!=undefined){d.target=j}if(o!=""&&o!=undefined){d.setAttribute("rel",o)}}}function clearAll(){if(confirm(getTxt("Are you sure you wish to delete all contents?"))==true){this.saveForUndo();var a=document.getElementById("idContent"+this.oName).contentWindow;a.document.body.innerHTML="<BR>";a.focus()}}function applySpan(h){var c="SPAN";if(h!=null&&h!=""){c=h}var k=document.getElementById("idContent"+this.oName).contentWindow;var b=k.getSelection();var g;var a;var d;if(!isTextSelected(b)){g=b.getRangeAt(0);a=getSelectedElement(b);if(a.nodeName==c){return a}return}g=b.getRangeAt(0);d=g.toString();var l=g.extractContents();var j=k.document.createElement(c);j.appendChild(l);g.insertNode(j);try{k.document.designMode="on"}catch(i){}g=k.document.createRange();g.selectNode(j);b=k.getSelection();b.removeAllRanges();b.addRange(g);return j}function makeAbsolute(){var c=document.getElementById("idContent"+this.oName).contentWindow;var a=c.getSelection();var b=getSelectedElement(a);this.saveForUndo();if(b!=null&&b.nodeName!="BODY"){if(b.style.position=="absolute"){b.style.position=""}else{b.style.position="absolute"}}}function doOver_TabCreate(b){var m=b;var l=m.parentNode.parentNode.parentNode;var e=m.parentNode.rowIndex;var k=m.cellIndex;var n=l.rows;var c=n[n.length-1].childNodes[0];c.innerHTML="<div>"+(e*1+1)+" x "+(k*1+1)+" "+getTxt("Table Dimension Text")+"</div>";c.style.backgroundColor="";c.style.color="#000000";c.style.border="0px";for(var h=0;h<n.length-1;h++){var a=n[h];for(var g=0;g<a.childNodes.length;g++){var d=a.childNodes[g];if(h<=e&&g<=k){d.style.backgroundColor="#316ac5"}else{d.style.backgroundColor="#ffffff"}}}}function doOut_TabCreate(e){var b=e;if(b.nodeName!="TABLE"){return}var h=b.rows;for(var d=0;d<h.length-1;d++){var a=h[d];for(var c=0;c<a.childNodes.length;c++){var g=a.childNodes[c];g.style.backgroundColor="#ffffff"}}}function doRefresh_TabCreate(){if(!this.btnTable){return}var b=document.getElementById("dropTableCreate"+this.oName);var g=b.rows;for(var d=0;d<g.length-1;d++){var a=g[d];for(var c=0;c<a.childNodes.length;c++){var e=a.childNodes[c];e.style.backgroundColor="#ffffff"}}}function doClick_TabCreate(a){this.hide();var o=document.getElementById("idContent"+this.oName).contentWindow;var q=a;var c=q.parentNode.rowIndex+1;var m=q.cellIndex+1;this.saveForUndo();var d="<table style='border-collapse:collapse;width:100%;' selThis='selThis'>";for(var k=1;k<=c;k++){d+="<tr>";for(var g=1;g<=m;g++){d+="<td><br/></td>"}d+="</tr>"}d+="</table>";var b=o.getSelection();var l=b.getRangeAt(0);l.collapse(true);var p=l.createContextualFragment(d);l.insertNode(p);try{o.document.designMode="on"}catch(n){}var h=o.document.getElementsByTagName("TABLE");for(var k=0;k<h.length;k++){if(h[k].getAttribute("selThis")=="selThis"){l=o.document.createRange();l.selectNode(h[k]);b=o.getSelection();b.removeAllRanges();b.addRange(l);h[k].removeAttribute("selThis");break}}realTime(this)}function doKeyPress(b,e){if(!e.arrUndoList[0]){e.saveForUndo()}if(b.ctrlKey){switch(b.keyCode){case 86:if(e.pasteTextOnCtrlV){b.preventDefault();modelessDialogShow(e.dialogPath+"webpastetext.htm",400,280)}else{var d=document.getElementById("idContentWord"+e.oName);var a=d.contentWindow.document;var c=a.open("text/html","replace");c.close();a.designMode="on";d.contentWindow.focus();window.setTimeout(function(){e.fixWord()},1)}break;case 66:e.doCmd("Bold");b.preventDefault();break;case 73:e.doCmd("Italic");b.preventDefault();break;case 85:e.doCmd("Underline");b.preventDefault();break}}if(b.keyCode==37||b.keyCode==38||b.keyCode==39||b.keyCode==40){e.saveForUndo()}if(b.keyCode==13){e.saveForUndo();if(b.shiftKey){e.insertHTML("<br />");b.preventDefault()}else{if(e.returnKeyMode==1){$applyReturnEvent(b,e,"div")}else{if(e.returnKeyMode==3){$applyReturnEvent(b,e,"p")}else{}}}}e.onKeyPress()}function $getBlockElement(a){if(a==null){return null}var b="|H1|H2|H3|H4|H5|H6|PRE|DIV|P|TD|";while(a.tagName!="BODY"){if(b.indexOf("|"+a.tagName+"|")!=-1){return a}a=a.parentNode}return null}function $applyReturnEvent(j,g,o){var e=document.getElementById("idContent"+g.oName).contentWindow;var c=e.getSelection();var n=getSelectedElement(c);if(n){var k=GetElement(n,"LI");if(k){if(k.textContent==""){var h=c.getRangeAt(0);var i=k.parentNode;h.setStartAfter(i);h.setEndAfter(i);k.parentNode.removeChild(k);if(o=="br"){l=h.createContextualFragment("<"+o+" />")}else{l=h.createContextualFragment("<"+o+"></"+o+">")}var d=l.firstChild;if(d.innerHTML==""){d.innerHTML="&nbsp;"}h.insertNode(l);h.selectNodeContents(d);d.normalize();d.parentNode.normalize();h.collapse(true);c.removeAllRanges();c.addRange(h);j.preventDefault();return}else{if(k.lastChild&&k.lastChild.nodeType==1&&k.lastChild.tagName=="BR"){k.removeChild(k.lastChild)}var h=c.getRangeAt(0);h.setEndAfter(k);var l=h.extractContents();var m=l.firstChild;if(m.textContent==""){m.innerHTML="<br />"}h.insertNode(l);h.selectNodeContents(m);if(m.textContent==""){h.collapse(true)}else{h.collapse(false)}c.removeAllRanges();c.addRange(h);j.preventDefault();return}}}var b=$getBlockElement(getSelectedElement(c));if(b&&(b.tagName=="H1"||b.tagName=="H2"||b.tagName=="H3"||b.tagName=="H4"||b.tagName=="H5"||b.tagName=="H6"||b.tagName=="P"||b.tagName=="DIV"||b.tagName=="PRE")){}else{g.doCmd("FormatBlock",o);c=e.getSelection();b=$getBlockElement(getSelectedElement(c))}if(b){if(b.lastChild&&b.lastChild.nodeType==1&&b.lastChild.tagName=="BR"){b.removeChild(b.lastChild)}var a=c.getRangeAt(0);a.setEndAfter(b);var l=a.extractContents();if(b.innerHTML==""){b.innerHTML="&nbsp;";b.parentNode.normalize();b.normalize()}a.setStartAfter(b);a.setEndAfter(b);a.collapse(true);if(l&&l.firstChild&&l.firstChild.nodeType==3&&l.firstChild.textContent==""){l=a.createContextualFragment("<"+o+"></"+o+">")}var d=l.firstChild;if(d.textContent==""){d.innerHTML="<br />"}a.insertNode(l);a.selectNodeContents(d);d.normalize();d.parentNode.normalize();a.collapse(true);c.removeAllRanges();c.addRange(a);ensureVisible(d,document.getElementById("idContent"+g.oName));if(d.innerHTML=="<br>"){d.innerHTML=""}j.preventDefault()}}function doFullScreen(){var k=document.getElementById("idContent"+this.oName).contentWindow;var h=document.getElementById("idArea"+this.oName);this.hide();if(this.stateFullScreen){this.onNormalScreen();this.stateFullScreen=false;document.body.style.overflow="";document.getElementById("id_refresh_z_index").style.margin="0px";h.style.position="";h.style.top="0px";h.style.left="0px";if(this.width.toString().indexOf("%")!=-1){h.style.width=this.width}else{h.style.width=parseInt(this.width)+"px"}if(this.height.toString().indexOf("%")!=-1){h.style.height=this.height}else{h.style.height=parseInt(this.height)+"px"}for(var b=0;b<oUtil.arrEditor.length;b++){if(oUtil.arrEditor[b]!=this.oName){document.getElementById("idArea"+oUtil.arrEditor[b]).style.display="";try{document.getElementById("idContent"+oUtil.arrEditor[b]).contentWindow.document.designMode="on"}catch(j){}}}}else{this.onFullScreen();this.stateFullScreen=true;window.scroll(0,0);document.body.style.overflow="hidden";document.getElementById("id_refresh_z_index").style.margin="70px";h.style.position="absolute";h.style.top="0px";h.style.left="0px";h.style.width=window.innerWidth+"px";h.style.height=window.innerHeight+"px";h.style.zIndex=2000;for(var b=0;b<oUtil.arrEditor.length;b++){if(oUtil.arrEditor[b]!=this.oName){document.getElementById("idArea"+oUtil.arrEditor[b]).style.display="none"}}k.focus()}try{k.document.designMode="on"}catch(j){}var c=document.getElementById("idStyles"+this.oName);c.innerHTML="";document.documentElement.focus();k.focus();var a=k.document.createRange();if(k.document.body.childNodes.length>0){var d=k.document.body.childNodes[k.document.body.childNodes.length-1];if(d.nodeType==1&&d.tagName=="BR"){a.selectNode(d);a.collapse(true)}else{a.selectNode(d);a.collapse(false)}}else{a.selectNodeContents(k.document.body);a.collapse(false)}var g=k.getSelection();g.removeAllRanges();g.addRange(a)}function modelessDialogShow(b,d,a,e,c){modalDialog(b,d,a)}function modalDialogShow(b,d,a,e,c){modalDialog(b,d,a)}function windowOpen(a,e,d,c,h,b){var i="ID"+(new Date()).getTime();var g=new ISWindow(i);g.iconPath=oUtil.scriptPath.substring(0,oUtil.scriptPath.indexOf("moz/"))+"icons/";g.show({width:e+"px",height:d+"px",overlay:c,center:true,url:a,openerWin:h,options:b})}function hide(){hideAllDD();this.oColor1.hide();this.oColor2.hide();if(this.btnTable){this.doRefresh_TabCreate()}}function lineBreak1(a){arrReturn=["\n","",""];if(a=="A"||a=="B"||a=="CITE"||a=="CODE"||a=="EM"||a=="FONT"||a=="I"||a=="SMALL"||a=="STRIKE"||a=="BIG"||a=="STRONG"||a=="SUB"||a=="SUP"||a=="U"||a=="SAMP"||a=="S"||a=="VAR"||a=="BASEFONT"||a=="KBD"||a=="TT"||a=="SPAN"||a=="IMG"){arrReturn=["","",""]}if(a=="TEXTAREA"||a=="TABLE"||a=="THEAD"||a=="TBODY"||a=="TR"||a=="OL"||a=="UL"||a=="DIR"||a=="MENU"||a=="FORM"||a=="SELECT"||a=="MAP"||a=="DL"||a=="HEAD"||a=="BODY"||a=="HTML"){arrReturn=["\n","","\n"]}if(a=="STYLE"||a=="SCRIPT"){arrReturn=["\n","",""]}if(a=="BR"||a=="HR"){arrReturn=["","\n",""]}return arrReturn}function fixAttr(a){a=String(a).replace(/&/g,"&amp;");a=String(a).replace(/</g,"&lt;");a=String(a).replace(/"/g,"&quot;");return a}function fixVal(b){b=String(b).replace(/&/g,"&amp;");b=String(b).replace(/</g,"&lt;");var a=escape(b);a=unescape(a.replace(/\%A0/gi,"-*REPL*-"));b=a.replace(/-\*REPL\*-/gi,"&nbsp;");return b}function recur(h,b){var e="";for(var g=0;g<h.childNodes.length;g++){var n=h.childNodes[g];if(n.nodeType==1){var a=n.nodeName;var m=false;if(a.substring(0,1)=="/"){m=true}else{var d=b;e+=lineBreak1(a)[0];if(lineBreak1(a)[0]!=""){e+=d}}if(m){}else{if(a=="OBJECT"||a=="EMBED"){s=getOuterHTML(n);s=s.replace(/\"[^\"]*\"/ig,function(i){i=i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/\s+/ig,"#_#").replace(/&amp;amp;/gi,"&amp;");return i});s=s.replace(/<([^ >]*)/ig,function(i){return i.toLowerCase()});s=s.replace(/ ([^=]+)=([^"' >]+)/ig,' $1="$2"');s=s.replace(/ ([^=]+)=/ig,function(i){return i.toLowerCase()});s=s.replace(/#_#/ig," ");s=s.replace(/<param([^>]*)>/ig,"\n<param$1 />").replace(/\/ \/>$/ig," />");if(a=="EMBED"){if(n.innerHTML==""){s=s.replace(/>$/ig," />").replace(/\/ \/>$/ig,"/>")}}s=s.replace(/<param name=\"Play\" value=\"0\" \/>/,'<param name="Play" value="-1" />');e+=s}else{if(a=="TITLE"){e+="<title>"+n.innerHTML+"</title>"}else{if(a=="AREA"){var c=n.coords;var k=n.shape}var l=n.cloneNode(false);s=getOuterHTML(l).replace(/<\/[^>]*>/,"");if(a=="STYLE"){var j=s.match(/<[^>]*>/ig);s=j[0]}s=s.replace(/\"[^\"]*\"/ig,function(i){i=i.replace(/&/g,"&amp;").replace(/&amp;amp;/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\s+/ig,"#_#");return i});s=s.replace(/<([^ >]*)/ig,function(i){return i.toLowerCase()});s=s.replace(/ ([^=]+)=([^" >]+)/ig,' $1="$2"');s=s.replace(/ ([^=]+)=/ig,function(i){return i.toLowerCase()});s=s.replace(/#_#/ig," ");s=s.replace(/(<hr[^>]*)(noshade="")/ig,'$1noshade="noshade"');s=s.replace(/(<input[^>]*)(checked="")/ig,'$1checked="checked"');s=s.replace(/(<select[^>]*)(multiple="")/ig,'$1multiple="multiple"');s=s.replace(/(<option[^>]*)(selected="")/ig,'$1selected="true"');s=s.replace(/(<input[^>]*)(readonly="")/ig,'$1readonly="readonly"');s=s.replace(/(<input[^>]*)(disabled="")/ig,'$1disabled="disabled"');s=s.replace(/(<td[^>]*)(nowrap="" )/ig,'$1nowrap="nowrap" ');s=s.replace(/(<td[^>]*)(nowrap=""\>)/ig,'$1nowrap="nowrap">');if(a=="AREA"){s=s.replace(/ coords=\"0,0,0,0\"/ig,' coords="'+c+'"');s=s.replace(/ shape=\"RECT\"/ig,' shape="'+k+'"')}var o=true;if(a=="IMG"||a=="BR"||a=="AREA"||a=="HR"||a=="INPUT"||a=="BASE"||a=="LINK"){s=s.replace(/>$/ig," />").replace(/\/ \/>$/ig,"/>");o=false}e+=s;if(a!="TEXTAREA"){e+=lineBreak1(a)[1]}if(a!="TEXTAREA"){if(lineBreak1(a)[1]!=""){e+=d}}if(o){s=getOuterHTML(n);if(a=="SCRIPT"){s=s.replace(/<script([^>]*)>[\n+\s+\t+]*/ig,"<script$1>");s=s.replace(/[\n+\s+\t+]*<\/script>/ig,"<\/script>");s=s.replace(/<script([^>]*)>\/\/<!\[CDATA\[/ig,"");s=s.replace(/\/\/\]\]><\/script>/ig,"");s=s.replace(/<script([^>]*)>/ig,"");s=s.replace(/<\/script>/ig,"");s=s.replace(/^\s+/,"").replace(/\s+$/,"");e+="\n"+d+s+"\n"+d}if(a=="STYLE"){s=s.replace(/<style([^>]*)>[\n+\s+\t+]*/ig,"<style$1>");s=s.replace(/[\n+\s+\t+]*<\/style>/ig,"</style>");s=s.replace(/<style([^>]*)><!--/ig,"");s=s.replace(/--><\/style>/ig,"");s=s.replace(/<style([^>]*)>/ig,"");s=s.replace(/<\/style>/ig,"");s=s.replace(/^\s+/,"").replace(/\s+$/,"");e+="\n"+d+"<!--\n"+d+s+"\n"+d+"-->\n"+d}if(a=="DIV"||a=="P"){if(n.innerHTML==""||n.innerHTML=="&nbsp;"){e+="&nbsp;"}else{e+=recur(n,d+"\t")}}else{if(a=="STYLE"||a=="SCRIPT"){}else{e+=recur(n,d+"\t")}}if(a!="TEXTAREA"){e+=lineBreak1(a)[2]}if(a!="TEXTAREA"){if(lineBreak1(a)[2]!=""){e+=d}}e+="</"+a.toLowerCase()+">"}}}}}else{if(n.nodeType==3){e+=fixVal(n.nodeValue).replace(/^[\t\r\n\v\f]*/,"").replace(/[\t\r\n\v\f]*$/,"")}else{if(n.nodeType==8){if(getOuterHTML(n).substring(0,2)=="<%"){sTmp=(getOuterHTML(n).substring(2));sTmp=sTmp.substring(0,sTmp.length-2);sTmp=sTmp.replace(/^\s+/,"").replace(/\s+$/,"");var d=b;e+="\n"+d+"<%\n"+d+sTmp+"\n"+d+"%>\n"+d}else{var d=b;sTmp=n.nodeValue;sTmp=sTmp.replace(/^\s+/,"").replace(/\s+$/,"");e+="\n"+d+"<!--\n"+d+sTmp+"\n"+d+"-->\n"+d}}else{}}}}return e}function getSelectedElement(d){var a=d.getRangeAt(0);var c=a.startContainer;if(c.nodeType==Node.ELEMENT_NODE){if(a.startOffset>=c.childNodes.length){return c}c=c.childNodes[a.startOffset]}if(c.nodeType==Node.TEXT_NODE){if(c.nodeValue.length==a.startOffset){var b=c.nextSibling;if(b&&b.nodeType==Node.ELEMENT_NODE){if(a.endContainer.nodeType==Node.TEXT_NODE&&a.endContainer.nodeValue.length==a.endOffset){if(b==a.endContainer.parentNode){return b}}}}while(c!=null&&c.nodeType!=Node.ELEMENT_NODE){c=c.parentNode}}return c}function isTextSelected(b){var a=b.getRangeAt(0);if(a!=null&&a.startContainer!=null){return(a.startContainer.nodeType==Node.TEXT_NODE)}return false}function getOuterHTML(c){var b="";switch(c.nodeType){case Node.ELEMENT_NODE:b="<"+c.nodeName;var d="";for(var a=0;a<c.attributes.length;a++){if(c.attributes[a].nodeName.substr(0,4)=="_moz"){continue}if(c.attributes[a].nodeValue.substr(0,4)=="_moz"){continue}if(c.nodeName=="TEXTAREA"&&c.attributes[a].nodeName.toLowerCase()=="value"){d=c.attributes[a].nodeValue}else{b+=" "+c.attributes[a].nodeName+'="'+c.attributes[a].nodeValue.replace(/"/gi,"'")+'"'}}b+=">";b+=(c.nodeName!="TEXTAREA"?c.innerHTML:d);b+="</"+c.nodeName+">";break;case Node.COMMENT_NODE:b="<!--"+c.nodeValue+"-->";break;case Node.TEXT_NODE:b=c.nodeValue;break}return b}function tbAction(tb,id,edt,sfx){var e=edt,oN=sfx,btn=id.substring(0,id.lastIndexOf(oN));switch(btn){case"btnFullScreen":e.fullScreen();break;case"btnPrint":e.focus();document.getElementById("idContent"+edt.oName).contentWindow.print();break;case"btnSpellCheck":e.hide();if(e.spellCheckMode=="ieSpell"){}else{if(e.spellCheckMode=="NetSpell"){checkSpellingById("idContent"+edt.oName)}}break;case"btnCut":e.doCmd("Cut");break;case"btnCopy":e.doCmd("Copy");break;case"btnUndo":e.doUndo();break;case"btnRedo":e.doRedo();break;case"btnBold":e.doCmd("Bold");break;case"btnItalic":e.doCmd("Italic");break;case"btnUnderline":e.doCmd("Underline");break;case"btnStrikethrough":e.doCmd("Strikethrough");break;case"btnSuperscript":e.doCmd("Superscript");break;case"btnSubscript":e.doCmd("Subscript");break;case"btnJustifyLeft":e.applyJustifyLeft();break;case"btnJustifyCenter":e.applyJustifyCenter();break;case"btnJustifyRight":e.applyJustifyRight();break;case"btnJustifyFull":e.applyJustifyFull();break;case"btnNumbering":e.applyNumbering();break;case"btnBullets":e.applyBullets();break;case"btnIndent":e.doCmd("Indent");break;case"btnOutdent":e.doCmd("Outdent");break;case"btnLTR":e.applyBlockDirLTR();break;case"btnRTL":e.applyBlockDirRTL();break;case"btnFontDialog":e.hide();modelessDialogShow(e.dialogPath+"webfonts.htm",500,470);break;case"btnTextDialog":e.hide();modelessDialogShow(e.dialogPath+"webtext.htm",375,475);break;case"btnCompleteTextDialog":e.hide();modelessDialogShow(e.dialogPath+"webtextcomplete.htm",815,470);break;case"btnLinkDialog":e.hide();if(e.fileBrowser==""&&e.enableCssButtons==false){modelessDialogShow(e.dialogPath+"weblink.htm",755,545)}else{modelessDialogShow(e.dialogPath+"weblink.htm",755,545)}break;case"btnImageDialog":e.hide();modelessDialogShow(e.dialogPath+"webimage.htm",755,545);break;case"btnYoutubeDialog":e.hide();modelessDialogShow(e.dialogPath+"webyoutube.htm",421,545);break;case"btnTableDialog":e.hide();modelessDialogShow(e.dialogPath+"webtable.htm",785,500);break;case"btnFlashDialog":e.hide();modelessDialogShow(e.dialogPath+"webflash.htm",390,195);break;case"btnCharsDialog":e.hide();modelessDialogShow(e.dialogPath+"webchars.htm",700,122);break;case"btnSearchDialog":e.hide();modelessDialogShow(e.dialogPath+"websearch.htm",370,140);break;case"btnSourceDialog":e.hide();changeActiveEditor(e.oName);modelessDialogShow(e.dialogPath+"websource.htm",800,450);break;case"btnContentBlock":e.hide();eval(e.cmdContentBlock);break;case"btnInternalLink":e.hide();eval(e.cmdInternalLink);break;case"btnInternalImage":e.hide();eval(e.cmdInternalImage);break;case"btnCustomObject":e.hide();eval(e.cmdCustomObject);break;case"btnGuidelines":e.runtimeBorder(true);break;case"btnAbsolute":e.makeAbsolute();break;case"btnLine":e.doCmd("InsertHorizontalRule");break;case"btnRemoveFormat":e.doClean();break;case"btnClearAll":e.clearAll();break;case"btnStyles":e.hide();e.openStyleSelect();break;case"btnParagraph":e.hide();e.selectParagraph();break;case"btnFontName":e.hide();e.expandSelection();realtimeFontSelect(e.oName);break;case"btnFontSize":e.hide();e.expandSelection();realtimeSizeSelect(e.oName);break;case"btnCustomTag":e.hide();break;case"btnQuote":e.applyQuote();break;default:for(var i=0;i<e.arrCustomButtons.length;i++){if(e.arrCustomButtons[i][0]==btn){eval(e.arrCustomButtons[i][1]);break}}}}function ddAction(c,j,i,h){var b=h;var g=i;var d=j.substring(0,j.lastIndexOf(b));switch(d){case"btnPasteClip":alert(getTxt("PasteWarning"));break;case"btnPasteWord":if(!g.customDialogShow("PasteWord")){modelessDialogShow(g.scriptPath+"paste_word.htm",400,280)}break;case"btnPasteText":modelessDialogShow(g.dialogPath+"webpastetext.htm",400,280);break}var a=0;if(d.indexOf("btnParagraphFormatting")!=-1){}else{if(d.indexOf("btnParagraph")!=-1){a=d.substr(d.indexOf("_")+1);g.applyParagraph(g.arrParagraph[parseInt(a)][1])}else{if(d.indexOf("btnFontName")!=-1){a=d.substr(d.indexOf("_")+1);g.applyFontName(g.arrFontName[parseInt(a)])}else{if(d.indexOf("btnFontSize")!=-1){a=d.substr(d.indexOf("_")+1);g.applyFontSize(g.arrFontSize[parseInt(a)][1])}else{if(d.indexOf("btnCustomTag")!=-1){a=d.substr(d.indexOf("_")+1);g.insertCustomTag(parseInt(a))}}}}}}function changeHeight(b){var d=String(this.height);var c=document.getElementById("idArea"+this.oName);if(d.indexOf("%")>-1){d=c.childNodes[0].offsetHeight}if(!this.minHeight){this.minHeight=parseInt(d,10)}var a=parseInt(d,10)+b;if(b<0){var e=this.tbar;this.height=a+"px";c.style.height=this.height}else{if(b>0){var e=this.tbar;this.height=a+"px";c.style.height=this.height}}}function _isWordContent(a){return(/msonormal/i.test(a)||/<!(?:--[\s\S]*?--\s*)?>\s*/gi.test(a)||/<\\?\?xml[^>]*>/gi.test(a)||/<\/?o:p[^>]*>/gi.test(a)||/<\/?u1:p[^>]*>/gi.test(a)||/<\/?v:[^>]*>/gi.test(a)||/<\/?o:[^>]*>/gi.test(a)||/<\/?st1:[^>]*>/gi.test(a)||/<\/?w:wrap[^>]*>/gi.test(a)||/<\/?w:anchorlock[^>]*>/gi.test(a)||/<!--\[if[^>]*>/gi.test(a)||/<!--\[endif\]-->/gi.test(a)||/<!\[endif\]-->/gi.test(a)||/<\/?meta[^>]*>/g.test(a)||/<\/?link[^>]*>/g.test(a)||/<\/?style[^>]*>/g.test(a))}function fixWord(){var b=document.getElementById("idContentWord"+this.oName);var c=b.contentWindow;var e=_isWordContent(c.document.body.innerHTML);if(!e){this.insertHTML(c.document.body.innerHTML);return}for(var a=0;a<c.document.body.getElementsByTagName("*").length;a++){c.document.body.getElementsByTagName("*")[a].removeAttribute("class");c.document.body.getElementsByTagName("*")[a].removeAttribute("style")}var d=c.document.body.innerHTML;d=d.replace(/<!(?:--[\s\S]*?--\s*)?>\s*/gi,"");d=String(d).replace(/<\\?\?xml[^>]*>/g,"");d=String(d).replace(/<\/?o:p[^>]*>/g,"");d=String(d).replace(/<\/?u1:p[^>]*>/gi,"");d=String(d).replace(/<\/?v:[^>]*>/g,"");d=String(d).replace(/<\/?o:[^>]*>/g,"");d=String(d).replace(/<\/?st1:[^>]*>/g,"");d=String(d).replace(/<\/?w:wrap[^>]*>/gi,"");d=String(d).replace(/<\/?w:anchorlock[^>]*>/gi,"");d=String(d).replace(/&nbsp;/g,"");d=String(d).replace(/<\/?SPAN[^>]*>/g,"");d=String(d).replace(/<\/?FONT[^>]*>/g,"");d=String(d).replace(/<\/?STRONG[^>]*>/g,"");d=String(d).replace(/<\/?H1[^>]*>/g,"");d=String(d).replace(/<\/?H2[^>]*>/g,"");d=String(d).replace(/<\/?H3[^>]*>/g,"");d=String(d).replace(/<\/?H4[^>]*>/g,"");d=String(d).replace(/<\/?H5[^>]*>/g,"");d=String(d).replace(/<\/?H6[^>]*>/g,"");d=String(d).replace(/<\/?P[^>]*><\/P>/g,"");d=String(d).replace(/<!--\[if[^>]*>/gi,"");d=String(d).replace(/<!--\[endif\]-->/gi,"");d=String(d).replace(/<!\[endif\]-->/gi,"");d=String(d).replace(/<\/?meta[^>]*>/g,"");d=String(d).replace(/<\/?link[^>]*>/g,"");d=String(d).replace(/<\/?style[^>]*>/g,"");this.insertHTML(d)}function customDialogShow(s){for(var j=0;j<this.customDialog.length;j++){if(this.customDialog[j][0]==s){eval(this.customDialog[j][1]);return true}}return false}function GetEmoticons(){var d="";var c=[["smiley.png","smiley"],["smiley-lol.png","lol"],["smiley-confuse.png","confuse"],["smiley-cool.png","cool"],["smiley-cry.png","cry"],["smiley-wink.png","wink"],["smiley-surprise.png","surprise"],["smiley-sad.png","sad"],["smiley-red.png","red"],["smiley-neutral.png","neutral"],["smiley-kiss.png","kiss"],["smiley-mad.png","mad"],["smiley-money.png","money"],["smiley-sleep.png","sleep"],["smiley-yell.png","yell"],["smiley-roll.png","roll"],["smiley-grin.png","grin"],["smiley-razz.png","razz"],["smiley-sweat.png","sweat"],["smiley-eek.png","eek"],["smiley-zipper.png","zipper"],["heart.png","love"],["heart-break.png","heart break"],["light-bulb.png","idea"]];var a=this.scriptPath.substring(0,this.scriptPath.indexOf("moz/"))+this.iconPath;d+="<div style='width:193px;height:72px;margin:2px;'>";for(var b=0;b<c.length;b++){d+="<img unselectable='on' src='"+a+c[b][0]+"' onmouseover='this.style.border=\"#aaaaaa 1px solid\"' onmouseout='this.style.border=\"#ffffff 1px solid\"' style='float:left;margin:1px;cursor:pointer;border:#ffffff 1px solid;padding:2px;' onclick='"+this.oName+'.insertEmoticon("'+a+c[b][0]+'","'+c[b][1]+"\");' alt='"+c[b][1]+"' />"}d+="</div>";return d}function insertEmoticon(a,c){this.insertHTML("<img src='"+a+"' alt='"+c+"' />");var b=document.getElementById("ddEmoticons"+this.oName);b.style.display="none";this.isActive=false}function applyQuote(){var e=document.getElementById("idContent"+this.oName).contentWindow;var a=e.getSelection();var d=getSelectedElement(a);var g=GetElement(d,"BLOCKQUOTE");if(g){var c=d;var b=0;while(c!=null&&c.tagName!="BODY"&&c.nodeType==1){if(c.tagName=="BLOCKQUOTE"){document.getElementById("tag"+this.oName+b).click();this.removeTag();return}c=c.parentNode;b++}}else{this.applyParagraph("blockquote")}}function doPaste(){var d=this;var c=document.getElementById("idContentWord"+d.oName);var a=c.contentWindow.document;var b=a.open("text/html","replace");b.close();a.designMode="on";c.contentWindow.focus();window.setTimeout(function(){d.fixWord()},1)}function getElementPosition(b,d){var a=b,c=0;do{c+=a.offsetTop;a=a.offsetParent}while(a&&a.id!=d.id);return c}function isNodeVisible(e,c){var a=c.contentWindow.document.body;var b=getElementPosition(e,a);var d=null;if(window.getComputedStyle){d=window.getComputedStyle(c,"")}else{d=c.currentStyle}var g=parseInt(d.height,10);return(b>a.scrollTop&&b<(a.scrollTop+g-20))}function ensureVisible(d,c){if(!isNodeVisible(d,c)){var a=c.contentWindow.document.body;var b=getElementPosition(d,a);a.scrollTop=b}};